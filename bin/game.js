"use strict";const getGlobalThis=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==this)return this;throw new Error("Unable to locate global `this`")},globalObject=getGlobalThis();var loader;!function(v){let C=0;const T=[],S=[],E={baseUrl:""},A={};function c(v,T,S){let E=null,R={},O=null;"function"==typeof v?R=v:"string"==typeof v?(E=v,"function"==typeof T?R=T:T instanceof Array&&(O=T,R=S)):v instanceof Array&&(O=v,"function"==typeof T&&(R=T)),O=O||["require","exports","module"],null===E&&(E="unnamed-module-"+C++),E=g(E),O=(O||[]).map((v=>function(v,C){return v?b(C,v):C}(E,v))),A[E]||(A[E]={name:E,parent:null,dclamd:1,dependencies:O,handlers:[],exports:{},dependants:new Set}),A[E].dependencies=O,p(O,(function(v){const C=A[E];if(!C)throw new Error("Could not access registered module "+E);let T=C.exports;T="function"==typeof R?R.apply(globalObject,v)||T:R,C.exports=T,d(E)}),(v=>{if("function"!=typeof onerror)throw v;onerror(v)}),E)}function d(v){const C=A[v];if(!C)throw new Error("Could not access registered module "+v);C.dclamd=2;const T=C.handlers;if(T&&T.length)for(let C=0;C<T.length;C++)T[C](A[v])}function u(v,C,T){if(!A[v])return null;if(v===C||50===T)return[v];const S=A[v].dependencies;for(let E=0,A=S.length;E<A;E++){const A=u(S[E],C,T+1);if(null!==A)return A.push(v),A}return null}function a(v,C){const T=A[v];if(!T)return!1;const S={};for(const v in A)S[v]=!1;const E=[];for(E.push(T),S[v]=!0;E.length>0;){const v=E.shift().dependencies;if(v)for(let T=0,R=v.length;T<R;T++){const R=v[T];if(R===C)return!0;const O=A[R];O&&!S[R]&&(S[R]=!0,E.push(O))}}return!1}function p(v,C,T,E){const R=new Array(v.length).fill(null);let O=0,M=!1;if("string"==typeof v){if(A[v]){if(1===A[v].dclamd)throw new Error(`Trying to load ${v} from ${E}. The first module is still loading.`);return A[v]}throw new Error(v+" has not been defined. Please include it as a dependency in "+E+"'s define()")}const z=v.length;for(let B=0;B<z;B++)switch(v[B]){case"require":const h=function(v,C,T){return p(v,C,T,E)};h.toUrl=function(v){return b(v,E)},R[B]=h,O++;break;case"exports":if(!A[E])throw new Error("Parent module "+E+" not registered yet");R[B]=A[E].exports,O++;break;case"module":R[B]={id:E,uri:b(E)},O++;break;default:{const V=v[B],m=()=>{R[B]=A[V].exports,O++,O===z&&C&&(M=!0,C(R))};if(a(V,E)){const v=u(V,E,0);v&&(v.reverse(),v.push(V),S.push(v)),w(V,(()=>{}),T,E),m()}else w(V,m,T,E);break}}!M&&O===z&&C&&C(R)}function h(v,C){return function(){return dcl.callRpc(v,C.name,T.slice.call(arguments,0))}}function w(v,C,T,S){if(A[v])return A[v].dependants.add(S),void(1===A[v].dclamd?C&&A[v].handlers.push(C):C&&C(A[v]));if(A[v]={name:v,parent:S,dclamd:1,handlers:[C],dependencies:[],dependants:new Set([S]),exports:{}},0===v.indexOf("@")){const C=A[v].exports;if("function"!=typeof dcl.loadModule)throw new Error("Asynchronous modules will not work because loadModule function is not present");dcl.loadModule(v,C).then((T=>{for(const v in T.methods){const S=T.methods[v];C[S.name]=h(T.rpcHandle,S)}d(v)})).catch((v=>{T(v)}))}}function g(v){let C,T=v;for(C=/\/\.\//;C.test(T);)T=T.replace(C,"/");for(T=T.replace(/^\.\//g,""),C=/\/(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//;C.test(T);)T=T.replace(C,"/");return T=T.replace(/^(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//,""),T=T.replace(/^\//g,""),T}function b(v,C){switch(v){case"require":case"exports":case"module":return v}return C?function(v,C){let T=v;if(!T.startsWith("@")&&(T.startsWith("./")||T.startsWith("../"))){const v=C.split("/");v.pop(),T=g(v.join("/")+"/"+T)}return T}(v,C):g(v)}v.config=function(v){if("object"==typeof v)for(const C in v)v.hasOwnProperty(C)&&(E[C]=v[C])},v.define=c,function(v){v.amd={},v.modules=A}(c=v.define||(v.define={})),v.require=p,"undefined"!=typeof dcl&&dcl.onStart((()=>{const v=new Set,C=[];for(const T in A)A[T]&&(1===A[T].dclamd&&C.push(A[T]),A[T].dependencies.forEach((C=>{"require"!==C&&"exports"!==C&&"module"!==C&&(A[C]||v.add(C))})));const T=[];if(S.length&&T.push(`\n> Cyclic dependencies: ${S.map((v=>"\n  - "+v.join(" -> "))).join("")}`),v.size&&T.push(`\n> Undeclared/unknown modules: ${Array.from(v).map((v=>"\n  - "+v)).join("")}`),C.length&&T.push(`\n> These modules didn't load: ${C.map((v=>"\n  - "+v.name)).join("")}.\n`),T.length)throw new Error(T.join("\n"))})),p.toUrl=b}(loader||(loader={})),globalObject.define=loader.define,globalObject.dclamd=loader,function(v){var C=function(){function t(){}return t.AVATAR={getEntityRepresentation:function(v){return v.avatarEntity}},t.FIRST_PERSON_CAMERA={getEntityRepresentation:function(v){return v.firstPersonCameraEntity}},t}(),n=function(v,C){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,C){v.__proto__=C}||function(v,C){for(var T in C)Object.prototype.hasOwnProperty.call(C,T)&&(v[T]=C[T])})(v,C)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function i(v,C){if("function"!=typeof C&&null!==C)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function i(){this.constructor=v}n(v,C),v.prototype=null===C?Object.create(C):(i.prototype=C.prototype,new i)}var o=function(){return(o=Object.assign||function(v){for(var C,T=1,S=arguments.length;T<S;T++)for(var E in C=arguments[T])Object.prototype.hasOwnProperty.call(C,E)&&(v[E]=C[E]);return v}).apply(this,arguments)};function r(v,C,T,S){var E,A=arguments.length,R=A<3?C:null===S?S=Object.getOwnPropertyDescriptor(C,T):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)R=Reflect.decorate(v,C,T,S);else for(var O=v.length-1;O>=0;O--)(E=v[O])&&(R=(A<3?E(R):A>3?E(C,T,R):E(C,T))||R);return A>3&&R&&Object.defineProperty(C,T,R),R}function s(v,C){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(v,C)}function h(v){var C="function"==typeof Symbol&&Symbol.iterator,T=C&&v[C],S=0;if(T)return T.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&S>=v.length&&(v=void 0),{value:v&&v[S++],done:!v}}};throw new TypeError(C?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(v,C){var T="function"==typeof Symbol&&v[Symbol.iterator];if(!T)return v;var S,E,A=T.call(v),R=[];try{for(;(void 0===C||C-- >0)&&!(S=A.next()).done;)R.push(S.value)}catch(v){E={error:v}}finally{try{S&&!S.done&&(T=A.return)&&T.call(A)}finally{if(E)throw E.error}}return R}function p(v,C){for(var T=0,S=C.length,E=v.length;T<S;T++,E++)v[E]=C[T];return v}var T=0;function c(){for(var v=[],C=0;C<arguments.length;C++)v[C]=arguments[C];"undefined"!=typeof dcl?dcl.log.apply(dcl,p([],l(v))):console.log.apply(console,p(["DEBUG:"],l(v)))}function y(v,C){"undefined"!=typeof dcl?dcl.error(v,C):console.error("ERROR:",v,C)}function f(v){if(T++,0===v.length)throw new Error("newId(type: string): type cannot be empty");return v+T.toString(36)}function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(v){var C=16*Math.random()|0;return("x"===v?C:3&C|8).toString(16)}))}var S=[];function _(v){if(!("__event_name__"in v)||"string"!=typeof v.__event_name__)throw new Error("The EventConstructor is not registered");return v.__event_name__}var E=function(){function t(){this.listeners={}}return t.prototype.addListener=function(v,C,T){if(!v||"function"!=typeof v)throw new Error("Invalid EventConstructor");var S=_(v),E=this.listeners[S];E||(E=this.listeners[S]=[]);for(var A=0;A<E.length;A++)if(E[A].listener===C)throw new Error("The provided listener is already registered");return E.push({listener:C,fn:T}),this},t.prototype.removeListener=function(v,C){if(!C||"function"!=typeof C)throw new Error("Invalid EventConstructor");var T=_(C),S=this.listeners[T];if(!S)return!1;for(var E=0;E<S.length;E++)if(S[E].listener===v)return S.splice(E,1),!0;return!1},t.prototype.fireEvent=function(v){var C=_(v.constructor),T=this.listeners[C];if(T)for(var S=0;S<T.length;S++)try{var E=T[S];E.fn.call(E.listener,v)}catch(v){y(v)}return this},t}();function x(){var v=f("EV");if(-1!==S.indexOf(v))throw new Error("The event name "+v+" is already taken");return S.push(v),function(C){return C.__event_name__=v,C}}var A,R=r([x(),s("design:paramtypes",[Object,String,Object])],(function(v,C,T){this.entity=v,this.componentName=C,this.component=T})),O=r([x(),s("design:paramtypes",[Object,String,Object])],(function(v,C,T){this.entity=v,this.componentName=C,this.classId=T})),M=r([x(),s("design:paramtypes",[Object,Object])],(function(v,C){this.entity=v,this.parent=C}));v.UIValueType=void 0,(A=v.UIValueType||(v.UIValueType={}))[A.PERCENT=0]="PERCENT",A[A.PIXELS=1]="PIXELS";var z=function(){function e(C){if(this.type=v.UIValueType.PIXELS,"string"==typeof C){var T=C;T.indexOf("px")>-1?this.type=v.UIValueType.PIXELS:T.indexOf("%")>-1&&(this.type=v.UIValueType.PERCENT),this.value=parseFloat(T)}else this.value=C}return e.prototype.toString=function(){var C=this.value.toString();return this.type===v.UIValueType.PERCENT?C+="%":C+="px",C},e}(),B="__name__symbol_",V="__classId__symbol_",q="__component__id_",j=r([x(),s("design:paramtypes",[String,String,Number])],(function(v,C,T){this.componentId=v,this.componentName=C,this.classId=T})),H=r([x(),s("design:paramtypes",[String])],(function(v){this.componentId=v})),W=r([x(),s("design:paramtypes",[String,Object])],(function(v,C){this.componentId=v,this.component=C}));function P(v,C){return function(T){if(T.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+T.originalClassName+" with: "+v);var S=T,o=function(){var T=Array.prototype.slice.call(arguments),E=new(S.bind.apply(S,p([void 0],l(T))));return Object.defineProperty(E,B,{enumerable:!1,writable:!1,configurable:!1,value:v}),void 0!==C&&Object.defineProperty(E,V,{enumerable:!1,writable:!1,configurable:!1,value:C}),E};return void 0!==C&&(o.__classId__symbol_=C),o.__name__symbol_=v,o.isComponent=!0,o.originalClassName=v,(o.prototype=T.prototype).constructor=T,o}}function N(v,C){return function(T){if(T.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+T.originalClassName+" with: "+v);if("number"!=typeof C||isNaN(C))throw new Error("classId: "+C+" is an invalid integer");var S=T,o=function(){if(!N.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");var T=Array.prototype.slice.call(arguments),E=new(S.bind.apply(S,p([void 0],l(T)))),A=f("C");return Object.defineProperty(E,B,{enumerable:!1,writable:!1,configurable:!1,value:v}),Object.defineProperty(E,q,{enumerable:!1,writable:!1,configurable:!1,value:A}),void 0!==C&&Object.defineProperty(E,V,{enumerable:!1,writable:!1,configurable:!1,value:C}),N.engine&&N.engine.registerComponent(E),E};return void 0!==C&&(o.__classId__symbol_=C),o.__name__symbol_=v,o.isComponent=!0,o.isDisposableComponent=!0,o.originalClassName=v,(o.prototype=T.prototype).constructor=T,o}}function F(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__name__symbol_)return v.__name__symbol_;throw new TypeError(v+" is not a registered component.")}function L(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__classId__symbol_)return v.__classId__symbol_;if(!v.__name__symbol_)throw new TypeError(v+" is not a registered component.");return null}function D(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__component__id_)return v.__component__id_;throw new TypeError(v+" is not a registered disposable component.")}!function(v){v.engine=null}(N||(N={}));var X=function(){function t(){this.dirty=!1,this.data={},this.subscriptions=[]}return t.component=function(v,C){if(delete v[C]){var T=C+"_"+Math.random();v[T]=void 0,Object.defineProperty(v,T,o(o({},Object.getOwnPropertyDescriptor(v,T)),{enumerable:!1})),Object.defineProperty(v,C.toString(),{get:function(){return this[T]},set:function(v){var S=this[T];if(this.data[C]=v?D(v):null,this[T]=v,v!==S){this.dirty=!0;for(var E=0;E<this.subscriptions.length;E++)this.subscriptions[E](C,v,S)}},enumerable:!0})}},t.field=function(v,C){delete v[C]&&Object.defineProperty(v,C.toString(),{get:function(){return this.data[C]},set:function(v){var T=this.data[C];if(this.data[C]=v,v!==T){this.dirty=!0;for(var S=0;S<this.subscriptions.length;S++)this.subscriptions[S](C,v,T)}},enumerable:!0})},t.uiValue=function(v,C){delete v[C]&&Object.defineProperty(v,C.toString(),{get:function(){return this.data[C].toString()},set:function(v){var T=this.data[C],S=new z(v);if(this.data[C]=S,S!==T){this.dirty=!0;for(var E=0;E<this.subscriptions.length;E++)this.subscriptions[E](C,S,T)}},enumerable:!0})},t.readonly=function(v,C){delete v[C]&&Object.defineProperty(v,C.toString(),{get:function(){if(C in this.data==0)throw new Error("The field "+C+" is uninitialized");return this.data[C]},set:function(v){if(C in this.data)throw new Error("The field "+C+" is readonly");this.data[C]=v,this.dirty=!0},enumerable:!0,configurable:!1})},t.prototype.onChange=function(v){return this.subscriptions.push(v),this},t.prototype.toJSON=function(){return this.data},t}();function U(v){return q in v}var Q=function(){function t(){for(var v=[],C=0;C<arguments.length;C++)v[C]=arguments[C];if(this.entities=[],this.active=!1,this._requiresNames=[],!v)throw new Error("ComponentGroup: Could not load the requires list");if(!(v instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return v.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(var n=function(C){var S=v[C],E=null;if(!S)throw new Error("ComponentGroup: the required component at location "+C+" is invalid");try{E=F(S)}catch(v){throw new Error("ComponentGroup: the required component at location "+C+" is not registered as a @Component. Remember to provide the class of the component, not the name")}if(T._requiresNames.some((function(v){return v===E})))throw new Error("ComponentGroup: the required component list has a repeated name "+E);T._requiresNames.push(E)},T=this,S=0;S<v.length;S++)n(S)}return t.prototype.hasEntity=function(v){return!!v.isAddedToEngine()&&-1!==this.entities.indexOf(v)},t.prototype.addEntity=function(v){if(!v.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(v)&&this.entities.push(v)},t.prototype.removeEntity=function(v){var C=this.entities.indexOf(v);-1!==C&&this.entities.splice(C,1)},t.prototype.componentRemoved=function(v,C){-1!==this._requiresNames.indexOf(C)&&this.removeEntity(v)},t.prototype.meetsRequirements=function(v){for(var C=0;C<this._requiresNames.length;C++)if(!(this._requiresNames[C]in v.components))return!1;return!0},t}(),Z=function(){function t(v){this.name=v,this.children={},this.eventManager=null,this.alive=!1,this.uuid=f("E"),this.components={},this.engine=null,this._parent=null}return t.prototype.addComponentOrReplace=function(v){if("function"==typeof v)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof v)throw new Error("You passed a "+typeof v+", an instance of component is expected");var C=F(v);if(this.components[C]){if(this.components[C]===v)return v;this.removeComponent(this.components[C],!1)}return this.addComponent(v)},t.prototype.hasComponent=function(v){var C=typeof v;if("string"!==C&&"object"!==C&&"function"!==C)throw new Error("Entity#has(component): component is not a class, name or instance");if(null===v)return!1;var T="string"===C?v:F(v),S=this.components[T];return!!S&&("object"===C?S===v:"function"!==C||S instanceof v)},t.prototype.getComponent=function(v){var C=typeof v;if("string"!==C&&"function"!==C)throw new Error("Entity#get(component): component is not a class or name");var T="string"===C?v:F(v),S=this.components[T];if(!S)throw new Error('Can not get component "'+T+'" from entity "'+this.identifier+'"');if("function"===C){if(S instanceof v)return S;throw new Error('Can not get component "'+T+'" from entity "'+this.identifier+'" (by instance)')}return S},t.prototype.getComponentOrNull=function(v){var C=typeof v;if("string"!==C&&"function"!==C)throw new Error("Entity#getOrNull(component): component is not a class or name");var T="string"===C?v:F(v),S=this.components[T];return S?"function"===C?S instanceof v?S:null:S:null},t.prototype.getComponentOrCreate=function(v){if("function"!=typeof v)throw new Error("Entity#getOrCreate(component): component is not a class");var C=this.getComponentOrNull(v);return C||(F(C=new v),this.addComponentOrReplace(C)),C},t.prototype.addComponent=function(v){if("object"!=typeof v)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");var C=F(v),T=L(v);if(this.components[C])throw new Error('A component of type "'+C+'" is already present in entity "'+this.identifier+'"');this.components[C]=v,this.eventManager&&this.eventManager.fireEvent(new O(this,C,T));var S=v;return"function"==typeof S.addedToEntity&&S.addedToEntity(this),v},t.prototype.removeComponent=function(v,C){void 0===C&&(C=!0);var T=typeof v;if("string"!==T&&"function"!==T&&"object"!==T)throw new Error("Entity#remove(component): component is not a class, class or name");var S="string"===T?v:F(v),E=this.components[S];if(E){if("function"===T)return E instanceof v?(delete this.components[S],void(E&&(C&&this.eventManager&&this.eventManager.fireEvent(new R(this,S,E)),"function"==typeof E.removedFromEntity&&E.removedFromEntity(this)))):void c('Entity Warning: Trying to remove wrong (by constructor) component "'+S+'" from entity "'+this.identifier+'"');delete this.components[S],E&&(C&&this.eventManager&&this.eventManager.fireEvent(new R(this,S,E)),"function"==typeof E.removedFromEntity&&E.removedFromEntity(this))}else c('Entity Warning: Trying to remove inexisting component "'+S+'" from entity "'+this.identifier+'"')},t.prototype.isAddedToEngine=function(){return!(!this.engine||!(this.uuid in this.engine.entities)&&this.engine.rootEntity!==this)},t.prototype.setParent=function(v){var C;if(v&&"getEntityRepresentation"in v){if(!this.engine)throw new Error("In order to set an attachable as parent, you first need to add the entity to the engine.");C=v.getEntityRepresentation(this.engine)}else C=!v&&this.engine?this.engine.rootEntity:v;var T=this.getParent();if(C===this)throw new Error('Failed to set parent for entity "'+this.identifier+"\": An entity can't set itself as a its own parent");if(C===T)return this;var S=this.getCircularAncestor(C);if(S)throw new Error('Failed to set parent for entity "'+this.identifier+'": Circular parent references are not allowed (See entity "'+S+'")');return T&&delete T.children[this.uuid],null!==C&&"0"!==C.uuid&&(!C.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),C.isAddedToEngine()&&!this.isAddedToEngine()&&C.engine.addEntity(this)),this._parent=C||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new M(this,C)),this},t.prototype.getParent=function(){return this._parent},Object.defineProperty(t.prototype,"identifier",{get:function(){return this.name||this.uuid},enumerable:!1,configurable:!0}),t.prototype.getCircularAncestor=function(v){for(var C=this.engine?this.engine.rootEntity:null,T=v;T&&T!==C;){var S=T.getParent();if(S===this)return T.uuid;T=S}return null},t.prototype.registerAsChild=function(){var v=this.getParent();this.uuid&&v&&(v.children[this.uuid]=this)},t}(),J=function(){function t(v){this.eventManager=new E,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(O,this,this.componentAddedHandler),this.eventManager.addListener(R,this,this.componentRemovedHandler),this.rootEntity=v,this.firstPersonCameraEntity=new Z,this.firstPersonCameraEntity.uuid="FirstPersonCameraEntityReference",this.addEntity(this.firstPersonCameraEntity),this.avatarEntity=new Z,this.avatarEntity.uuid="AvatarEntityReference",this.addEntity(this.avatarEntity)}return Object.defineProperty(t.prototype,"entities",{get:function(){return this._entities},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disposableComponents",{get:function(){return this._disposableComponents},enumerable:!1,configurable:!0}),t.prototype.addEntity=function(v){var C=v.getParent();if(v.isAddedToEngine())return v;for(var T in v.eventManager=this.eventManager,v.engine=this,this._entities[v.uuid]=v,this.checkRequirementsAndAdd(v),C?C.isAddedToEngine()||C===this.rootEntity||c("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+C.uuid):v.setParent(this.rootEntity),v.alive=!0,v.children){var S=v.children[T];S&&(S.isAddedToEngine()||this.addEntity(S))}return v},t.prototype.removeEntity=function(v){var C=v.uuid;if(v.isAddedToEngine()){for(var T in v.components){var S=this._componentGroups[T];if(S)for(var E in S)S[E].removeEntity(v);delete this.entityLists[T][C]}for(var A=0;A<this.simpleSystems.length;A++){var R=this.simpleSystems[A];R.onRemoveEntity&&R.onRemoveEntity(v)}for(var A in v.children){var O=v.children[A];O&&this.removeEntity(O)}return v.alive=!1,v.eventManager=null,delete this._entities[C],!0}for(var T in c("Engine: Trying to remove non existent entity from engine."),v.isAddedToEngine()?c("Engine: Entity id: "+C):c('Engine: Entity "'+v.uuid+'" has not been added to any engine yet.'),c("Engine: Entity's components:"),v.components)c(T);return!1},t.prototype.addSystem=function(v,C){if(void 0===C&&(C=0),-1!==this.addedSystems.indexOf(v))return c("Engine: Trying to add a system that is already added. Aborting"),v;if(this.systems.length>0)for(var T=0;T<this.systems.length;T++){var S=this.systems[T],E=T===this.systems.length-1;if(S.priority>C){this.addedSystems.push(v),this.systems.splice(T,0,{system:v,priority:C});break}if(E){this.addedSystems.push(v),this.systems.splice(T+1,0,{system:v,priority:C});break}}else this.addedSystems.push(v),this.systems.splice(1,0,{system:v,priority:C});return this.registerSystem(v),v},t.prototype.removeSystem=function(v){var C=this.addedSystems.indexOf(v);if(-1!==C){v.active=!1,v.deactivate&&v.deactivate(),this.addedSystems.splice(C,1);for(var T=0;T<this.systems.length;T++)this.systems[T].system===v&&this.systems.splice(T,1);return!0}return!1},t.prototype.update=function(v){for(var C in this.systems){var T=this.systems[C].system;if(T.active&&T.update)try{T.update(v)}catch(v){y(v)}}return this},t.prototype.getEntitiesWithComponent=function(v){var C="string"==typeof v?v:F(v);return C in this.entityLists?this.entityLists[C]:this.entityLists[C]={}},t.prototype.registerComponent=function(v){var C=D(v),T=F(v),S=L(v);this._disposableComponents[C]=v,null!==S&&(this.eventManager.fireEvent(new j(C,T,S)),this.eventManager.fireEvent(new W(C,v)))},t.prototype.disposeComponent=function(v){var C=D(v);return delete this._disposableComponents[C]&&(this.eventManager.fireEvent(new H(C)),v.onDispose&&v.onDispose(),!0)},t.prototype.updateComponent=function(v){this.eventManager.fireEvent(new W(D(v),v))},t.prototype.getComponentGroup=function(){for(var v=[],C=0;C<arguments.length;C++)v[C]=arguments[C];var T=void 0;if(v.length>0&&(M=this._componentGroups[F(v[0])]))for(var S=v.slice(),E=0;E<M.length;E++){var A=M[E];if(S.length===A.requires.length){for(var R=0;R<S.length&&-1!==A.requires.indexOf(S[R]);R++)R===S.length-1&&(T=A);if(T)break}}if(T)return T;(T=new(Q.bind.apply(Q,p([void 0],l(v))))).active=!0;var O=T.requiresNames;for(E=0;E<O.length;E++){var M,z=O[E];(M=this._componentGroups[z])||(this._componentGroups[z]=M=[]),-1===M.indexOf(T)&&M.push(T)}for(var B in this._entities)this.checkRequirements(this._entities[B],T);return T},t.prototype.removeComponentGroup=function(v){if(v.active){v.active=!1;for(var C=v.requiresNames,T=0;T<C.length;T++){var S=C[T],E=this._componentGroups[S];if(E){var A=E.indexOf(v);-1!==A&&E.splice(A,1)}}return!0}return!1},t.prototype.registerSystem=function(v){v.active=!0,v.activate&&v.activate(this),this.simpleSystems.push(v)},t.prototype.checkRequirementsAndAdd=function(v){if(v.isAddedToEngine()){for(var C in v.components){C in this.entityLists||(this.entityLists[C]={}),this.entityLists[C][v.uuid]=v;var T=this._componentGroups[C];if(T)for(var S in T)this.checkRequirements(v,T[S])}for(var E=0;E<this.simpleSystems.length;E++){var A=this.simpleSystems[E];A.onAddEntity&&A.onAddEntity(v)}}},t.prototype.checkRequirements=function(v,C){C.meetsRequirements(v)?C.hasEntity(v)||C.addEntity(v):C.hasEntity(v)&&C.removeEntity(v)},t.prototype.componentAddedHandler=function(v){var C,T=v.entity,S=v.componentName;if(T.isAddedToEngine()){this.entityLists[S]?this.entityLists[S][T.uuid]=T:this.entityLists[S]=((C={})[T.uuid]=T,C);var E=this._componentGroups[S];if(E)for(var A in E)this.checkRequirements(T,E[A])}},t.prototype.componentRemovedHandler=function(v){var C=v.entity,T=v.componentName;if(C.isAddedToEngine()){delete this.entityLists[T][C.uuid];var S=this._componentGroups[T];if(S)for(var E in S)this.checkRequirements(C,S[E])}},t}(),K=Promise.resolve().then.bind(Promise.resolve());function G(v){var C=K(v);return C.isComplete=!1,C.then((function(v){C.isComplete=!0,C.result=v,C.didFail=!1})).catch((function(v){C.isComplete=!0,C.error=v,C.didFail=!0,y("executeTask: FAILED "+v.toString(),v)})),C}var $,et,nt=function(){function t(v,C,T,S){void 0===C&&(C=!1),this.initalize(v,C,T,S)}return t.prototype.initalize=function(v,C,T,S){return void 0===C&&(C=!1),this.mask=v,this.skipNextObservers=C,this.target=T,this.currentTarget=S,this},t}(),Y=function(v,C,T){void 0===T&&(T=null),this.callback=v,this.mask=C,this.scope=T,this.unregisterOnNextCall=!1,this._willBeUnregistered=!1},it=function(){function t(){this._observers=null,this._observables=null}return t.Watch=function(v,C,T,S){var E,A;void 0===T&&(T=-1),void 0===S&&(S=null);var R=new t;R._observers=new Array,R._observables=v;try{for(var O=h(v),M=O.next();!M.done;M=O.next()){var z=M.value.add(C,T,!1,S);z&&R._observers.push(z)}}catch(v){E={error:v}}finally{try{M&&!M.done&&(A=O.return)&&A.call(O)}finally{if(E)throw E.error}}return R},t.prototype.dispose=function(){if(this._observers&&this._observables)for(var v=0;v<this._observers.length;v++)this._observables[v].remove(this._observers[v]);this._observers=null,this._observables=null},t}(),ot=function(){function t(v){this._observers=new Array,this._onObserverAdded=null,this._eventState=new nt(0),v&&(this._onObserverAdded=v)}return t.prototype.add=function(v,C,T,S,E){if(void 0===C&&(C=-1),void 0===T&&(T=!1),void 0===S&&(S=null),void 0===E&&(E=!1),!v)return null;var A=new Y(v,C,S);return A.unregisterOnNextCall=E,T?this._observers.unshift(A):this._observers.push(A),this._onObserverAdded&&this._onObserverAdded(A),A},t.prototype.addOnce=function(v){return this.add(v,void 0,void 0,void 0,!0)},t.prototype.remove=function(v){return!!v&&-1!==this._observers.indexOf(v)&&(this._deferUnregister(v),!0)},t.prototype.removeCallback=function(v,C){for(var T=0;T<this._observers.length;T++)if(this._observers[T].callback===v&&(!C||C===this._observers[T].scope))return this._deferUnregister(this._observers[T]),!0;return!1},t.prototype.notifyObservers=function(v,C,T,S){var E,A;if(void 0===C&&(C=-1),!this._observers.length)return!0;var R=this._eventState;R.mask=C,R.target=T,R.currentTarget=S,R.skipNextObservers=!1,R.lastReturnValue=v;try{for(var O=h(this._observers),M=O.next();!M.done;M=O.next()){var z=M.value;if(!z._willBeUnregistered&&(z.mask&C&&(z.scope?R.lastReturnValue=z.callback.apply(z.scope,[v,R]):R.lastReturnValue=z.callback(v,R),z.unregisterOnNextCall&&this._deferUnregister(z)),R.skipNextObservers))return!1}}catch(v){E={error:v}}finally{try{M&&!M.done&&(A=O.return)&&A.call(O)}finally{if(E)throw E.error}}return!0},t.prototype.notifyObserversWithPromise=function(v,C,T,S){var E=this;void 0===C&&(C=-1);var A=Promise.resolve(v);if(!this._observers.length)return A;var R=this._eventState;return R.mask=C,R.target=T,R.currentTarget=S,R.skipNextObservers=!1,this._observers.forEach((function(T){R.skipNextObservers||T._willBeUnregistered||T.mask&C&&(A=T.scope?A.then((function(C){return R.lastReturnValue=C,T.callback.apply(T.scope,[v,R])})):A.then((function(C){return R.lastReturnValue=C,T.callback(v,R)})),T.unregisterOnNextCall&&E._deferUnregister(T))})),A.then((function(){return v}))},t.prototype.notifyObserver=function(v,C,T){void 0===T&&(T=-1);var S=this._eventState;S.mask=T,S.skipNextObservers=!1,v.callback(C,S)},t.prototype.hasObservers=function(){return this._observers.length>0},t.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},t.prototype.clone=function(){var v=new t;return v._observers=this._observers.slice(0),v},t.prototype.hasSpecificMask=function(v){var C,T;void 0===v&&(v=-1);try{for(var S=h(this._observers),E=S.next();!E.done;E=S.next()){var A=E.value;if(A.mask&v||A.mask===v)return!0}}catch(v){C={error:v}}finally{try{E&&!E.done&&(T=S.return)&&T.call(S)}finally{if(C)throw C.error}}return!1},t.prototype._deferUnregister=function(v){var C=this;v.unregisterOnNextCall=!1,v._willBeUnregistered=!0,G((function(){return function(v,C,T,S){return new(T||(T=Promise))((function(C,E){function s(v){try{d(S.next(v))}catch(v){E(v)}}function a(v){try{d(S.throw(v))}catch(v){E(v)}}function d(v){var S;v.done?C(v.value):(S=v.value,S instanceof T?S:new T((function(v){v(S)}))).then(s,a)}d((S=S.apply(v,[])).next())}))}(C,0,void 0,(function(){return function(v,C){var T,S,E,A,R={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return A={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function a(A){return function(O){return function(A){if(T)throw new TypeError("Generator is already executing.");for(;R;)try{if(T=1,S&&(E=2&A[0]?S.return:A[0]?S.throw||((E=S.return)&&E.call(S),0):S.next)&&!(E=E.call(S,A[1])).done)return E;switch(S=0,E&&(A=[2&A[0],E.value]),A[0]){case 0:case 1:E=A;break;case 4:return R.label++,{value:A[1],done:!1};case 5:R.label++,S=A[1],A=[0];continue;case 7:A=R.ops.pop(),R.trys.pop();continue;default:if(!((E=(E=R.trys).length>0&&E[E.length-1])||6!==A[0]&&2!==A[0])){R=0;continue}if(3===A[0]&&(!E||A[1]>E[0]&&A[1]<E[3])){R.label=A[1];break}if(6===A[0]&&R.label<E[1]){R.label=E[1],E=A;break}if(E&&R.label<E[2]){R.label=E[2],R.ops.push(A);break}E[2]&&R.ops.pop(),R.trys.pop();continue}A=C.call(v,R)}catch(v){A=[6,v],S=0}finally{T=E=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([A,O])}}}(this,(function(C){return[2,this._remove(v)]}))}))}))},t.prototype._remove=function(v){if(!v)return!1;var C=this._observers.indexOf(v);return-1!==C&&(this._observers.splice(C,1),!0)},t}(),rt=r([x(),s("design:paramtypes",[String,Object])],(function(v,C){this.uuid=v,this.payload=C})),st=r([x(),s("design:paramtypes",[Object])],(function(v){this.payload=v})),at=r([x(),s("design:paramtypes",[Object])],(function(v){this.payload=v}));function tt(v){return function(){et&&et.subscribe(v)}}var ct=new ot(tt("cameraModeChanged")),lt=new ot(tt("idleStateChanged")),dt=new ot(tt("onEnterScene")),ht=dt,ut=new ot(tt("onLeaveScene")),pt=ut,ft=new ot(tt("sceneStart")),yt=new ot(tt("playerExpression")),gt=new ot(tt("onPointerLock")),vt=new ot(tt("videoEvent")),wt=new ot(tt("profileChanged")),Ct=new ot(tt("playerConnected")),bt=new ot(tt("playerDisconnected")),Tt=new ot(tt("onRealmChanged")),St=new ot(tt("playerClicked"));function mt(v){(et=v)&&et.onEvent((function(v){switch(v.type){case"onEnterScene":return void dt.notifyObservers(v.data);case"onLeaveScene":return void ut.notifyObservers(v.data);case"cameraModeChanged":return void ct.notifyObservers(v.data);case"idleStateChanged":return void lt.notifyObservers(v.data);case"sceneStart":return void ft.notifyObservers(v.data);case"playerExpression":return void yt.notifyObservers(v.data);case"videoEvent":var C=v.data,T=N.engine.disposableComponents[C.componentId];return T&&T.update(C),void vt.notifyObservers(C);case"profileChanged":return void wt.notifyObservers(v.data);case"onPointerLock":return void gt.notifyObservers(v.data);case"playerConnected":return void Ct.notifyObservers(v.data);case"playerDisconnected":return void bt.notifyObservers(v.data);case"onRealmChanged":return void Tt.notifyObservers(v.data);case"playerClicked":return void St.notifyObservers(v.data)}}))}var xt=function(){function t(v){this.dcl=v,this.cachedComponents={}}return t.prototype.activate=function(v){var C=this;this.engine=v,v.eventManager.addListener(O,this,this.componentAdded),v.eventManager.addListener(R,this,this.componentRemoved),v.eventManager.addListener(j,this,this.disposableComponentCreated),v.eventManager.addListener(H,this,this.disposableComponentRemoved),v.eventManager.addListener(W,this,this.disposableComponentUpdated),v.eventManager.addListener(M,this,this.parentChanged);var T=v.rootEntity.uuid;this.dcl.addEntity(T),this.dcl.onUpdate((function(T){v.update(T),C.presentEntities()})),this.dcl.onEvent((function(C){var T=C.data;switch(C.type){case"uuidEvent":v.eventManager.fireEvent(new rt(T.uuid,T.payload));break;case"raycastResponse":("HitFirst"===T.queryType||"HitAll"===T.queryType)&&v.eventManager.fireEvent(new st(T));break;case"actionButtonEvent":v.eventManager.fireEvent(new at(T.payload))}}))},t.prototype.onAddEntity=function(v){if(v&&v.isAddedToEngine()){var C=v.uuid,T=v.getParent();for(var S in this.dcl.addEntity(C),T&&this.dcl.setParent(C,T.uuid),this.cachedComponents[C]={},v.components){var E=v.components[S],A=L(E);if(null!==A)if(U(E))this.dcl.attachEntityComponent(v.uuid,S,D(E));else{var R=JSON.stringify(E);this.dcl.updateEntityComponent(C,S,A,R),this.cachedComponents[C][S]=R}}}},t.prototype.onRemoveEntity=function(v){if(v.isAddedToEngine()){var C=v.uuid;this.dcl.removeEntity(C),delete this.cachedComponents[C]}},t.prototype.presentEntities=function(){for(var v in this.engine.entities){var C=this.engine.entities[v];for(var T in C.components){var S=L(R=C.components[T]);if(null!==S&&!U(R)){var E=this.getJsonIfDirty(C.uuid,T,R);E&&(this.dcl.updateEntityComponent(C.uuid,T,S,E),this.clearDirty(C.uuid,T,R,E))}}}for(var A in this.engine.disposableComponents){var R;(R=this.engine.disposableComponents[A])instanceof X&&R.dirty&&(this.dcl.componentUpdated(A,JSON.stringify(R)),R.dirty=!1)}},t.prototype.componentAdded=function(v){if(v.entity.isAddedToEngine()){var C=v.entity.components[v.componentName];if(U(C))this.dcl.attachEntityComponent(v.entity.uuid,v.componentName,D(C));else if(null!==v.classId){var T=JSON.stringify(C);this.dcl.updateEntityComponent(v.entity.uuid,v.componentName,v.classId,T),this.cachedComponents[v.entity.uuid][v.componentName]=T}}},t.prototype.componentRemoved=function(v){v.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(v.entity.uuid,v.componentName),delete this.cachedComponents[v.entity.uuid][v.componentName])},t.prototype.disposableComponentCreated=function(v){this.dcl.componentCreated(v.componentId,v.componentName,v.classId)},t.prototype.disposableComponentRemoved=function(v){this.dcl.componentDisposed(v.componentId)},t.prototype.disposableComponentUpdated=function(v){this.dcl.componentUpdated(v.componentId,JSON.stringify(v.component))},t.prototype.parentChanged=function(v){this.dcl.setParent(v.entity.uuid,v.parent?v.parent.uuid:"0")},t.prototype.getJsonIfDirty=function(v,C,T){var S=JSON.stringify(T);return S!==this.cachedComponents[v][C]&&S},t.prototype.clearDirty=function(v,C,T,S){this.cachedComponents[v][C]=S},t}(),At="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_t={},Rt={};!function(v){var C,T;Object.defineProperty(v,"__esModule",{value:!0}),v.RAD2DEG=v.DEG2RAD=v.Epsilon=v.ToLinearSpace=v.ToGammaSpace=v.Space=v.Orientation=void 0,(C=v.Orientation||(v.Orientation={}))[C.CW=0]="CW",C[C.CCW=1]="CCW",(T=v.Space||(v.Space={}))[T.LOCAL=0]="LOCAL",T[T.WORLD=1]="WORLD",T[T.BONE=2]="BONE",v.ToGammaSpace=1/2.2,v.ToLinearSpace=2.2,v.Epsilon=1e-6,v.DEG2RAD=Math.PI/180,v.RAD2DEG=360/(2*Math.PI)}(Rt);var Pt={},It={};Object.defineProperty(It,"__esModule",{value:!0}),It.buildArray=void 0,It.buildArray=function(v,C){const T=[];for(let S=0;S<v;++S)T.push(C());return T};var Ot={},zt={},Bt={},Nt={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.Scalar=void 0;class Et{static WithinEpsilon(v,C,T=1401298e-51){const S=v-C;return-T<=S&&S<=T}static ToHex(v){const C=v.toString(16);return v<=15?("0"+C).toUpperCase():C.toUpperCase()}static Sign(v){const C=+v;return 0===C||isNaN(C)?C:C>0?1:-1}static Clamp(v,C=0,T=1){return Math.min(T,Math.max(C,v))}static Log2(v){return Math.log(v)*Math.LOG2E}static Repeat(v,C){return v-Math.floor(v/C)*C}static Normalize(v,C,T){return(v-C)/(T-C)}static Denormalize(v,C,T){return v*(T-C)+C}static DeltaAngle(v,C){let T=Et.Repeat(C-v,360);return T>180&&(T-=360),T}static PingPong(v,C){const T=Et.Repeat(v,2*C);return C-Math.abs(T-C)}static SmoothStep(v,C,T){let S=Et.Clamp(T);return S=-2*S*S*S+3*S*S,C*S+v*(1-S)}static MoveTowards(v,C,T){let S=0;return S=Math.abs(C-v)<=T?C:v+Et.Sign(C-v)*T,S}static MoveTowardsAngle(v,C,T){const S=Et.DeltaAngle(v,C);let E=0;return E=-T<S&&S<T?C:Et.MoveTowards(v,v+S,T),E}static Lerp(v,C,T){return v+(C-v)*T}static LerpAngle(v,C,T){let S=Et.Repeat(C-v,360);return S>180&&(S-=360),v+S*Et.Clamp(T)}static InverseLerp(v,C,T){let S=0;return S=v!==C?Et.Clamp((T-v)/(C-v)):0,S}static Hermite(v,C,T,S,E){const A=E*E,R=E*A;return v*(2*R-3*A+1)+T*(-2*R+3*A)+C*(R-2*A+E)+S*(R-A)}static RandomRange(v,C){return v===C?v:Math.random()*(C-v)+v}static RangeToPercent(v,C,T){return(v-C)/(T-C)}static PercentToRange(v,C,T){return(T-C)*v+C}static NormalizeRadians(v){return v-Et.TwoPi*Math.floor((v+Math.PI)/Et.TwoPi)}}Lt.Scalar=Et,Et.TwoPi=2*Math.PI,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.Vector4=void 0;const kt=Rt,Ft=Lt,Vt=Ot;class Mt{constructor(v,C,T,S){this.x=v,this.y=C,this.z=T,this.w=S}static Add(v,C){return new Mt(v.x,v.y,v.z,v.w).addInPlace(C)}static FromArray(v,C=0){return new Mt(v[C],v[C+1],v[C+2],v[C+3])}static FromArrayToRef(v,C,T){T.x=v[C],T.y=v[C+1],T.z=v[C+2],T.w=v[C+3]}static FromFloatArrayToRef(v,C,T){Mt.FromArrayToRef(v,C,T)}static FromFloatsToRef(v,C,T,S,E){E.x=v,E.y=C,E.z=T,E.w=S}static Zero(){return new Mt(0,0,0,0)}static One(){return new Mt(1,1,1,1)}static Normalize(v){const C=Mt.Zero();return Mt.NormalizeToRef(v,C),C}static NormalizeToRef(v,C){C.copyFrom(v),C.normalize()}static Minimize(v,C){const T=new Mt(v.x,v.y,v.z,v.w);return T.minimizeInPlace(C),T}static Maximize(v,C){const T=new Mt(v.x,v.y,v.z,v.w);return T.maximizeInPlace(C),T}static Distance(v,C){return Math.sqrt(Mt.DistanceSquared(v,C))}static DistanceSquared(v,C){const T=v.x-C.x,S=v.y-C.y,E=v.z-C.z,A=v.w-C.w;return T*T+S*S+E*E+A*A}static Center(v,C){const T=Mt.Add(v,C);return T.scaleInPlace(.5),T}static TransformNormal(v,C){const T=Mt.Zero();return Mt.TransformNormalToRef(v,C,T),T}static TransformNormalToRef(v,C,T){const S=C.m,E=v.x*S[0]+v.y*S[4]+v.z*S[8],A=v.x*S[1]+v.y*S[5]+v.z*S[9],R=v.x*S[2]+v.y*S[6]+v.z*S[10];T.x=E,T.y=A,T.z=R,T.w=v.w}static TransformNormalFromFloatsToRef(v,C,T,S,E,A){const R=E.m;A.x=v*R[0]+C*R[4]+T*R[8],A.y=v*R[1]+C*R[5]+T*R[9],A.z=v*R[2]+C*R[6]+T*R[10],A.w=S}toString(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"}getClassName(){return"Vector4"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v=397*v^(this.w||0),v}asArray(){const v=new Array;return this.toArray(v,0),v}toArray(v,C=0){return v[C]=this.x,v[C+1]=this.y,v[C+2]=this.z,v[C+3]=this.w,this}addInPlace(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this.w+=v.w,this}add(v){return new Mt(this.x+v.x,this.y+v.y,this.z+v.z,this.w+v.w)}addToRef(v,C){return C.x=this.x+v.x,C.y=this.y+v.y,C.z=this.z+v.z,C.w=this.w+v.w,this}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this.w-=v.w,this}subtract(v){return new Mt(this.x-v.x,this.y-v.y,this.z-v.z,this.w-v.w)}subtractToRef(v,C){return C.x=this.x-v.x,C.y=this.y-v.y,C.z=this.z-v.z,C.w=this.w-v.w,this}subtractFromFloats(v,C,T,S){return new Mt(this.x-v,this.y-C,this.z-T,this.w-S)}subtractFromFloatsToRef(v,C,T,S,E){return E.x=this.x-v,E.y=this.y-C,E.z=this.z-T,E.w=this.w-S,this}negate(){return new Mt(-this.x,-this.y,-this.z,-this.w)}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}scale(v){return new Mt(this.x*v,this.y*v,this.z*v,this.w*v)}scaleToRef(v,C){return C.x=this.x*v,C.y=this.y*v,C.z=this.z*v,C.w=this.w*v,this}scaleAndAddToRef(v,C){return C.x+=this.x*v,C.y+=this.y*v,C.z+=this.z*v,C.w+=this.w*v,this}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z&&this.w===v.w}equalsWithEpsilon(v,C=kt.Epsilon){return v&&Ft.Scalar.WithinEpsilon(this.x,v.x,C)&&Ft.Scalar.WithinEpsilon(this.y,v.y,C)&&Ft.Scalar.WithinEpsilon(this.z,v.z,C)&&Ft.Scalar.WithinEpsilon(this.w,v.w,C)}equalsToFloats(v,C,T,S){return this.x===v&&this.y===C&&this.z===T&&this.w===S}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z,this.w*=v.w,this}multiply(v){return new Mt(this.x*v.x,this.y*v.y,this.z*v.z,this.w*v.w)}multiplyToRef(v,C){return C.x=this.x*v.x,C.y=this.y*v.y,C.z=this.z*v.z,C.w=this.w*v.w,this}multiplyByFloats(v,C,T,S){return new Mt(this.x*v,this.y*C,this.z*T,this.w*S)}divide(v){return new Mt(this.x/v.x,this.y/v.y,this.z/v.z,this.w/v.w)}divideToRef(v,C){return C.x=this.x/v.x,C.y=this.y/v.y,C.z=this.z/v.z,C.w=this.w/v.w,this}divideInPlace(v){return this.divideToRef(v,this)}minimizeInPlace(v){return v.x<this.x&&(this.x=v.x),v.y<this.y&&(this.y=v.y),v.z<this.z&&(this.z=v.z),v.w<this.w&&(this.w=v.w),this}maximizeInPlace(v){return v.x>this.x&&(this.x=v.x),v.y>this.y&&(this.y=v.y),v.z>this.z&&(this.z=v.z),v.w>this.w&&(this.w=v.w),this}floor(){return new Mt(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new Mt(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){const v=this.length();return 0===v?this:this.scaleInPlace(1/v)}toVector3(){return new Vt.Vector3(this.x,this.y,this.z)}clone(){return new Mt(this.x,this.y,this.z,this.w)}copyFrom(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=v.w,this}copyFromFloats(v,C,T,S){return this.x=v,this.y=C,this.z=T,this.w=S,this}set(v,C,T,S){return this.copyFromFloats(v,C,T,S)}setAll(v){return this.x=this.y=this.z=this.w=v,this}}Nt.Vector4=Mt,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.Matrix=void 0;const Ut=Ot,qt=zt,Ht=Pt,Gt=Nt;class Dt{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}get m(){return this._m}static get IdentityReadOnly(){return Dt._identityReadOnly}static FromArray(v,C=0){const T=new Dt;return Dt.FromArrayToRef(v,C,T),T}static FromArrayToRef(v,C,T){for(let S=0;S<16;S++)T._m[S]=v[S+C];T._markAsUpdated()}static FromFloatArrayToRefScaled(v,C,T,S){for(let E=0;E<16;E++)S._m[E]=v[E+C]*T;S._markAsUpdated()}static FromValuesToRef(v,C,T,S,E,A,R,O,M,z,B,V,q,j,H,W,X){const Q=X._m;Q[0]=v,Q[1]=C,Q[2]=T,Q[3]=S,Q[4]=E,Q[5]=A,Q[6]=R,Q[7]=O,Q[8]=M,Q[9]=z,Q[10]=B,Q[11]=V,Q[12]=q,Q[13]=j,Q[14]=H,Q[15]=W,X._markAsUpdated()}static FromValues(v,C,T,S,E,A,R,O,M,z,B,V,q,j,H,W){const X=new Dt,Q=X._m;return Q[0]=v,Q[1]=C,Q[2]=T,Q[3]=S,Q[4]=E,Q[5]=A,Q[6]=R,Q[7]=O,Q[8]=M,Q[9]=z,Q[10]=B,Q[11]=V,Q[12]=q,Q[13]=j,Q[14]=H,Q[15]=W,X._markAsUpdated(),X}static Compose(v,C,T){const S=new Dt;return Dt.ComposeToRef(v,C,T,S),S}static ComposeToRef(v,C,T,S){Dt.ScalingToRef(v.x,v.y,v.z,Ht.MathTmp.Matrix[1]),C.toRotationMatrix(Ht.MathTmp.Matrix[0]),Ht.MathTmp.Matrix[1].multiplyToRef(Ht.MathTmp.Matrix[0],S),S.setTranslation(T)}static Identity(){const v=Dt.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return v._updateIdentityStatus(!0),v}static IdentityToRef(v){Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,v),v._updateIdentityStatus(!0)}static Zero(){const v=Dt.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return v._updateIdentityStatus(!1),v}static RotationX(v){const C=new Dt;return Dt.RotationXToRef(v,C),C}static Invert(v){const C=new Dt;return v.invertToRef(C),C}static RotationXToRef(v,C){const T=Math.sin(v),S=Math.cos(v);Dt.FromValuesToRef(1,0,0,0,0,S,T,0,0,-T,S,0,0,0,0,1,C),C._updateIdentityStatus(1===S&&0===T)}static RotationY(v){const C=new Dt;return Dt.RotationYToRef(v,C),C}static RotationYToRef(v,C){const T=Math.sin(v),S=Math.cos(v);Dt.FromValuesToRef(S,0,-T,0,0,1,0,0,T,0,S,0,0,0,0,1,C),C._updateIdentityStatus(1===S&&0===T)}static RotationZ(v){const C=new Dt;return Dt.RotationZToRef(v,C),C}static RotationZToRef(v,C){const T=Math.sin(v),S=Math.cos(v);Dt.FromValuesToRef(S,T,0,0,-T,S,0,0,0,0,1,0,0,0,0,1,C),C._updateIdentityStatus(1===S&&0===T)}static RotationAxis(v,C){const T=new Dt;return Dt.RotationAxisToRef(v,C,T),T}static RotationAxisToRef(v,C,T){const S=Math.sin(-C),E=Math.cos(-C),A=1-E;v.normalize();const R=T._m;R[0]=v.x*v.x*A+E,R[1]=v.x*v.y*A-v.z*S,R[2]=v.x*v.z*A+v.y*S,R[3]=0,R[4]=v.y*v.x*A+v.z*S,R[5]=v.y*v.y*A+E,R[6]=v.y*v.z*A-v.x*S,R[7]=0,R[8]=v.z*v.x*A-v.y*S,R[9]=v.z*v.y*A+v.x*S,R[10]=v.z*v.z*A+E,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,T._markAsUpdated()}static RotationYawPitchRoll(v,C,T){const S=new Dt;return Dt.RotationYawPitchRollToRef(v,C,T,S),S}static RotationYawPitchRollToRef(v,C,T,S){qt.Quaternion.RotationYawPitchRollToRef(v,C,T,Ht.MathTmp.Quaternion[0]),Ht.MathTmp.Quaternion[0].toRotationMatrix(S)}static Scaling(v,C,T){const S=new Dt;return Dt.ScalingToRef(v,C,T,S),S}static ScalingToRef(v,C,T,S){Dt.FromValuesToRef(v,0,0,0,0,C,0,0,0,0,T,0,0,0,0,1,S),S._updateIdentityStatus(1===v&&1===C&&1===T)}static Translation(v,C,T){const S=new Dt;return Dt.TranslationToRef(v,C,T,S),S}static TranslationToRef(v,C,T,S){Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,v,C,T,1,S),S._updateIdentityStatus(0===v&&0===C&&0===T)}static Lerp(v,C,T){const S=new Dt;return Dt.LerpToRef(v,C,T,S),S}static LerpToRef(v,C,T,S){for(let E=0;E<16;E++)S._m[E]=v._m[E]*(1-T)+C._m[E]*T;S._markAsUpdated()}static DecomposeLerp(v,C,T){const S=new Dt;return Dt.DecomposeLerpToRef(v,C,T,S),S}static DecomposeLerpToRef(v,C,T,S){const E=Ht.MathTmp.Vector3[0],A=Ht.MathTmp.Quaternion[0],R=Ht.MathTmp.Vector3[1];v.decompose(E,A,R);const O=Ht.MathTmp.Vector3[2],M=Ht.MathTmp.Quaternion[1],z=Ht.MathTmp.Vector3[3];C.decompose(O,M,z);const B=Ht.MathTmp.Vector3[4];Ut.Vector3.LerpToRef(E,O,T,B);const V=Ht.MathTmp.Quaternion[2];qt.Quaternion.SlerpToRef(A,M,T,V);const q=Ht.MathTmp.Vector3[5];Ut.Vector3.LerpToRef(R,z,T,q),Dt.ComposeToRef(B,V,q,S)}static LookAtLH(v,C,T){const S=new Dt;return Dt.LookAtLHToRef(v,C,T,S),S}static LookAtLHToRef(v,C,T,S){const E=Ht.MathTmp.Vector3[0],A=Ht.MathTmp.Vector3[1],R=Ht.MathTmp.Vector3[2];C.subtractToRef(v,R),R.normalize(),Ut.Vector3.CrossToRef(T,R,E);const O=E.lengthSquared();0===O?E.x=1:E.normalizeFromLength(Math.sqrt(O)),Ut.Vector3.CrossToRef(R,E,A),A.normalize();const M=-Ut.Vector3.Dot(E,v),z=-Ut.Vector3.Dot(A,v),B=-Ut.Vector3.Dot(R,v);Dt.FromValuesToRef(E.x,A.x,R.x,0,E.y,A.y,R.y,0,E.z,A.z,R.z,0,M,z,B,1,S)}static LookAtRH(v,C,T){const S=new Dt;return Dt.LookAtRHToRef(v,C,T,S),S}static LookAtRHToRef(v,C,T,S){const E=Ht.MathTmp.Vector3[0],A=Ht.MathTmp.Vector3[1],R=Ht.MathTmp.Vector3[2];v.subtractToRef(C,R),R.normalize(),Ut.Vector3.CrossToRef(T,R,E);const O=E.lengthSquared();0===O?E.x=1:E.normalizeFromLength(Math.sqrt(O)),Ut.Vector3.CrossToRef(R,E,A),A.normalize();const M=-Ut.Vector3.Dot(E,v),z=-Ut.Vector3.Dot(A,v),B=-Ut.Vector3.Dot(R,v);Dt.FromValuesToRef(E.x,A.x,R.x,0,E.y,A.y,R.y,0,E.z,A.z,R.z,0,M,z,B,1,S)}static OrthoLH(v,C,T,S){const E=new Dt;return Dt.OrthoLHToRef(v,C,T,S,E),E}static OrthoLHToRef(v,C,T,S,E){const A=2/v,R=2/C,O=2/(S-T),M=-(S+T)/(S-T);Dt.FromValuesToRef(A,0,0,0,0,R,0,0,0,0,O,0,0,0,M,1,E),E._updateIdentityStatus(1===A&&1===R&&1===O&&0===M)}static OrthoOffCenterLH(v,C,T,S,E,A){const R=new Dt;return Dt.OrthoOffCenterLHToRef(v,C,T,S,E,A,R),R}static OrthoOffCenterLHToRef(v,C,T,S,E,A,R){const O=2/(C-v),M=2/(S-T),z=2/(A-E),B=-(A+E)/(A-E),V=(v+C)/(v-C),q=(S+T)/(T-S);Dt.FromValuesToRef(O,0,0,0,0,M,0,0,0,0,z,0,V,q,B,1,R),R._markAsUpdated()}static OrthoOffCenterRH(v,C,T,S,E,A){const R=new Dt;return Dt.OrthoOffCenterRHToRef(v,C,T,S,E,A,R),R}static OrthoOffCenterRHToRef(v,C,T,S,E,A,R){Dt.OrthoOffCenterLHToRef(v,C,T,S,E,A,R),R._m[10]*=-1}static PerspectiveLH(v,C,T,S){const E=new Dt,A=2*T/v,R=2*T/C,O=(S+T)/(S-T),M=-2*S*T/(S-T);return Dt.FromValuesToRef(A,0,0,0,0,R,0,0,0,0,O,1,0,0,M,0,E),E._updateIdentityStatus(!1),E}static PerspectiveFovLH(v,C,T,S){const E=new Dt;return Dt.PerspectiveFovLHToRef(v,C,T,S,E),E}static PerspectiveFovLHToRef(v,C,T,S,E,A=!0){const R=T,O=S,M=1/Math.tan(.5*v),z=A?M/C:M,B=A?M:M*C,V=(O+R)/(O-R),q=-2*O*R/(O-R);Dt.FromValuesToRef(z,0,0,0,0,B,0,0,0,0,V,1,0,0,q,0,E),E._updateIdentityStatus(!1)}static PerspectiveFovRH(v,C,T,S){const E=new Dt;return Dt.PerspectiveFovRHToRef(v,C,T,S,E),E}static PerspectiveFovRHToRef(v,C,T,S,E,A=!0){const R=T,O=S,M=1/Math.tan(.5*v),z=A?M/C:M,B=A?M:M*C,V=-(O+R)/(O-R),q=-2*O*R/(O-R);Dt.FromValuesToRef(z,0,0,0,0,B,0,0,0,0,V,-1,0,0,q,0,E),E._updateIdentityStatus(!1)}static PerspectiveFovWebVRToRef(v,C,T,S,E=!1){const A=E?-1:1,R=Math.tan(v.upDegrees*Math.PI/180),O=Math.tan(v.downDegrees*Math.PI/180),M=Math.tan(v.leftDegrees*Math.PI/180),z=Math.tan(v.rightDegrees*Math.PI/180),B=2/(M+z),V=2/(R+O),q=S._m;q[0]=B,q[1]=q[2]=q[3]=q[4]=0,q[5]=V,q[6]=q[7]=0,q[8]=(M-z)*B*.5,q[9]=-(R-O)*V*.5,q[10]=-T/(C-T),q[11]=1*A,q[12]=q[13]=q[15]=0,q[14]=-2*T*C/(T-C),S._markAsUpdated()}static GetAsMatrix2x2(v){return[v._m[0],v._m[1],v._m[4],v._m[5]]}static GetAsMatrix3x3(v){return[v._m[0],v._m[1],v._m[2],v._m[4],v._m[5],v._m[6],v._m[8],v._m[9],v._m[10]]}static Transpose(v){const C=new Dt;return Dt.TransposeToRef(v,C),C}static TransposeToRef(v,C){const T=C._m,S=v._m;T[0]=S[0],T[1]=S[4],T[2]=S[8],T[3]=S[12],T[4]=S[1],T[5]=S[5],T[6]=S[9],T[7]=S[13],T[8]=S[2],T[9]=S[6],T[10]=S[10],T[11]=S[14],T[12]=S[3],T[13]=S[7],T[14]=S[11],T[15]=S[15],C._updateIdentityStatus(v._isIdentity,v._isIdentityDirty)}static Reflection(v){const C=new Dt;return Dt.ReflectionToRef(v,C),C}static ReflectionToRef(v,C){v.normalize();const T=v.normal.x,S=v.normal.y,E=v.normal.z,A=-2*T,R=-2*S,O=-2*E;Dt.FromValuesToRef(A*T+1,R*T,O*T,0,A*S,R*S+1,O*S,0,A*E,R*E,O*E+1,0,A*v.d,R*v.d,O*v.d,1,C)}static FromXYZAxesToRef(v,C,T,S){Dt.FromValuesToRef(v.x,v.y,v.z,0,C.x,C.y,C.z,0,T.x,T.y,T.z,0,0,0,0,1,S)}static FromQuaternionToRef(v,C){const T=v.x*v.x,S=v.y*v.y,E=v.z*v.z,A=v.x*v.y,R=v.z*v.w,O=v.z*v.x,M=v.y*v.w,z=v.y*v.z,B=v.x*v.w;C._m[0]=1-2*(S+E),C._m[1]=2*(A+R),C._m[2]=2*(O-M),C._m[3]=0,C._m[4]=2*(A-R),C._m[5]=1-2*(E+T),C._m[6]=2*(z+B),C._m[7]=0,C._m[8]=2*(O+M),C._m[9]=2*(z-B),C._m[10]=1-2*(S+T),C._m[11]=0,C._m[12]=0,C._m[13]=0,C._m[14]=0,C._m[15]=1,C._markAsUpdated()}_markAsUpdated(){this.updateFlag=Dt._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const v=this._m;this._isIdentity=1===v[0]&&0===v[1]&&0===v[2]&&0===v[3]&&0===v[4]&&1===v[5]&&0===v[6]&&0===v[7]&&0===v[8]&&0===v[9]&&1===v[10]&&0===v[11]&&0===v[12]&&0===v[13]&&0===v[14]&&1===v[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const v=this._m,C=v[0],T=v[1],S=v[2],E=v[3],A=v[4],R=v[5],O=v[6],M=v[7],z=v[8],B=v[9],V=v[10],q=v[11],j=v[12],H=v[13],W=v[14],X=v[15],Q=V*X-W*q,Z=B*X-H*q,J=B*W-H*V,K=z*X-j*q,$=z*W-V*j,et=z*H-j*B;return C*+(R*Q-O*Z+M*J)+T*-(A*Q-O*K+M*$)+S*+(A*Z-R*K+M*et)+E*-(A*J-R*$+O*et)}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return Dt.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(v){const C=new Dt;return this.addToRef(v,C),C}addToRef(v,C){for(let T=0;T<16;T++)C._m[T]=this._m[T]+v._m[T];return C._markAsUpdated(),this}addToSelf(v){for(let C=0;C<16;C++)this._m[C]+=v._m[C];return this._markAsUpdated(),this}invertToRef(v){if(!0===this._isIdentity)return Dt.IdentityToRef(v),this;const C=this._m,T=C[0],S=C[1],E=C[2],A=C[3],R=C[4],O=C[5],M=C[6],z=C[7],B=C[8],V=C[9],q=C[10],j=C[11],H=C[12],W=C[13],X=C[14],Q=C[15],Z=q*Q-X*j,J=V*Q-W*j,K=V*X-W*q,$=B*Q-H*j,et=B*X-q*H,nt=B*W-H*V,it=+(O*Z-M*J+z*K),ot=-(R*Z-M*$+z*et),rt=+(R*J-O*$+z*nt),st=-(R*K-O*et+M*nt),at=T*it+S*ot+E*rt+A*st;if(0===at)return v.copyFrom(this),this;const ct=1/at,lt=M*Q-X*z,dt=O*Q-W*z,ht=O*X-W*M,ut=R*Q-H*z,pt=R*X-H*M,ft=R*W-H*O,yt=M*j-q*z,gt=O*j-V*z,vt=O*q-V*M,wt=R*j-B*z,Ct=R*q-B*M,bt=R*V-B*O,Tt=-(S*Z-E*J+A*K),St=+(T*Z-E*$+A*et),xt=-(T*J-S*$+A*nt),At=+(T*K-S*et+E*nt),_t=+(S*lt-E*dt+A*ht),Rt=-(T*lt-E*ut+A*pt),Pt=+(T*dt-S*ut+A*ft),It=-(T*ht-S*pt+E*ft),Ot=-(S*yt-E*gt+A*vt),zt=+(T*yt-E*wt+A*Ct),Bt=-(T*gt-S*wt+A*bt),Nt=+(T*vt-S*Ct+E*bt);return Dt.FromValuesToRef(it*ct,Tt*ct,_t*ct,Ot*ct,ot*ct,St*ct,Rt*ct,zt*ct,rt*ct,xt*ct,Pt*ct,Bt*ct,st*ct,At*ct,It*ct,Nt*ct,v),this}addAtIndex(v,C){return this._m[v]+=C,this._markAsUpdated(),this}multiplyAtIndex(v,C){return this._m[v]*=C,this._markAsUpdated(),this}setTranslationFromFloats(v,C,T){return this._m[12]=v,this._m[13]=C,this._m[14]=T,this._markAsUpdated(),this}setTranslation(v){return this.setTranslationFromFloats(v.x,v.y,v.z)}getTranslation(){return new Ut.Vector3(this._m[12],this._m[13],this._m[14])}getTranslationToRef(v){return v.x=this._m[12],v.y=this._m[13],v.z=this._m[14],this}removeRotationAndScaling(){const v=this.m;return Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,v[12],v[13],v[14],v[15],this),this._updateIdentityStatus(0===v[12]&&0===v[13]&&0===v[14]&&1===v[15]),this}multiply(v){const C=new Dt;return this.multiplyToRef(v,C),C}copyFrom(v){v.copyToArray(this._m);const C=v;return this._updateIdentityStatus(C._isIdentity,C._isIdentityDirty,C._isIdentity3x2,C._isIdentity3x2Dirty),this}copyToArray(v,C=0){for(let T=0;T<16;T++)v[C+T]=this._m[T];return this}multiplyToRef(v,C){return this._isIdentity?(C.copyFrom(v),this):v._isIdentity?(C.copyFrom(this),this):(this.multiplyToArray(v,C._m,0),C._markAsUpdated(),this)}multiplyToArray(v,C,T){const S=this._m,E=v.m,A=S[0],R=S[1],O=S[2],M=S[3],z=S[4],B=S[5],V=S[6],q=S[7],j=S[8],H=S[9],W=S[10],X=S[11],Q=S[12],Z=S[13],J=S[14],K=S[15],$=E[0],et=E[1],nt=E[2],it=E[3],ot=E[4],rt=E[5],st=E[6],at=E[7],ct=E[8],lt=E[9],dt=E[10],ht=E[11],ut=E[12],pt=E[13],ft=E[14],yt=E[15];return C[T]=A*$+R*ot+O*ct+M*ut,C[T+1]=A*et+R*rt+O*lt+M*pt,C[T+2]=A*nt+R*st+O*dt+M*ft,C[T+3]=A*it+R*at+O*ht+M*yt,C[T+4]=z*$+B*ot+V*ct+q*ut,C[T+5]=z*et+B*rt+V*lt+q*pt,C[T+6]=z*nt+B*st+V*dt+q*ft,C[T+7]=z*it+B*at+V*ht+q*yt,C[T+8]=j*$+H*ot+W*ct+X*ut,C[T+9]=j*et+H*rt+W*lt+X*pt,C[T+10]=j*nt+H*st+W*dt+X*ft,C[T+11]=j*it+H*at+W*ht+X*yt,C[T+12]=Q*$+Z*ot+J*ct+K*ut,C[T+13]=Q*et+Z*rt+J*lt+K*pt,C[T+14]=Q*nt+Z*st+J*dt+K*ft,C[T+15]=Q*it+Z*at+J*ht+K*yt,this}equals(v){const C=v;if(!C)return!1;if((this._isIdentity||C._isIdentity)&&!this._isIdentityDirty&&!C._isIdentityDirty)return this._isIdentity&&C._isIdentity;const T=this.m,S=C.m;return T[0]===S[0]&&T[1]===S[1]&&T[2]===S[2]&&T[3]===S[3]&&T[4]===S[4]&&T[5]===S[5]&&T[6]===S[6]&&T[7]===S[7]&&T[8]===S[8]&&T[9]===S[9]&&T[10]===S[10]&&T[11]===S[11]&&T[12]===S[12]&&T[13]===S[13]&&T[14]===S[14]&&T[15]===S[15]}clone(){const v=new Dt;return v.copyFrom(this),v}getClassName(){return"Matrix"}getHashCode(){let v=this._m[0]||0;for(let C=1;C<16;C++)v=397*v^(this._m[C]||0);return v}decompose(v,C,T){if(this._isIdentity)return T&&T.setAll(0),v&&v.setAll(1),C&&C.copyFromFloats(0,0,0,1),!0;const S=this._m;T&&T.copyFromFloats(S[12],S[13],S[14]);const E=v||Ht.MathTmp.Vector3[0];if(E.x=Math.sqrt(S[0]*S[0]+S[1]*S[1]+S[2]*S[2]),E.y=Math.sqrt(S[4]*S[4]+S[5]*S[5]+S[6]*S[6]),E.z=Math.sqrt(S[8]*S[8]+S[9]*S[9]+S[10]*S[10]),this.determinant()<=0&&(E.y*=-1),0===E.x||0===E.y||0===E.z)return C&&C.copyFromFloats(0,0,0,1),!1;if(C){const v=1/E.x,T=1/E.y,A=1/E.z;Dt.FromValuesToRef(S[0]*v,S[1]*v,S[2]*v,0,S[4]*T,S[5]*T,S[6]*T,0,S[8]*A,S[9]*A,S[10]*A,0,0,0,0,1,Ht.MathTmp.Matrix[0]),qt.Quaternion.FromRotationMatrixToRef(Ht.MathTmp.Matrix[0],C)}return!0}getRow(v){if(v<0||v>3)return null;const C=4*v;return new Gt.Vector4(this._m[C+0],this._m[C+1],this._m[C+2],this._m[C+3])}setRow(v,C){return this.setRowFromFloats(v,C.x,C.y,C.z,C.w)}transpose(){return Dt.Transpose(this)}transposeToRef(v){return Dt.TransposeToRef(this,v),this}setRowFromFloats(v,C,T,S,E){if(v<0||v>3)return this;const A=4*v;return this._m[A+0]=C,this._m[A+1]=T,this._m[A+2]=S,this._m[A+3]=E,this._markAsUpdated(),this}scale(v){const C=new Dt;return this.scaleToRef(v,C),C}scaleToRef(v,C){for(let T=0;T<16;T++)C._m[T]=this._m[T]*v;return C._markAsUpdated(),this}scaleAndAddToRef(v,C){for(let T=0;T<16;T++)C._m[T]+=this._m[T]*v;return C._markAsUpdated(),this}toNormalMatrix(v){const C=Ht.MathTmp.Matrix[0];this.invertToRef(C),C.transposeToRef(v);const T=v._m;Dt.FromValuesToRef(T[0],T[1],T[2],0,T[4],T[5],T[6],0,T[8],T[9],T[10],0,0,0,0,1,v)}getRotationMatrix(){const v=new Dt;return this.getRotationMatrixToRef(v),v}getRotationMatrixToRef(v){const C=Ht.MathTmp.Vector3[0];if(!this.decompose(C))return Dt.IdentityToRef(v),this;const T=this._m,S=1/C.x,E=1/C.y,A=1/C.z;return Dt.FromValuesToRef(T[0]*S,T[1]*S,T[2]*S,0,T[4]*E,T[5]*E,T[6]*E,0,T[8]*A,T[9]*A,T[10]*A,0,0,0,0,1,v),this}toggleModelMatrixHandInPlace(){const v=this._m;v[2]*=-1,v[6]*=-1,v[8]*=-1,v[9]*=-1,v[14]*=-1,this._markAsUpdated()}toggleProjectionMatrixHandInPlace(){const v=this._m;v[8]*=-1,v[9]*=-1,v[10]*=-1,v[11]*=-1,this._markAsUpdated()}_updateIdentityStatus(v,C=!1,T=!1,S=!0){this.updateFlag=Dt._updateFlagSeed++,this._isIdentity=v,this._isIdentity3x2=v||T,this._isIdentityDirty=!this._isIdentity&&C,this._isIdentity3x2Dirty=!this._isIdentity3x2&&S}}Bt.Matrix=Dt,Dt._updateFlagSeed=0,Dt._identityReadOnly=Dt.Identity(),Object.defineProperty(zt,"__esModule",{value:!0}),zt.Quaternion=void 0;const Wt=Bt,Qt=Ot,Yt=Pt,Zt=Rt,Jt=Lt;class jt{constructor(v=0,C=0,T=0,S=1){this.x=v,this.y=C,this.z=T,this.w=S}static FromRotationMatrix(v){const C=new jt;return jt.FromRotationMatrixToRef(v,C),C}static FromRotationMatrixToRef(v,C){const T=v.m,S=T[0],E=T[4],A=T[8],R=T[1],O=T[5],M=T[9],z=T[2],B=T[6],V=T[10],q=S+O+V;let j;q>0?(j=.5/Math.sqrt(q+1),C.w=.25/j,C.x=(B-M)*j,C.y=(A-z)*j,C.z=(R-E)*j):S>O&&S>V?(j=2*Math.sqrt(1+S-O-V),C.w=(B-M)/j,C.x=.25*j,C.y=(E+R)/j,C.z=(A+z)/j):O>V?(j=2*Math.sqrt(1+O-S-V),C.w=(A-z)/j,C.x=(E+R)/j,C.y=.25*j,C.z=(M+B)/j):(j=2*Math.sqrt(1+V-S-O),C.w=(R-E)/j,C.x=(A+z)/j,C.y=(M+B)/j,C.z=.25*j)}static Dot(v,C){return v.x*C.x+v.y*C.y+v.z*C.z+v.w*C.w}static AreClose(v,C){return jt.Dot(v,C)>=0}static Zero(){return new jt(0,0,0,0)}static Inverse(v){return new jt(-v.x,-v.y,-v.z,v.w)}static IsIdentity(v){return v&&0===v.x&&0===v.y&&0===v.z&&1===v.w}static RotationAxis(v,C){const T=C*Zt.DEG2RAD;return jt.RotationAxisToRef(v,T,new jt)}static RotationAxisToRef(v,C,T){const S=C*Zt.DEG2RAD,E=Math.sin(S/2);return v.normalize(),T.w=Math.cos(S/2),T.x=v.x*E,T.y=v.y*E,T.z=v.z*E,T}static FromArray(v,C=0){return new jt(v[C],v[C+1],v[C+2],v[C+3])}static FromEulerAnglesRef(v,C,T,S){return jt.RotationYawPitchRollToRef(C*Zt.DEG2RAD,v*Zt.DEG2RAD,T*Zt.DEG2RAD,S)}static RotationYawPitchRoll(v,C,T){const S=new jt;return jt.RotationYawPitchRollToRef(v,C,T,S),S}static RotationYawPitchRollToRef(v,C,T,S){const E=.5*C,A=.5*v,R=.5*T,O=Math.cos(E),M=Math.cos(A),z=Math.cos(R),B=Math.sin(E),V=Math.sin(A),q=Math.sin(R);S.x=M*B*z+V*O*q,S.y=V*O*z-M*B*q,S.z=M*O*q-V*B*z,S.w=M*O*z+V*B*q}static RotationAlphaBetaGamma(v,C,T){const S=new jt;return jt.RotationAlphaBetaGammaToRef(v,C,T,S),S}static RotationAlphaBetaGammaToRef(v,C,T,S){const E=.5*(T+v),A=.5*(T-v),R=.5*C;S.x=Math.cos(A)*Math.sin(R),S.y=Math.sin(A)*Math.sin(R),S.z=Math.sin(E)*Math.cos(R),S.w=Math.cos(E)*Math.cos(R)}static RotationQuaternionFromAxis(v,C,T){const S=new jt(0,0,0,0);return jt.RotationQuaternionFromAxisToRef(v,C,T,S),S}static RotationQuaternionFromAxisToRef(v,C,T,S){const E=Yt.MathTmp.Matrix[0];Wt.Matrix.FromXYZAxesToRef(v.normalize(),C.normalize(),T.normalize(),E),jt.FromRotationMatrixToRef(E,S)}static Slerp(v,C,T){const S=jt.Identity;return jt.SlerpToRef(v,C,T,S),S}static SlerpToRef(v,C,T,S){let E,A,R=v.x*C.x+v.y*C.y+v.z*C.z+v.w*C.w,O=!1;if(R<0&&(O=!0,R=-R),R>.999999)A=1-T,E=O?-T:T;else{const v=Math.acos(R),C=1/Math.sin(v);A=Math.sin((1-T)*v)*C,E=O?-Math.sin(T*v)*C:Math.sin(T*v)*C}S.x=A*v.x+E*C.x,S.y=A*v.y+E*C.y,S.z=A*v.z+E*C.z,S.w=A*v.w+E*C.w}static Hermite(v,C,T,S,E){const A=E*E,R=E*A,O=2*R-3*A+1,M=-2*R+3*A,z=R-2*A+E,B=R-A,V=v.x*O+T.x*M+C.x*z+S.x*B,q=v.y*O+T.y*M+C.y*z+S.y*B,j=v.z*O+T.z*M+C.z*z+S.z*B,H=v.w*O+T.w*M+C.w*z+S.w*B;return new jt(V,q,j,H)}static get Identity(){return new jt(0,0,0,1)}static Angle(v,C){const T=jt.Dot(v,C);return 2*Math.acos(Math.min(Math.abs(T),1))*Zt.RAD2DEG}static Euler(v,C,T){return jt.RotationYawPitchRoll(C*Zt.DEG2RAD,v*Zt.DEG2RAD,T*Zt.DEG2RAD)}static LookRotation(v,C=Yt.MathTmp.staticUp){const T=Qt.Vector3.Normalize(v),S=Qt.Vector3.Normalize(Qt.Vector3.Cross(C,T)),E=Qt.Vector3.Cross(T,S),A=S.x,R=S.y,O=S.z,M=E.x,z=E.y,B=E.z,V=T.x,q=T.y,j=T.z,H=A+z+j,W=new jt;if(H>0){let v=Math.sqrt(H+1);return W.w=.5*v,v=.5/v,W.x=(B-q)*v,W.y=(V-O)*v,W.z=(R-M)*v,W}if(A>=z&&A>=j){const v=Math.sqrt(1+A-z-j),C=.5/v;return W.x=.5*v,W.y=(R+M)*C,W.z=(O+V)*C,W.w=(B-q)*C,W}if(z>j){const v=Math.sqrt(1+z-A-j),C=.5/v;return W.x=(M+R)*C,W.y=.5*v,W.z=(q+B)*C,W.w=(V-O)*C,W}const X=Math.sqrt(1+j-A-z),Q=.5/X;return W.x=(V+O)*Q,W.y=(q+B)*Q,W.z=.5*X,W.w=(R-M)*Q,W}static RotateTowards(v,C,T){const S=jt.Angle(v,C);if(0===S)return C;const E=Math.min(1,T/S);return jt.Slerp(v,C,E)}static FromToRotation(v,C,T=Yt.MathTmp.staticUp){const S=v.normalize(),E=C.normalize(),A=Qt.Vector3.Cross(S,E),R=Math.sqrt(S.lengthSquared()*E.lengthSquared())+Qt.Vector3.Dot(S,E);return A.lengthSquared()<1e-4?Math.abs(R)<1e-4?new jt(T.x,T.y,T.z,0).normalized:jt.Identity:new jt(A.x,A.y,A.z,R).normalized}get normalized(){return this.normalize()}setFromToRotation(v,C,T=Yt.MathTmp.staticUp){const S=jt.FromToRotation(v,C,T);this.x=S.x,this.y=S.y,this.z=S.z,this.w=S.w}set eulerAngles(v){this.setEuler(v.x,v.y,v.z)}get eulerAngles(){const v=new Qt.Vector3,C=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,T=this.x*this.w-this.y*this.z;return T>.4995*C?(v.x=Math.PI/2,v.y=2*Math.atan2(this.y,this.x),v.z=0):T<-.4995*C?(v.x=-Math.PI/2,v.y=-2*Math.atan2(this.y,this.x),v.z=0):(v.x=Math.asin(2*(this.w*this.x-this.y*this.z)),v.y=Math.atan2(2*this.w*this.y+2*this.z*this.x,1-2*(this.x*this.x+this.y*this.y)),v.z=Math.atan2(2*this.w*this.z+2*this.x*this.y,1-2*(this.z*this.z+this.x*this.x))),v.x*=Zt.RAD2DEG,v.y*=Zt.RAD2DEG,v.z*=Zt.RAD2DEG,v.x=Jt.Scalar.Repeat(v.x,360),v.y=Jt.Scalar.Repeat(v.y,360),v.z=Jt.Scalar.Repeat(v.z,360),v}toString(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}getClassName(){return"Quaternion"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v=397*v^(this.w||0),v}asArray(){return[this.x,this.y,this.z,this.w]}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z&&this.w===v.w}clone(){return new jt(this.x,this.y,this.z,this.w)}copyFrom(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=v.w,this}copyFromFloats(v,C,T,S){return this.x=v,this.y=C,this.z=T,this.w=S,this}set(v,C,T,S){return this.copyFromFloats(v,C,T,S)}setEuler(v,C,T){return jt.RotationYawPitchRollToRef(C*Zt.DEG2RAD,v*Zt.DEG2RAD,T*Zt.DEG2RAD,this),this}add(v){return new jt(this.x+v.x,this.y+v.y,this.z+v.z,this.w+v.w)}addInPlace(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this.w+=v.w,this}subtract(v){return new jt(this.x-v.x,this.y-v.y,this.z-v.z,this.w-v.w)}scale(v){return new jt(this.x*v,this.y*v,this.z*v,this.w*v)}scaleToRef(v,C){return C.x=this.x*v,C.y=this.y*v,C.z=this.z*v,C.w=this.w*v,this}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}scaleAndAddToRef(v,C){return C.x+=this.x*v,C.y+=this.y*v,C.z+=this.z*v,C.w+=this.w*v,this}multiply(v){const C=new jt(0,0,0,1);return this.multiplyToRef(v,C),C}multiplyToRef(v,C){const T=this.x*v.w+this.y*v.z-this.z*v.y+this.w*v.x,S=-this.x*v.z+this.y*v.w+this.z*v.x+this.w*v.y,E=this.x*v.y-this.y*v.x+this.z*v.w+this.w*v.z,A=-this.x*v.x-this.y*v.y-this.z*v.z+this.w*v.w;return C.copyFromFloats(T,S,E,A),this}multiplyInPlace(v){return this.multiplyToRef(v,this),this}conjugateToRef(v){return v.copyFromFloats(-this.x,-this.y,-this.z,this.w),this}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new jt(-this.x,-this.y,-this.z,this.w)}normalize(){const v=1/this.length;return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}angleAxis(v,C){if(0===C.lengthSquared())return jt.Identity;const T=jt.Identity;let S=v*Zt.DEG2RAD;S*=.5;let E=C.normalize();return E=C.scaleInPlace(Math.sin(S)),T.x=E.x,T.y=E.y,T.z=E.z,T.w=Math.cos(S),T.normalize()}toRotationMatrix(v){return Wt.Matrix.FromQuaternionToRef(this,v),this}fromRotationMatrix(v){return jt.FromRotationMatrixToRef(v,this),this}}zt.Quaternion=jt,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Vector3=void 0;const Kt=Pt,$t=Rt,ee=zt,ne=Lt;class Xt{constructor(v=0,C=0,T=0){this.x=v,this.y=C,this.z=T}get isNonUniform(){const v=Math.abs(this.x),C=Math.abs(this.y);if(v!==C)return!0;const T=Math.abs(this.z);return v!==T||C!==T}static Add(v,C){return new Xt(v.x,v.y,v.z).addInPlace(C)}static GetClipFactor(v,C,T,S){const E=Xt.Dot(v,T)-S;return E/(E-(Xt.Dot(C,T)-S))}static GetAngleBetweenVectors(v,C,T){const S=v.normalizeToRef(Kt.MathTmp.Vector3[1]),E=C.normalizeToRef(Kt.MathTmp.Vector3[2]),A=Xt.Dot(S,E),R=Kt.MathTmp.Vector3[3];return Xt.CrossToRef(S,E,R),Xt.Dot(R,T)>0?Math.acos(A):-Math.acos(A)}static FromArray(v,C=0){return new Xt(v[C],v[C+1],v[C+2])}static FromFloatArray(v,C){return Xt.FromArray(v,C)}static FromArrayToRef(v,C,T){T.x=v[C],T.y=v[C+1],T.z=v[C+2]}static FromFloatArrayToRef(v,C,T){return Xt.FromArrayToRef(v,C,T)}static FromFloatsToRef(v,C,T,S){S.copyFromFloats(v,C,T)}static Zero(){return new Xt(0,0,0)}static One(){return new Xt(1,1,1)}static Up(){return new Xt(0,1,0)}static Down(){return new Xt(0,-1,0)}static Forward(){return new Xt(0,0,1)}static Backward(){return new Xt(0,0,-1)}static Right(){return new Xt(1,0,0)}static Left(){return new Xt(-1,0,0)}static TransformCoordinates(v,C){const T=Xt.Zero();return Xt.TransformCoordinatesToRef(v,C,T),T}static TransformCoordinatesToRef(v,C,T){return Xt.TransformCoordinatesFromFloatsToRef(v.x,v.y,v.z,C,T)}static TransformCoordinatesFromFloatsToRef(v,C,T,S,E){const A=S.m,R=v*A[0]+C*A[4]+T*A[8]+A[12],O=v*A[1]+C*A[5]+T*A[9]+A[13],M=v*A[2]+C*A[6]+T*A[10]+A[14],z=1/(v*A[3]+C*A[7]+T*A[11]+A[15]);E.x=R*z,E.y=O*z,E.z=M*z}static TransformNormal(v,C){const T=Xt.Zero();return Xt.TransformNormalToRef(v,C,T),T}static TransformNormalToRef(v,C,T){this.TransformNormalFromFloatsToRef(v.x,v.y,v.z,C,T)}static TransformNormalFromFloatsToRef(v,C,T,S,E){const A=S.m;E.x=v*A[0]+C*A[4]+T*A[8],E.y=v*A[1]+C*A[5]+T*A[9],E.z=v*A[2]+C*A[6]+T*A[10]}static CatmullRom(v,C,T,S,E){const A=E*E,R=E*A,O=.5*(2*C.x+(-v.x+T.x)*E+(2*v.x-5*C.x+4*T.x-S.x)*A+(-v.x+3*C.x-3*T.x+S.x)*R),M=.5*(2*C.y+(-v.y+T.y)*E+(2*v.y-5*C.y+4*T.y-S.y)*A+(-v.y+3*C.y-3*T.y+S.y)*R),z=.5*(2*C.z+(-v.z+T.z)*E+(2*v.z-5*C.z+4*T.z-S.z)*A+(-v.z+3*C.z-3*T.z+S.z)*R);return new Xt(O,M,z)}static Clamp(v,C,T){const S=new Xt;return Xt.ClampToRef(v,C,T,S),S}static ClampToRef(v,C,T,S){let E=v.x;E=E>T.x?T.x:E,E=E<C.x?C.x:E;let A=v.y;A=A>T.y?T.y:A,A=A<C.y?C.y:A;let R=v.z;R=R>T.z?T.z:R,R=R<C.z?C.z:R,S.copyFromFloats(E,A,R)}static Hermite(v,C,T,S,E){const A=E*E,R=E*A,O=2*R-3*A+1,M=-2*R+3*A,z=R-2*A+E,B=R-A,V=v.x*O+T.x*M+C.x*z+S.x*B,q=v.y*O+T.y*M+C.y*z+S.y*B,j=v.z*O+T.z*M+C.z*z+S.z*B;return new Xt(V,q,j)}static Lerp(v,C,T){const S=new Xt(0,0,0);return Xt.LerpToRef(v,C,T,S),S}static LerpToRef(v,C,T,S){S.x=v.x+(C.x-v.x)*T,S.y=v.y+(C.y-v.y)*T,S.z=v.z+(C.z-v.z)*T}static Dot(v,C){return v.x*C.x+v.y*C.y+v.z*C.z}static Cross(v,C){const T=Xt.Zero();return Xt.CrossToRef(v,C,T),T}static CrossToRef(v,C,T){const S=v.y*C.z-v.z*C.y,E=v.z*C.x-v.x*C.z,A=v.x*C.y-v.y*C.x;T.copyFromFloats(S,E,A)}static Normalize(v){const C=Xt.Zero();return Xt.NormalizeToRef(v,C),C}static NormalizeToRef(v,C){v.normalizeToRef(C)}static Minimize(v,C){const T=new Xt(v.x,v.y,v.z);return T.minimizeInPlace(C),T}static Maximize(v,C){const T=new Xt(v.x,v.y,v.z);return T.maximizeInPlace(C),T}static Distance(v,C){return Math.sqrt(Xt.DistanceSquared(v,C))}static DistanceSquared(v,C){const T=v.x-C.x,S=v.y-C.y,E=v.z-C.z;return T*T+S*S+E*E}static Center(v,C){const T=Xt.Add(v,C);return T.scaleInPlace(.5),T}static RotationFromAxis(v,C,T){const S=Xt.Zero();return Xt.RotationFromAxisToRef(v,C,T,S),S}static RotationFromAxisToRef(v,C,T,S){const E=Kt.MathTmp.Quaternion[0];ee.Quaternion.RotationQuaternionFromAxisToRef(v,C,T,E),S.copyFrom(E.eulerAngles)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}getClassName(){return"Vector3"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v}asArray(){const v=[];return this.toArray(v,0),v}toArray(v,C=0){return v[C]=this.x,v[C+1]=this.y,v[C+2]=this.z,this}toQuaternion(){return ee.Quaternion.Identity.setEuler(this.y,this.x,this.z)}addInPlace(v){return this.addInPlaceFromFloats(v.x,v.y,v.z)}addInPlaceFromFloats(v,C,T){return this.x+=v,this.y+=C,this.z+=T,this}add(v){return new Xt(this.x+v.x,this.y+v.y,this.z+v.z)}addToRef(v,C){return C.copyFromFloats(this.x+v.x,this.y+v.y,this.z+v.z)}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this}subtract(v){return new Xt(this.x-v.x,this.y-v.y,this.z-v.z)}subtractToRef(v,C){return this.subtractFromFloatsToRef(v.x,v.y,v.z,C)}subtractFromFloats(v,C,T){return new Xt(this.x-v,this.y-C,this.z-T)}subtractFromFloatsToRef(v,C,T,S){return S.copyFromFloats(this.x-v,this.y-C,this.z-T)}applyMatrix4(v){this.applyMatrix4ToRef(v,this)}applyMatrix4ToRef(v,C){const{x:T,y:S,z:E}=this,{m:A}=v,R=1/(A[3]*T+A[7]*S+A[11]*E+A[15]);return C.x=(A[0]*T+A[4]*S+A[8]*E+A[12])*R,C.y=(A[1]*T+A[5]*S+A[9]*E+A[13])*R,C.z=(A[2]*T+A[6]*S+A[10]*E+A[14])*R,C}rotate(v){return this.rotateToRef(v,this)}rotateToRef(v,C){const{x:T,y:S,z:E}=this,{x:A,y:R,z:O,w:M}=v,z=M*T+R*E-O*S,B=M*S+O*T-A*E,V=M*E+A*S-R*T,q=-A*T-R*S-O*E;return C.x=z*M+q*-A+B*-O-V*-R,C.y=B*M+q*-R+V*-A-z*-O,C.z=V*M+q*-O+z*-R-B*-A,C}negate(){return new Xt(-this.x,-this.y,-this.z)}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this}scale(v){return new Xt(this.x*v,this.y*v,this.z*v)}scaleToRef(v,C){return C.copyFromFloats(this.x*v,this.y*v,this.z*v)}scaleAndAddToRef(v,C){return C.addInPlaceFromFloats(this.x*v,this.y*v,this.z*v)}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z}equalsWithEpsilon(v,C=$t.Epsilon){return v&&ne.Scalar.WithinEpsilon(this.x,v.x,C)&&ne.Scalar.WithinEpsilon(this.y,v.y,C)&&ne.Scalar.WithinEpsilon(this.z,v.z,C)}equalsToFloats(v,C,T){return this.x===v&&this.y===C&&this.z===T}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z,this}multiply(v){return this.multiplyByFloats(v.x,v.y,v.z)}multiplyToRef(v,C){return C.copyFromFloats(this.x*v.x,this.y*v.y,this.z*v.z)}multiplyByFloats(v,C,T){return new Xt(this.x*v,this.y*C,this.z*T)}divide(v){return new Xt(this.x/v.x,this.y/v.y,this.z/v.z)}divideToRef(v,C){return C.copyFromFloats(this.x/v.x,this.y/v.y,this.z/v.z)}divideInPlace(v){return this.divideToRef(v,this)}minimizeInPlace(v){return this.minimizeInPlaceFromFloats(v.x,v.y,v.z)}maximizeInPlace(v){return this.maximizeInPlaceFromFloats(v.x,v.y,v.z)}minimizeInPlaceFromFloats(v,C,T){return v<this.x&&(this.x=v),C<this.y&&(this.y=C),T<this.z&&(this.z=T),this}maximizeInPlaceFromFloats(v,C,T){return v>this.x&&(this.x=v),C>this.y&&(this.y=C),T>this.z&&(this.z=T),this}floor(){return new Xt(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fract(){return new Xt(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(v){return 0===v||1===v?this:this.scaleInPlace(1/v)}normalizeToNew(){const v=new Xt(0,0,0);return this.normalizeToRef(v),v}normalizeToRef(v){const C=this.length();return 0===C||1===C?v.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/C,v)}clone(){return new Xt(this.x,this.y,this.z)}copyFrom(v){return this.copyFromFloats(v.x,v.y,v.z)}copyFromFloats(v,C,T){return this.x=v,this.y=C,this.z=T,this}set(v,C,T){return this.copyFromFloats(v,C,T)}setAll(v){return this.x=this.y=this.z=v,this}}Ot.Vector3=Xt,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.MathTmp=void 0;const ie=It,oe=Ot,se=zt,ae=Bt;Pt.MathTmp={Vector3:(0,ie.buildArray)(6,oe.Vector3.Zero),Matrix:(0,ie.buildArray)(2,ae.Matrix.Identity),Quaternion:(0,ie.buildArray)(3,se.Quaternion.Zero),staticUp:oe.Vector3.Up(),tmpMatrix:ae.Matrix.Zero()};var ce={};Object.defineProperty(ce,"__esModule",{value:!0}),ce.Angle=void 0;class te{constructor(v){this._radians=v,this._radians<0&&(this._radians+=2*Math.PI)}static BetweenTwoPoints(v,C){const T=C.subtract(v),S=Math.atan2(T.y,T.x);return new te(S)}static FromRadians(v){return new te(v)}static FromDegrees(v){return new te(v*Math.PI/180)}degrees(){return 180*this._radians/Math.PI}radians(){return this._radians}}ce.Angle=te;var le={},de={};Object.defineProperty(de,"__esModule",{value:!0}),de.Vector2=void 0;const he=Rt,ue=Lt;class re{constructor(v=0,C=0){this.x=v,this.y=C}static Zero(){return new re(0,0)}static One(){return new re(1,1)}static Add(v,C){return new re(v.x,v.y).addInPlace(C)}static FromArray(v,C=0){return new re(v[C],v[C+1])}static FromArrayToRef(v,C,T){T.x=v[C],T.y=v[C+1]}static CatmullRom(v,C,T,S,E){const A=E*E,R=E*A,O=.5*(2*C.x+(-v.x+T.x)*E+(2*v.x-5*C.x+4*T.x-S.x)*A+(-v.x+3*C.x-3*T.x+S.x)*R),M=.5*(2*C.y+(-v.y+T.y)*E+(2*v.y-5*C.y+4*T.y-S.y)*A+(-v.y+3*C.y-3*T.y+S.y)*R);return new re(O,M)}static Clamp(v,C,T){let S=v.x;S=S>T.x?T.x:S,S=S<C.x?C.x:S;let E=v.y;return E=E>T.y?T.y:E,E=E<C.y?C.y:E,new re(S,E)}static Hermite(v,C,T,S,E){const A=E*E,R=E*A,O=2*R-3*A+1,M=-2*R+3*A,z=R-2*A+E,B=R-A,V=v.x*O+T.x*M+C.x*z+S.x*B,q=v.y*O+T.y*M+C.y*z+S.y*B;return new re(V,q)}static Lerp(v,C,T){const S=v.x+(C.x-v.x)*T,E=v.y+(C.y-v.y)*T;return new re(S,E)}static Dot(v,C){return v.x*C.x+v.y*C.y}static Normalize(v){const C=new re(v.x,v.y);return C.normalize(),C}static Minimize(v,C){const T=v.x<C.x?v.x:C.x,S=v.y<C.y?v.y:C.y;return new re(T,S)}static Maximize(v,C){const T=v.x>C.x?v.x:C.x,S=v.y>C.y?v.y:C.y;return new re(T,S)}static Transform(v,C){const T=re.Zero();return re.TransformToRef(v,C,T),T}static TransformToRef(v,C,T){const S=C.m,E=v.x*S[0]+v.y*S[4]+S[12],A=v.x*S[1]+v.y*S[5]+S[13];T.x=E,T.y=A}static PointInTriangle(v,C,T,S){const E=.5*(-T.y*S.x+C.y*(-T.x+S.x)+C.x*(T.y-S.y)+T.x*S.y),A=E<0?-1:1,R=(C.y*S.x-C.x*S.y+(S.y-C.y)*v.x+(C.x-S.x)*v.y)*A,O=(C.x*T.y-C.y*T.x+(C.y-T.y)*v.x+(T.x-C.x)*v.y)*A;return R>0&&O>0&&R+O<2*E*A}static Distance(v,C){return Math.sqrt(re.DistanceSquared(v,C))}static DistanceSquared(v,C){const T=v.x-C.x,S=v.y-C.y;return T*T+S*S}static Center(v,C){const T=re.Add(v,C);return T.scaleInPlace(.5),T}static DistanceOfPointFromSegment(v,C,T){const S=re.DistanceSquared(C,T);if(0===S)return re.Distance(v,C);const E=T.subtract(C),A=Math.max(0,Math.min(1,re.Dot(v.subtract(C),E)/S)),R=C.add(E.multiplyByFloats(A,A));return re.Distance(v,R)}toString(){return"{X: "+this.x+" Y:"+this.y+"}"}getClassName(){return"Vector2"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v}toArray(v,C=0){return v[C]=this.x,v[C+1]=this.y,this}asArray(){const v=new Array;return this.toArray(v,0),v}copyFrom(v){return this.x=v.x,this.y=v.y,this}copyFromFloats(v,C){return this.x=v,this.y=C,this}set(v,C){return this.copyFromFloats(v,C)}add(v){return new re(this.x+v.x,this.y+v.y)}addToRef(v,C){return C.x=this.x+v.x,C.y=this.y+v.y,this}addInPlace(v){return this.x+=v.x,this.y+=v.y,this}addVector3(v){return new re(this.x+v.x,this.y+v.y)}subtract(v){return new re(this.x-v.x,this.y-v.y)}subtractToRef(v,C){return C.x=this.x-v.x,C.y=this.y-v.y,this}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this}multiply(v){return new re(this.x*v.x,this.y*v.y)}multiplyToRef(v,C){return C.x=this.x*v.x,C.y=this.y*v.y,this}multiplyByFloats(v,C){return new re(this.x*v,this.y*C)}divide(v){return new re(this.x/v.x,this.y/v.y)}divideToRef(v,C){return C.x=this.x/v.x,C.y=this.y/v.y,this}divideInPlace(v){return this.divideToRef(v,this)}negate(){return new re(-this.x,-this.y)}scaleInPlace(v){return this.x*=v,this.y*=v,this}scale(v){const C=new re(0,0);return this.scaleToRef(v,C),C}scaleToRef(v,C){return C.x=this.x*v,C.y=this.y*v,this}scaleAndAddToRef(v,C){return C.x+=this.x*v,C.y+=this.y*v,this}equals(v){return v&&this.x===v.x&&this.y===v.y}equalsWithEpsilon(v,C=he.Epsilon){return v&&ue.Scalar.WithinEpsilon(this.x,v.x,C)&&ue.Scalar.WithinEpsilon(this.y,v.y,C)}floor(){return new re(Math.floor(this.x),Math.floor(this.y))}fract(){return new re(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){const v=this.length();if(0===v)return this;const C=1/v;return this.x*=C,this.y*=C,this}clone(){return new re(this.x,this.y)}}de.Vector2=re,Object.defineProperty(le,"__esModule",{value:!0}),le.Arc2=void 0;const me=ce,fe=de,ye=Rt;le.Arc2=class{constructor(v,C,T){this.startPoint=v,this.midPoint=C,this.endPoint=T;const S=Math.pow(C.x,2)+Math.pow(C.y,2),E=(Math.pow(v.x,2)+Math.pow(v.y,2)-S)/2,A=(S-Math.pow(T.x,2)-Math.pow(T.y,2))/2,R=(v.x-C.x)*(C.y-T.y)-(C.x-T.x)*(v.y-C.y);this.centerPoint=new fe.Vector2((E*(C.y-T.y)-A*(v.y-C.y))/R,((v.x-C.x)*A-(C.x-T.x)*E)/R),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=me.Angle.BetweenTwoPoints(this.centerPoint,this.startPoint);const O=this.startAngle.degrees();let M=me.Angle.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),z=me.Angle.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();M-O>180&&(M-=360),M-O<-180&&(M+=360),z-M>180&&(z-=360),z-M<-180&&(z+=360),this.orientation=M-O<0?ye.Orientation.CW:ye.Orientation.CCW,this.angle=me.Angle.FromDegrees(this.orientation===ye.Orientation.CW?O-z:z-O)}};var ve={};Object.defineProperty(ve,"__esModule",{value:!0}),ve.Axis=void 0;const we=Ot;class pe{}ve.Axis=pe,pe.X=new we.Vector3(1,0,0),pe.Y=new we.Vector3(0,1,0),pe.Z=new we.Vector3(0,0,1);var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.BezierCurve=void 0,Ce.BezierCurve=class{static Interpolate(v,C,T,S,E){const A=1-3*S+3*C,R=3*S-6*C,O=3*C;let M=v;for(let C=0;C<5;C++){const C=M*M;M-=1/(3*A*C+2*R*M+O)*(A*(C*M)+R*C+O*M-v),M=Math.min(1,Math.max(0,M))}return 3*Math.pow(1-M,2)*M*T+3*(1-M)*Math.pow(M,2)*E+Math.pow(M,3)}};var be={},Te={};Object.defineProperty(Te,"__esModule",{value:!0}),Te.Color4=void 0;const Se=Lt,Ee=Rt;class ge{constructor(v=0,C=0,T=0,S=1){this.r=v,this.g=C,this.b=T,this.a=S}static FromHexString(v){if("#"!==v.substring(0,1)||9!==v.length)return new ge(0,0,0,0);const C=parseInt(v.substring(1,3),16),T=parseInt(v.substring(3,5),16),S=parseInt(v.substring(5,7),16),E=parseInt(v.substring(7,9),16);return ge.FromInts(C,T,S,E)}static Lerp(v,C,T){const S=new ge(0,0,0,0);return ge.LerpToRef(v,C,T,S),S}static LerpToRef(v,C,T,S){S.r=v.r+(C.r-v.r)*T,S.g=v.g+(C.g-v.g)*T,S.b=v.b+(C.b-v.b)*T,S.a=v.a+(C.a-v.a)*T}static Red(){return new ge(1,0,0,1)}static Green(){return new ge(0,1,0,1)}static Blue(){return new ge(0,0,1,1)}static Black(){return new ge(0,0,0,1)}static White(){return new ge(1,1,1,1)}static Purple(){return new ge(.5,0,.5,1)}static Magenta(){return new ge(1,0,1,1)}static Yellow(){return new ge(1,1,0,1)}static Gray(){return new ge(.5,.5,.5,1)}static Teal(){return new ge(0,1,1,1)}static Clear(){return new ge(0,0,0,0)}static FromColor3(v,C=1){return new ge(v.r,v.g,v.b,C)}static FromArray(v,C=0){return new ge(v[C],v[C+1],v[C+2],v[C+3])}static FromInts(v,C,T,S){return new ge(v/255,C/255,T/255,S/255)}static CheckColors4(v,C){if(v.length===3*C){const C=[];for(let T=0;T<v.length;T+=3){const S=T/3*4;C[S]=v[T],C[S+1]=v[T+1],C[S+2]=v[T+2],C[S+3]=1}return C}return v}addInPlace(v){return this.r+=v.r,this.g+=v.g,this.b+=v.b,this.a+=v.a,this}asArray(){const v=new Array;return this.toArray(v,0),v}toArray(v,C=0){return v[C]=this.r,v[C+1]=this.g,v[C+2]=this.b,v[C+3]=this.a,this}add(v){return new ge(this.r+v.r,this.g+v.g,this.b+v.b,this.a+v.a)}subtract(v){return new ge(this.r-v.r,this.g-v.g,this.b-v.b,this.a-v.a)}subtractToRef(v,C){return C.r=this.r-v.r,C.g=this.g-v.g,C.b=this.b-v.b,C.a=this.a-v.a,this}scale(v){return new ge(this.r*v,this.g*v,this.b*v,this.a*v)}scaleToRef(v,C){return C.r=this.r*v,C.g=this.g*v,C.b=this.b*v,C.a=this.a*v,this}scaleAndAddToRef(v,C){return C.r+=this.r*v,C.g+=this.g*v,C.b+=this.b*v,C.a+=this.a*v,this}clampToRef(v=0,C=1,T){return T.r=Se.Scalar.Clamp(this.r,v,C),T.g=Se.Scalar.Clamp(this.g,v,C),T.b=Se.Scalar.Clamp(this.b,v,C),T.a=Se.Scalar.Clamp(this.a,v,C),this}multiply(v){return new ge(this.r*v.r,this.g*v.g,this.b*v.b,this.a*v.a)}multiplyToRef(v,C){return C.r=this.r*v.r,C.g=this.g*v.g,C.b=this.b*v.b,C.a=this.a*v.a,C}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let v=this.r||0;return v=397*v^(this.g||0),v=397*v^(this.b||0),v=397*v^(this.a||0),v}clone(){return new ge(this.r,this.g,this.b,this.a)}copyFrom(v){return this.r=v.r,this.g=v.g,this.b=v.b,this.a=v.a,this}copyFromFloats(v,C,T,S){return this.r=v,this.g=C,this.b=T,this.a=S,this}set(v,C,T,S){return this.copyFromFloats(v,C,T,S)}toHexString(){const v=255*this.r|0,C=255*this.g|0,T=255*this.b|0,S=255*this.a|0;return"#"+Se.Scalar.ToHex(v)+Se.Scalar.ToHex(C)+Se.Scalar.ToHex(T)+Se.Scalar.ToHex(S)}toLinearSpace(){const v=new ge;return this.toLinearSpaceToRef(v),v}toLinearSpaceToRef(v){return v.r=Math.pow(this.r,Ee.ToLinearSpace),v.g=Math.pow(this.g,Ee.ToLinearSpace),v.b=Math.pow(this.b,Ee.ToLinearSpace),v.a=this.a,this}toGammaSpace(){const v=new ge;return this.toGammaSpaceToRef(v),v}toGammaSpaceToRef(v){return v.r=Math.pow(this.r,Ee.ToGammaSpace),v.g=Math.pow(this.g,Ee.ToGammaSpace),v.b=Math.pow(this.b,Ee.ToGammaSpace),v.a=this.a,this}}Te.Color4=ge,Object.defineProperty(be,"__esModule",{value:!0}),be.Color3=void 0;const _e=Rt,Re=Te,Pe=Lt;class xe{constructor(v=0,C=0,T=0){this.r=v,this.g=C,this.b=T}static FromHexString(v){if("#"!==v.substring(0,1)||7!==v.length)return new xe(0,0,0);const C=parseInt(v.substring(1,3),16),T=parseInt(v.substring(3,5),16),S=parseInt(v.substring(5,7),16);return xe.FromInts(C,T,S)}static FromArray(v,C=0){return new xe(v[C],v[C+1],v[C+2])}static FromInts(v,C,T){return new xe(v/255,C/255,T/255)}static Lerp(v,C,T){const S=new xe(0,0,0);return xe.LerpToRef(v,C,T,S),S}static LerpToRef(v,C,T,S){S.r=v.r+(C.r-v.r)*T,S.g=v.g+(C.g-v.g)*T,S.b=v.b+(C.b-v.b)*T}static Red(){return new xe(1,0,0)}static Green(){return new xe(0,1,0)}static Blue(){return new xe(0,0,1)}static Black(){return new xe(0,0,0)}static White(){return new xe(1,1,1)}static Purple(){return new xe(.5,0,.5)}static Magenta(){return new xe(1,0,1)}static Yellow(){return new xe(1,1,0)}static Gray(){return new xe(.5,.5,.5)}static Teal(){return new xe(0,1,1)}static Random(){return new xe(Math.random(),Math.random(),Math.random())}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let v=this.r||0;return v=397*v^(this.g||0),v=397*v^(this.b||0),v}toArray(v,C=0){return v[C]=this.r,v[C+1]=this.g,v[C+2]=this.b,this}toColor4(v=1){return new Re.Color4(this.r,this.g,this.b,v)}asArray(){const v=new Array;return this.toArray(v,0),v}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(v){return new xe(this.r*v.r,this.g*v.g,this.b*v.b)}multiplyToRef(v,C){return C.r=this.r*v.r,C.g=this.g*v.g,C.b=this.b*v.b,this}equals(v){return v&&this.r===v.r&&this.g===v.g&&this.b===v.b}equalsFloats(v,C,T){return this.r===v&&this.g===C&&this.b===T}scale(v){return new xe(this.r*v,this.g*v,this.b*v)}scaleToRef(v,C){return C.r=this.r*v,C.g=this.g*v,C.b=this.b*v,this}scaleAndAddToRef(v,C){return C.r+=this.r*v,C.g+=this.g*v,C.b+=this.b*v,this}clampToRef(v=0,C=1,T){return T.r=Pe.Scalar.Clamp(this.r,v,C),T.g=Pe.Scalar.Clamp(this.g,v,C),T.b=Pe.Scalar.Clamp(this.b,v,C),this}add(v){return new xe(this.r+v.r,this.g+v.g,this.b+v.b)}addToRef(v,C){return C.r=this.r+v.r,C.g=this.g+v.g,C.b=this.b+v.b,this}subtract(v){return new xe(this.r-v.r,this.g-v.g,this.b-v.b)}subtractToRef(v,C){return C.r=this.r-v.r,C.g=this.g-v.g,C.b=this.b-v.b,this}clone(){return new xe(this.r,this.g,this.b)}copyFrom(v){return this.r=v.r,this.g=v.g,this.b=v.b,this}copyFromFloats(v,C,T){return this.r=v,this.g=C,this.b=T,this}set(v,C,T){return this.copyFromFloats(v,C,T)}toHexString(){const v=255*this.r|0,C=255*this.g|0,T=255*this.b|0;return"#"+Pe.Scalar.ToHex(v)+Pe.Scalar.ToHex(C)+Pe.Scalar.ToHex(T)}toLinearSpace(){const v=new xe;return this.toLinearSpaceToRef(v),v}toLinearSpaceToRef(v){return v.r=Math.pow(this.r,_e.ToLinearSpace),v.g=Math.pow(this.g,_e.ToLinearSpace),v.b=Math.pow(this.b,_e.ToLinearSpace),this}toGammaSpace(){const v=new xe;return this.toGammaSpaceToRef(v),v}toGammaSpaceToRef(v){return v.r=Math.pow(this.r,_e.ToGammaSpace),v.g=Math.pow(this.g,_e.ToGammaSpace),v.b=Math.pow(this.b,_e.ToGammaSpace),this}toJSON(){return{r:this.r,g:this.g,b:this.b}}}be.Color3=xe;var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.Curve3=void 0;const Oe=Ot;class Ae{constructor(v){this._length=0,this._points=v,this._length=this._computeLength(v)}static CreateQuadraticBezier(v,C,T,S){S=S>2?S:3;const E=new Array,r=(v,C,T,S)=>(1-v)*(1-v)*C+2*v*(1-v)*T+v*v*S;for(let A=0;A<=S;A++)E.push(new Oe.Vector3(r(A/S,v.x,C.x,T.x),r(A/S,v.y,C.y,T.y),r(A/S,v.z,C.z,T.z)));return new Ae(E)}static CreateCubicBezier(v,C,T,S,E){E=E>3?E:4;const A=new Array,s=(v,C,T,S,E)=>(1-v)*(1-v)*(1-v)*C+3*v*(1-v)*(1-v)*T+3*v*v*(1-v)*S+v*v*v*E;for(let R=0;R<=E;R++)A.push(new Oe.Vector3(s(R/E,v.x,C.x,T.x,S.x),s(R/E,v.y,C.y,T.y,S.y),s(R/E,v.z,C.z,T.z,S.z)));return new Ae(A)}static CreateHermiteSpline(v,C,T,S,E){const A=new Array,R=1/E;for(let O=0;O<=E;O++)A.push(Oe.Vector3.Hermite(v,C,T,S,O*R));return new Ae(A)}static CreateCatmullRomSpline(v,C,T){const S=new Array,E=1/C;let A=0;if(T){const T=v.length;for(let R=0;R<T;R++){A=0;for(let O=0;O<C;O++)S.push(Oe.Vector3.CatmullRom(v[R%T],v[(R+1)%T],v[(R+2)%T],v[(R+3)%T],A)),A+=E}S.push(S[0])}else{const T=new Array;T.push(v[0].clone()),Array.prototype.push.apply(T,v),T.push(v[v.length-1].clone());let R=0;for(R=0;R<T.length-3;R++){A=0;for(let v=0;v<C;v++)S.push(Oe.Vector3.CatmullRom(T[R],T[R+1],T[R+2],T[R+3],A)),A+=E}R--,S.push(Oe.Vector3.CatmullRom(T[R],T[R+1],T[R+2],T[R+3],A))}return new Ae(S)}getPoints(){return this._points}length(){return this._length}continue(v){const C=this._points[this._points.length-1],T=this._points.slice(),S=v.getPoints();for(let v=1;v<S.length;v++)T.push(S[v].subtract(S[0]).add(C));return new Ae(T)}_computeLength(v){let C=0;for(let T=1;T<v.length;T++)C+=v[T].subtract(v[T-1]).length();return C}}Ie.Curve3=Ae;var Be={},Ne={};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.Plane=void 0;const Le=Ot,ke=Bt,Fe=Pt;class ze{constructor(v,C,T,S){this.normal=new Le.Vector3(v,C,T),this.d=S}static FromArray(v){return new ze(v[0],v[1],v[2],v[3])}static FromPoints(v,C,T){const S=new ze(0,0,0,0);return S.copyFromPoints(v,C,T),S}static FromPositionAndNormal(v,C){const T=new ze(0,0,0,0);return C.normalize(),T.normal=C,T.d=-(C.x*v.x+C.y*v.y+C.z*v.z),T}static SignedDistanceToPlaneFromPositionAndNormal(v,C,T){const S=-(C.x*v.x+C.y*v.y+C.z*v.z);return Le.Vector3.Dot(T,C)+S}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new ze(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let v=this.normal.getHashCode();return v=397*v^(this.d||0),v}normalize(){const v=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let C=0;return 0!==v&&(C=1/v),this.normal.x*=C,this.normal.y*=C,this.normal.z*=C,this.d*=C,this}transform(v){const C=Fe.MathTmp.Matrix[0];ke.Matrix.TransposeToRef(v,C);const T=C.m,S=this.normal.x,E=this.normal.y,A=this.normal.z,R=this.d,O=S*T[0]+E*T[1]+A*T[2]+R*T[3],M=S*T[4]+E*T[5]+A*T[6]+R*T[7],z=S*T[8]+E*T[9]+A*T[10]+R*T[11],B=S*T[12]+E*T[13]+A*T[14]+R*T[15];return new ze(O,M,z,B)}dotCoordinate(v){return this.normal.x*v.x+this.normal.y*v.y+this.normal.z*v.z+this.d}copyFromPoints(v,C,T){const S=C.x-v.x,E=C.y-v.y,A=C.z-v.z,R=T.x-v.x,O=T.y-v.y,M=T.z-v.z,z=E*M-A*O,B=A*R-S*M,V=S*O-E*R,q=Math.sqrt(z*z+B*B+V*V);let j;return j=0!==q?1/q:0,this.normal.x=z*j,this.normal.y=B*j,this.normal.z=V*j,this.d=-(this.normal.x*v.x+this.normal.y*v.y+this.normal.z*v.z),this}isFrontFacingTo(v,C){return Le.Vector3.Dot(this.normal,v)<=C}signedDistanceTo(v){return Le.Vector3.Dot(v,this.normal)+this.d}}Ne.Plane=ze,Object.defineProperty(Be,"__esModule",{value:!0}),Be.Frustum=void 0;const Ve=Ne;class Me{static GetPlanes(v){const C=[];for(let v=0;v<6;v++)C.push(new Ve.Plane(0,0,0,0));return Me.GetPlanesToRef(v,C),C}static GetNearPlaneToRef(v,C){const T=v.m;C.normal.x=T[3]+T[2],C.normal.y=T[7]+T[6],C.normal.z=T[11]+T[10],C.d=T[15]+T[14],C.normalize()}static GetFarPlaneToRef(v,C){const T=v.m;C.normal.x=T[3]-T[2],C.normal.y=T[7]-T[6],C.normal.z=T[11]-T[10],C.d=T[15]-T[14],C.normalize()}static GetLeftPlaneToRef(v,C){const T=v.m;C.normal.x=T[3]+T[0],C.normal.y=T[7]+T[4],C.normal.z=T[11]+T[8],C.d=T[15]+T[12],C.normalize()}static GetRightPlaneToRef(v,C){const T=v.m;C.normal.x=T[3]-T[0],C.normal.y=T[7]-T[4],C.normal.z=T[11]-T[8],C.d=T[15]-T[12],C.normalize()}static GetTopPlaneToRef(v,C){const T=v.m;C.normal.x=T[3]-T[1],C.normal.y=T[7]-T[5],C.normal.z=T[11]-T[9],C.d=T[15]-T[13],C.normalize()}static GetBottomPlaneToRef(v,C){const T=v.m;C.normal.x=T[3]+T[1],C.normal.y=T[7]+T[5],C.normal.z=T[11]+T[9],C.d=T[15]+T[13],C.normalize()}static GetPlanesToRef(v,C){Me.GetNearPlaneToRef(v,C[0]),Me.GetFarPlaneToRef(v,C[1]),Me.GetLeftPlaneToRef(v,C[2]),Me.GetRightPlaneToRef(v,C[3]),Me.GetTopPlaneToRef(v,C[4]),Me.GetBottomPlaneToRef(v,C[5])}}Be.Frustum=Me;var Ue={};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.Path2=void 0;const qe=de,He=le,Ge=Rt;class De{constructor(v,C){this.closed=!1,this._points=new Array,this._length=0,this._points.push(new qe.Vector2(v,C))}static StartingAt(v,C){return new De(v,C)}addLineTo(v,C){if(this.closed)return this;const T=new qe.Vector2(v,C),S=this._points[this._points.length-1];return this._points.push(T),this._length+=T.subtract(S).length(),this}addArcTo(v,C,T,S,E=36){if(this.closed)return this;const A=this._points[this._points.length-1],R=new qe.Vector2(v,C),O=new qe.Vector2(T,S),M=new He.Arc2(A,R,O);let z=M.angle.radians()/E;M.orientation===Ge.Orientation.CW&&(z*=-1);let B=M.startAngle.radians()+z;for(let v=0;v<E;v++){const v=Math.cos(B)*M.radius+M.centerPoint.x,C=Math.sin(B)*M.radius+M.centerPoint.y;this.addLineTo(v,C),B+=z}return this}close(){return this.closed=!0,this}length(){let v=this._length;if(!this.closed){const C=this._points[this._points.length-1];v+=this._points[0].subtract(C).length()}return v}getPoints(){return this._points}getPointAtLengthPosition(v){if(v<0||v>1)return qe.Vector2.Zero();const C=v*this.length();let T=0;for(let v=0;v<this._points.length;v++){const S=(v+1)%this._points.length,E=this._points[v],A=this._points[S].subtract(E),R=A.length()+T;if(C>=T&&C<=R){const v=A.normalize(),S=C-T;return new qe.Vector2(E.x+v.x*S,E.y+v.y*S)}T=R}return qe.Vector2.Zero()}}Ue.Path2=De;var We={};Object.defineProperty(We,"__esModule",{value:!0}),We.Path3D=void 0;const Xe=Ot,Qe=Rt,Ye=Lt;We.Path3D=class{constructor(v,C=null,T){this.path=v,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(let C=0;C<v.length;C++)this._curve[C]=v[C].clone();this._raw=T||!1,this._compute(C)}getCurve(){return this._curve}getTangents(){return this._tangents}getNormals(){return this._normals}getBinormals(){return this._binormals}getDistances(){return this._distances}update(v,C=null){for(let C=0;C<v.length;C++)this._curve[C].x=v[C].x,this._curve[C].y=v[C].y,this._curve[C].z=v[C].z;return this._compute(C),this}_compute(v){const C=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[C-1]=this._curve[C-1].subtract(this._curve[C-2]),this._raw||this._tangents[C-1].normalize();const T=this._tangents[0],S=this._normalVector(this._curve[0],T,v);let E,A,R,O;this._normals[0]=S,this._raw||this._normals[0].normalize(),this._binormals[0]=Xe.Vector3.Cross(T,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(let v=1;v<C;v++)E=this._getLastNonNullVector(v),v<C-1&&(A=this._getFirstNonNullVector(v),this._tangents[v]=E.add(A),this._tangents[v].normalize()),this._distances[v]=this._distances[v-1]+E.length(),R=this._tangents[v],O=this._binormals[v-1],this._normals[v]=Xe.Vector3.Cross(O,R),this._raw||this._normals[v].normalize(),this._binormals[v]=Xe.Vector3.Cross(R,this._normals[v]),this._raw||this._binormals[v].normalize()}_getFirstNonNullVector(v){let C=1,T=this._curve[v+C].subtract(this._curve[v]);for(;0===T.length()&&v+C+1<this._curve.length;)C++,T=this._curve[v+C].subtract(this._curve[v]);return T}_getLastNonNullVector(v){let C=1,T=this._curve[v].subtract(this._curve[v-C]);for(;0===T.length()&&v>C+1;)C++,T=this._curve[v].subtract(this._curve[v-C]);return T}_normalVector(v,C,T){let S,E=C.length();if(0===E&&(E=1),null==T){let v;v=Ye.Scalar.WithinEpsilon(Math.abs(C.y)/E,1,Qe.Epsilon)?Ye.Scalar.WithinEpsilon(Math.abs(C.x)/E,1,Qe.Epsilon)?Ye.Scalar.WithinEpsilon(Math.abs(C.z)/E,1,Qe.Epsilon)?Xe.Vector3.Zero():new Xe.Vector3(0,0,1):new Xe.Vector3(1,0,0):new Xe.Vector3(0,-1,0),S=Xe.Vector3.Cross(C,v)}else S=Xe.Vector3.Cross(C,T),Xe.Vector3.CrossToRef(S,C,S);return S.normalize(),S}};var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.Size=void 0;class je{constructor(v,C){this.width=v,this.height=C}get surface(){return this.width*this.height}static Zero(){return new je(0,0)}static Lerp(v,C,T){const S=v.width+(C.width-v.width)*T,E=v.height+(C.height-v.height)*T;return new je(S,E)}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let v=this.width||0;return v=397*v^(this.height||0),v}copyFrom(v){this.width=v.width,this.height=v.height}copyFromFloats(v,C){return this.width=v,this.height=C,this}set(v,C){return this.copyFromFloats(v,C)}multiplyByFloats(v,C){return new je(this.width*v,this.height*C)}clone(){return new je(this.width,this.height)}equals(v){return!!v&&this.width===v.width&&this.height===v.height}add(v){return new je(this.width+v.width,this.height+v.height)}subtract(v){return new je(this.width-v.width,this.height-v.height)}}Ze.Size=je,function(v){var C=At&&At.__createBinding||(Object.create?function(v,C,T,S){void 0===S&&(S=T),Object.defineProperty(v,S,{enumerable:!0,get:function(){return C[T]}})}:function(v,C,T,S){void 0===S&&(S=T),v[S]=C[T]}),T=At&&At.__exportStar||function(v,T){for(var S in v)"default"===S||Object.prototype.hasOwnProperty.call(T,S)||C(T,v,S)};Object.defineProperty(v,"__esModule",{value:!0}),T(Rt,v),T(Pt,v),T(ce,v),T(le,v),T(ve,v),T(Ce,v),T(be,v),T(Te,v),T(Ie,v),T(Be,v),T(Bt,v),T(Ue,v),T(We,v),T(Ne,v),T(zt,v),T(Lt,v),T(Ze,v),T(de,v),T(Ot,v),T(Nt,v),T(_t,v)}(_t);var Je,$e,tn,nn,on={looping:!0,speed:1,weight:1,layer:0},rn=function(v){function e(C,T){void 0===T&&(T=on);var S=v.call(this)||this;return S.isAnimationClip=!0,S.looping=on.looping,S.weight=on.weight,S.playing=!1,S.shouldReset=!1,S.speed=on.speed,S.name=f("AnimClip"),S.layer=on.layer,S.clip=C,S.setParams(o({},T)),S}return i(e,v),e.prototype.setParams=function(v){return this.looping=void 0!==v.looping?v.looping:this.looping,this.speed=v.speed||this.speed,this.weight=v.weight||this.weight,this.layer=v.layer||this.layer,this},e.prototype.toJSON=function(){var C=JSON.parse(JSON.stringify(v.prototype.toJSON.call(this)));return this.shouldReset&&(this.shouldReset=!1),C},e.prototype.play=function(v){var C;void 0===v&&(v=!1),null===(C=this.owner)||void 0===C||C.play(this,v)},e.prototype.pause=function(){var v;null===(v=this.owner)||void 0===v||v.pause(this)},e.prototype.reset=function(){this.shouldReset=!0},e.prototype.stop=function(){var v;null===(v=this.owner)||void 0===v||v.stop(this)},r([X.readonly,s("design:type",String)],e.prototype,"clip",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"looping",void 0),r([X.field,s("design:type",Number)],e.prototype,"weight",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"playing",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"shouldReset",void 0),r([X.field,s("design:type",Number)],e.prototype,"speed",void 0),r([X.readonly,s("design:type",String)],e.prototype,"name",void 0),e}(X);v.InputEventType=void 0,(Je=v.InputEventType||(v.InputEventType={}))[Je.DOWN=0]="DOWN",Je[Je.UP=1]="UP",v.CameraMode=void 0,($e=v.CameraMode||(v.CameraMode={}))[$e.FirstPerson=0]="FirstPerson",$e[$e.ThirdPerson=1]="ThirdPerson",$e[$e.BuildingToolGodMode=2]="BuildingToolGodMode",v.LandRole=void 0,(tn=v.LandRole||(v.LandRole={})).OWNER="owner",tn.OPERATOR="operator",v.ActionButton=void 0,(nn=v.ActionButton||(v.ActionButton={})).POINTER="POINTER",nn.PRIMARY="PRIMARY",nn.SECONDARY="SECONDARY",nn.ANY="ANY",nn.FORWARD="FORWARD",nn.BACKWARD="BACKWARD",nn.RIGHT="RIGHT",nn.LEFT="LEFT",nn.JUMP="JUMP",nn.WALK="WALK",nn.ACTION_3="ACTION_3",nn.ACTION_4="ACTION_4",nn.ACTION_5="ACTION_5",nn.ACTION_6="ACTION_6";var sn,an,Ke=function(v){if(this.callback=v,!v||!("apply"in v)||!("call"in v))throw new Error("Callback is not a function");dn.ensureInstance()},cn=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return i(e,v),r([P("pointerDown")],e)}(Ke),ln=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return i(e,v),r([P("pointerUp")],e)}(Ke),en=function(v,C){this.fn=v,this.useRaycast=C},dn=function(){function e(){this.buttonIdMapping=[v.ActionButton.POINTER,v.ActionButton.PRIMARY,v.ActionButton.SECONDARY,v.ActionButton.ANY,v.ActionButton.FORWARD,v.ActionButton.BACKWARD,v.ActionButton.RIGHT,v.ActionButton.LEFT,v.ActionButton.JUMP,v.ActionButton.WALK,v.ActionButton.ACTION_3,v.ActionButton.ACTION_4,v.ActionButton.ACTION_5,v.ActionButton.ACTION_6],this.subscriptions=this.buttonIdMapping.reduce((function(v,C){var T;return o(o({},v),((T={})[C]={BUTTON_DOWN:[],BUTTON_UP:[]},T))}),{}),this.internalState=this.buttonIdMapping.reduce((function(v,C){var T;return o(o({},v),((T={})[C]={BUTTON_DOWN:!1},T))}),{})}return Object.defineProperty(e,"instance",{get:function(){return e.ensureInstance(),e._instance},enumerable:!1,configurable:!0}),e.ensureInstance=function(){e._instance||(e._instance=new e)},e.prototype.isButtonPressed=function(v){return this.internalState[v]},e.prototype.subscribe=function(v,C,T,S){var E=this;return this.subscriptions[C][v].push(new en(S,T)),function(){E.unsubscribe(v,C,S)}},e.prototype.unsubscribe=function(v,C,T){var S=this.getSubscriptionId(v,C,T);return S>-1&&this.subscriptions[C][v].splice(S,1)},e.prototype.handlePointerEvent=function(C){var T=this.getPointerById(C.buttonId);if(T){var S=o(o({},C),{button:T,direction:(new _t.Vector3).copyFrom(C.direction),origin:(new _t.Vector3).copyFrom(C.origin),hit:void 0}),E=C.hit?o(o({},C.hit),{hitPoint:(new _t.Vector3).copyFrom(C.hit.hitPoint),normal:(new _t.Vector3).copyFrom(C.hit.normal),worldNormal:(new _t.Vector3).copyFrom(C.hit.worldNormal)}):void 0;if(C.type===v.InputEventType.DOWN){this.internalState[T].BUTTON_DOWN=!0;for(var A=0;A<this.subscriptions[T].BUTTON_DOWN.length;A++)(R=this.subscriptions[T].BUTTON_DOWN[A]).useRaycast?S.hit=E:S.hit=void 0,R.fn(S);E&&E.entityId&&N.engine&&(M=(O=N.engine.entities[E.entityId])&&O.getComponentOrNull(cn))&&(S.hit=E,M.callback(S))}else{for(this.internalState[T].BUTTON_DOWN=!1,A=0;A<this.subscriptions[T].BUTTON_UP.length;A++){var R;(R=this.subscriptions[T].BUTTON_UP[A]).useRaycast?S.hit=E:S.hit=void 0,R.fn(S)}var O,M;E&&E.entityId&&N.engine&&(M=(O=N.engine.entities[E.entityId])&&O.getComponentOrNull(ln))&&(S.hit=E,M.callback(S))}}},e.prototype.getSubscriptionId=function(v,C,T){for(var S=0;S<this.subscriptions[C][v].length;S++)if(this.subscriptions[C][v][S].fn===T)return S;return-1},e.prototype.getPointerById=function(C){if(C<0||C>=this.buttonIdMapping.length)return null;var T=this.buttonIdMapping[C];return T===v.ActionButton.ANY?null:T},e}();v.CLASS_ID=void 0,(sn=v.CLASS_ID||(v.CLASS_ID={}))[sn.TRANSFORM=1]="TRANSFORM",sn[sn.UUID_CALLBACK=8]="UUID_CALLBACK",sn[sn.BOX_SHAPE=16]="BOX_SHAPE",sn[sn.SPHERE_SHAPE=17]="SPHERE_SHAPE",sn[sn.PLANE_SHAPE=18]="PLANE_SHAPE",sn[sn.CONE_SHAPE=19]="CONE_SHAPE",sn[sn.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",sn[sn.TEXT_SHAPE=21]="TEXT_SHAPE",sn[sn.NFT_SHAPE=22]="NFT_SHAPE",sn[sn.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",sn[sn.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",sn[sn.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",sn[sn.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",sn[sn.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",sn[sn.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",sn[sn.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",sn[sn.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",sn[sn.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",sn[sn.BILLBOARD=32]="BILLBOARD",sn[sn.ANIMATION=33]="ANIMATION",sn[sn.FONT=34]="FONT",sn[sn.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",sn[sn.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",sn[sn.GLTF_SHAPE=54]="GLTF_SHAPE",sn[sn.OBJ_SHAPE=55]="OBJ_SHAPE",sn[sn.AVATAR_SHAPE=56]="AVATAR_SHAPE",sn[sn.BASIC_MATERIAL=64]="BASIC_MATERIAL",sn[sn.PBR_MATERIAL=65]="PBR_MATERIAL",sn[sn.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",sn[sn.SOUND=67]="SOUND",sn[sn.TEXTURE=68]="TEXTURE",sn[sn.VIDEO_CLIP=70]="VIDEO_CLIP",sn[sn.VIDEO_TEXTURE=71]="VIDEO_TEXTURE",sn[sn.AVATAR_TEXTURE=72]="AVATAR_TEXTURE",sn[sn.AUDIO_CLIP=200]="AUDIO_CLIP",sn[sn.AUDIO_SOURCE=201]="AUDIO_SOURCE",sn[sn.AUDIO_STREAM=202]="AUDIO_STREAM",sn[sn.GIZMOS=203]="GIZMOS",sn[sn.SMART_ITEM=204]="SMART_ITEM",sn[sn.AVATAR_MODIFIER_AREA=205]="AVATAR_MODIFIER_AREA",sn[sn.AVATAR_ATTACH=206]="AVATAR_ATTACH",sn[sn.CAMERA_MODE_AREA=207]="CAMERA_MODE_AREA",sn[sn.NAME=300]="NAME",sn[sn.LOCKED_ON_EDIT=301]="LOCKED_ON_EDIT",sn[sn.VISIBLE_ON_EDIT=302]="VISIBLE_ON_EDIT",v.AvatarModifiers=void 0,(an=v.AvatarModifiers||(v.AvatarModifiers={})).HIDE_AVATARS="HIDE_AVATARS",an.DISABLE_PASSPORTS="DISABLE_PASSPORTS";var hn,un=function(C){function n(v){var T=C.call(this)||this;return T.area=v.area,T.modifiers=v.modifiers,T.excludeIds=v.excludeIds,T}return i(n,C),r([X.field,s("design:type",Object)],n.prototype,"area",void 0),r([X.field,s("design:type",Array)],n.prototype,"modifiers",void 0),r([X.field,s("design:type",Array)],n.prototype,"excludeIds",void 0),r([P("engine.avatarModifierArea",v.CLASS_ID.AVATAR_MODIFIER_AREA),s("design:paramtypes",[Object])],n)}(X),pn=function(C){function n(v){void 0===v&&(v={});var T=C.call(this)||this;return T.position=v.position||_t.Vector3.Zero(),T.rotation=v.rotation||_t.Quaternion.Identity,T.scale=v.scale||new _t.Vector3(1,1,1),T}return i(n,C),Object.defineProperty(n.prototype,"eulerAngles",{get:function(){return this.rotation.eulerAngles},enumerable:!1,configurable:!0}),n.prototype.lookAt=function(v,C){void 0===C&&(C=_t.MathTmp.staticUp);var T=new _t.Matrix;return _t.Matrix.LookAtLHToRef(this.position,v,C,T),T.invert(),_t.Quaternion.FromRotationMatrixToRef(T,this.rotation),this},n.prototype.rotate=function(v,C){return this.rotation.multiplyInPlace(this.rotation.angleAxis(C,v)),this},n.prototype.translate=function(v){return this.position.addInPlace(v),this},r([X.field,s("design:type",_t.Vector3)],n.prototype,"position",void 0),r([X.field,s("design:type",_t.Quaternion)],n.prototype,"rotation",void 0),r([X.field,s("design:type",_t.Vector3)],n.prototype,"scale",void 0),r([P("engine.transform",v.CLASS_ID.TRANSFORM),s("design:paramtypes",[Object])],n)}(X);v.AttachToAvatarAnchorPointId=void 0,(hn=v.AttachToAvatarAnchorPointId||(v.AttachToAvatarAnchorPointId={}))[hn.Position=0]="Position",hn[hn.NameTag=1]="NameTag",hn[hn.LeftHand=2]="LeftHand",hn[hn.RightHand=3]="RightHand";var mn,fn=function(C){function n(T){void 0===T&&(T={});var S=C.call(this)||this;return S.avatarId=T.avatarId||"",S.anchorPointId=T.anchorPointId||v.AttachToAvatarAnchorPointId.Position,S}return i(n,C),r([X.field,s("design:type",String)],n.prototype,"avatarId",void 0),r([X.field,s("design:type",Number)],n.prototype,"anchorPointId",void 0),r([X.field,s("design:type",String)],n.prototype,"avatarSceneId",void 0),r([P("engine.transform",v.CLASS_ID.AVATAR_ATTACH),s("design:paramtypes",[Object])],n)}(X),yn=function(C){function n(v,T,S){void 0===v&&(v=!0),void 0===T&&(T=!0),void 0===S&&(S=!0);var E=C.call(this)||this;return E.x=!0,E.y=!0,E.z=!0,E.x=v,E.y=T,E.z=S,E}return i(n,C),r([X.field,s("design:type",Boolean)],n.prototype,"x",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"y",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"z",void 0),r([P("engine.billboard",v.CLASS_ID.BILLBOARD),s("design:paramtypes",[Boolean,Boolean,Boolean])],n)}(X),gn=function(v){function e(){var C=null!==v&&v.apply(this,arguments)||this;return C.withCollisions=!0,C.isPointerBlocker=!0,C.visible=!0,C}return i(e,v),r([X.field,s("design:type",Boolean)],e.prototype,"withCollisions",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"visible",void 0),e}(X),vn=function(C){function n(){return null!==C&&C.apply(this,arguments)||this}return i(n,C),r([X.field,s("design:type",Array)],n.prototype,"uvs",void 0),r([N("engine.shape",v.CLASS_ID.BOX_SHAPE)],n)}(gn),wn=function(C){function n(){return null!==C&&C.apply(this,arguments)||this}return i(n,C),r([N("engine.shape",v.CLASS_ID.SPHERE_SHAPE)],n)}(gn),Cn=function(C){function n(){return null!==C&&C.apply(this,arguments)||this}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"segments",void 0),r([X.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CIRCLE_SHAPE)],n)}(gn),bn=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.width=1,v.height=1,v}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"width",void 0),r([X.field,s("design:type",Number)],n.prototype,"height",void 0),r([X.field,s("design:type",Array)],n.prototype,"uvs",void 0),r([N("engine.shape",v.CLASS_ID.PLANE_SHAPE)],n)}(gn),Tn=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.radiusTop=0,v.radiusBottom=1,v.segmentsHeight=1,v.segmentsRadial=36,v.openEnded=!1,v.radius=null,v.arc=360,v}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"radiusTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"radiusBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"segmentsHeight",void 0),r([X.field,s("design:type",Number)],n.prototype,"segmentsRadial",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"openEnded",void 0),r([X.field,s("design:type",Object)],n.prototype,"radius",void 0),r([X.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CONE_SHAPE)],n)}(gn),Sn=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.radiusTop=1,v.radiusBottom=1,v.segmentsHeight=1,v.segmentsRadial=36,v.openEnded=!1,v.radius=null,v.arc=360,v}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"radiusTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"radiusBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"segmentsHeight",void 0),r([X.field,s("design:type",Number)],n.prototype,"segmentsRadial",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"openEnded",void 0),r([X.field,s("design:type",Object)],n.prototype,"radius",void 0),r([X.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CYLINDER_SHAPE)],n)}(gn),En=function(C){function n(v){var T=C.call(this)||this;return T.src=v,T}return i(n,C),r([gn.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.shape",v.CLASS_ID.GLTF_SHAPE),s("design:paramtypes",[String])],n)}(gn);v.PictureFrameStyle=void 0,(mn=v.PictureFrameStyle||(v.PictureFrameStyle={}))[mn.Classic=0]="Classic",mn[mn.Baroque_Ornament=1]="Baroque_Ornament",mn[mn.Diamond_Ornament=2]="Diamond_Ornament",mn[mn.Minimal_Wide=3]="Minimal_Wide",mn[mn.Minimal_Grey=4]="Minimal_Grey",mn[mn.Blocky=5]="Blocky",mn[mn.Gold_Edges=6]="Gold_Edges",mn[mn.Gold_Carved=7]="Gold_Carved",mn[mn.Gold_Wide=8]="Gold_Wide",mn[mn.Gold_Rounded=9]="Gold_Rounded",mn[mn.Metal_Medium=10]="Metal_Medium",mn[mn.Metal_Wide=11]="Metal_Wide",mn[mn.Metal_Slim=12]="Metal_Slim",mn[mn.Metal_Rounded=13]="Metal_Rounded",mn[mn.Pins=14]="Pins",mn[mn.Minimal_Black=15]="Minimal_Black",mn[mn.Minimal_White=16]="Minimal_White",mn[mn.Tape=17]="Tape",mn[mn.Wood_Slim=18]="Wood_Slim",mn[mn.Wood_Wide=19]="Wood_Wide",mn[mn.Wood_Twigs=20]="Wood_Twigs",mn[mn.Canvas=21]="Canvas",mn[mn.None=22]="None";var xn,An=function(C){function n(T,S){void 0===S&&(S={});var E=C.call(this)||this;E.src=T;var A=new _t.Color3(.6404918,.611472,.8584906),R=v.PictureFrameStyle.Classic;return"r"in S?A=S:null!==S&&(S.color&&(A=S.color),S.style&&(R=S.style)),E.color=A,E.style=R,E}return i(n,C),r([gn.readonly,s("design:type",String)],n.prototype,"src",void 0),r([gn.readonly,s("design:type",Number)],n.prototype,"style",void 0),r([X.field,s("design:type",_t.Color3)],n.prototype,"color",void 0),r([N("engine.shape",v.CLASS_ID.NFT_SHAPE),s("design:paramtypes",[String,Object])],n)}(gn),_n=function(C){function n(v,T){var S=C.call(this)||this,E=new RegExp("data:[a-z-]+/[a-z-]+;base64");if((v.length>2048||E.test(v))&&c(" Base64 textures will be deprecated in version 7 of decentraland-ecs"),S.src=v,T)for(var A in T)S[A]=T[A];return S}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"src",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([X.readonly,s("design:type",Boolean)],n.prototype,"hasAlpha",void 0),r([N("engine.texture",v.CLASS_ID.TEXTURE),s("design:paramtypes",[String,Object])],n)}(X),Rn=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.states=[],v}return i(n,C),n.prototype.addClip=function(v){var C=this;return this.states.push(v),v.onChange((function(){C.dirty=!0})),v.owner=this,this},n.prototype.getClip=function(v){for(var C=0;C<this.states.length;C++){var T=this.states[C];if(T.clip===v)return T}var S=new rn(v);return this.addClip(S),S},n.prototype.stop=function(v){if(v)v.playing=!1,v.shouldReset=!0;else for(var C=0;C<this.states.length;C++){var T=this.states[C];this.stop(T)}},n.prototype.play=function(v,C){void 0===C&&(C=!1);for(var T=0;T<this.states.length;T++){var S=this.states[T];S.layer===v.layer&&v!==S&&this.pause(S)}C&&(v.shouldReset=!0),v.playing=!0,v.dirty=!0,v.data.nonce=Math.random()},n.prototype.pause=function(v){if(v)v.playing=!1;else for(var C=0;C<this.states.length;C++){var T=this.states[C];this.pause(T)}},r([X.readonly,s("design:type",Array)],n.prototype,"states",void 0),r([P("engine.animator",v.CLASS_ID.ANIMATION)],n)}(gn),Pn=function(C){function n(v){var T=C.call(this)||this;return T.src=v,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.shape",v.CLASS_ID.OBJ_SHAPE),s("design:paramtypes",[String])],n)}(gn),In=function(C){function n(v){void 0===v&&(v="");var T=C.call(this)||this;return T.src=v,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.font",v.CLASS_ID.FONT),s("design:paramtypes",[String])],n)}(X);v.Fonts=void 0,(xn=v.Fonts||(v.Fonts={})).SanFrancisco="builtin:SF-UI-Text-Regular SDF",xn.SanFrancisco_Heavy="builtin:SF-UI-Text-Heavy SDF",xn.SanFrancisco_Semibold="builtin:SF-UI-Text-Semibold SDF",xn.LiberationSans="builtin:LiberationSans SDF",xn.SansSerif="SansSerif",xn.SansSerif_Heavy="SansSerif_Heavy",xn.SansSerif_Bold="SansSerif_Bold",xn.SansSerif_SemiBold="SansSerif_SemiBold";var On,Mn=function(C){function n(v){var T=C.call(this)||this;return T.outlineWidth=0,T.outlineColor=new _t.Color3(1,1,1),T.color=new _t.Color3(1,1,1),T.fontSize=10,T.opacity=1,T.value="",T.lineSpacing="0px",T.lineCount=0,T.textWrapping=!1,T.shadowBlur=0,T.shadowOffsetX=0,T.shadowOffsetY=0,T.shadowColor=new _t.Color3(1,1,1),T.hTextAlign="center",T.vTextAlign="center",T.width=1,T.height=1,T.paddingTop=0,T.paddingRight=0,T.paddingBottom=0,T.paddingLeft=0,T.billboard=!1,T.visible=!0,v&&(T.value=v),T}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([X.field,s("design:type",_t.Color3)],n.prototype,"outlineColor",void 0),r([X.field,s("design:type",_t.Color3)],n.prototype,"color",void 0),r([X.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([X.component,s("design:type",In)],n.prototype,"font",void 0),r([X.field,s("design:type",Number)],n.prototype,"opacity",void 0),r([X.field,s("design:type",String)],n.prototype,"value",void 0),r([X.field,s("design:type",String)],n.prototype,"lineSpacing",void 0),r([X.field,s("design:type",Number)],n.prototype,"lineCount",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([X.field,s("design:type",_t.Color3)],n.prototype,"shadowColor",void 0),r([X.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([X.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([X.field,s("design:type",Number)],n.prototype,"width",void 0),r([X.field,s("design:type",Number)],n.prototype,"height",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"billboard",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"visible",void 0),r([P("engine.text",v.CLASS_ID.TEXT_SHAPE),s("design:paramtypes",[String])],n)}(X);v.TransparencyMode=void 0,(On=v.TransparencyMode||(v.TransparencyMode={}))[On.OPAQUE=0]="OPAQUE",On[On.ALPHA_TEST=1]="ALPHA_TEST",On[On.ALPHA_BLEND=2]="ALPHA_BLEND",On[On.ALPHA_TEST_AND_BLEND=3]="ALPHA_TEST_AND_BLEND",On[On.AUTO=4]="AUTO";var zn,Bn=function(C){function n(){var T=null!==C&&C.apply(this,arguments)||this;return T.alphaTest=.5,T.castShadows=!0,T.transparencyMode=v.TransparencyMode.AUTO,T}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"alphaTest",void 0),r([X.field,s("design:type",Object)],n.prototype,"albedoColor",void 0),r([X.field,s("design:type",_t.Color3)],n.prototype,"emissiveColor",void 0),r([X.field,s("design:type",Number)],n.prototype,"metallic",void 0),r([X.field,s("design:type",Number)],n.prototype,"roughness",void 0),r([X.field,s("design:type",_t.Color3)],n.prototype,"reflectivityColor",void 0),r([X.field,s("design:type",Number)],n.prototype,"directIntensity",void 0),r([X.field,s("design:type",Number)],n.prototype,"microSurface",void 0),r([X.field,s("design:type",Number)],n.prototype,"emissiveIntensity",void 0),r([X.field,s("design:type",Number)],n.prototype,"specularIntensity",void 0),r([X.component,s("design:type",Object)],n.prototype,"albedoTexture",void 0),r([X.component,s("design:type",Object)],n.prototype,"alphaTexture",void 0),r([X.component,s("design:type",Object)],n.prototype,"emissiveTexture",void 0),r([X.component,s("design:type",Object)],n.prototype,"bumpTexture",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"castShadows",void 0),r([X.field,s("design:type",Number)],n.prototype,"transparencyMode",void 0),r([N("engine.material",v.CLASS_ID.PBR_MATERIAL)],n)}(X),Nn=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.alphaTest=.5,v.castShadows=!0,v}return i(n,C),r([X.component,s("design:type",Object)],n.prototype,"texture",void 0),r([X.field,s("design:type",Number)],n.prototype,"alphaTest",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"castShadows",void 0),r([N("engine.material",v.CLASS_ID.BASIC_MATERIAL)],n)}(X),Dn=function(v){function e(C){var T=v.call(this)||this;if(T.uuid=f("UUID"),!C||!("apply"in C)||!("call"in C))throw new Error("Callback is not a function");return T.callback=C,T}return i(e,v),e.uuidEvent=function(v,C){if(delete v[C]){var T=C+"_"+Math.random();v[T]=void 0,Object.defineProperty(v,T,o(o({},Object.getOwnPropertyDescriptor(v,T)),{enumerable:!1})),Object.defineProperty(v,C.toString(),{get:function(){return this[T]},set:function(v){var S=this[T];if(v){if(!(v instanceof e))throw new Error("value is not an OnUUIDEvent");this.data[C]=v.uuid}else this.data[C]=null;if(this[T]=v,v!==S){this.dirty=!0;for(var E=0;E<this.subscriptions.length;E++)this.subscriptions[E](C,v,S)}},enumerable:!0})}},e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type}},r([X.field,s("design:type",Function)],e.prototype,"callback",void 0),e}(X),Ln=function(C){function n(){var T=null!==C&&C.apply(this,arguments)||this;return T.button=v.ActionButton.ANY,T.hoverText="Interact",T.distance=10,T.showFeedback=!0,T}return i(n,C),n.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type,button:this.button,hoverText:this.hoverText,distance:this.distance,showFeedback:this.showFeedback}},r([X.field,s("design:type",String)],n.prototype,"button",void 0),r([X.field,s("design:type",String)],n.prototype,"hoverText",void 0),r([X.field,s("design:type",Number)],n.prototype,"distance",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"showFeedback",void 0),n}(Dn),kn=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.type="onPointerLock",v}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onPointerLock",v.CLASS_ID.UUID_CALLBACK)],n)}(Dn),Fn=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.type="onAnimationEnd",v}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onAnimationEnd",v.CLASS_ID.UUID_CALLBACK)],n)}(Dn),Vn=function(C){function n(){return null!==C&&C.apply(this,arguments)||this}return i(n,C),r([P("engine.smartItem",v.CLASS_ID.SMART_ITEM)],n)}(X),Un=function(C){function n(v){var T=C.call(this)||this;return T.url=v,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"url",void 0),r([N("engine.VideoClip",v.CLASS_ID.VIDEO_CLIP),s("design:paramtypes",[String])],n)}(X);v.VideoStatus=void 0,(zn=v.VideoStatus||(v.VideoStatus={}))[zn.NONE=0]="NONE",zn[zn.ERROR=1]="ERROR",zn[zn.LOADING=2]="LOADING",zn[zn.READY=3]="READY",zn[zn.PLAYING=4]="PLAYING",zn[zn.BUFFERING=5]="BUFFERING";var qn,jn=function(C){function n(T,S){var E=C.call(this)||this;if(E.volume=1,E.playbackRate=1,E.loop=!1,E.seek=-1,E._position=-1,E._videoLength=-1,E._status=v.VideoStatus.NONE,E.playing=!1,!(T instanceof Un))throw new Error("Trying to create VideoTexture(VideoClip) with an invalid VideoClip");if(E.videoClipId=D(T),S)for(var A in S)E[A]=S[A];return E}return i(n,C),n.prototype.play=function(){this.playing=!0},n.prototype.pause=function(){this.playing=!1},n.prototype.reset=function(){this.seekTime(0),this.pause()},n.prototype.seekTime=function(v){this.seek=v,this.dirty=!0,this.data.nonce=Math.random()},n.prototype.toJSON=function(){if(this.seek>=0){var v=JSON.parse(JSON.stringify(C.prototype.toJSON.call(this)));return this.seek=-1,v}return C.prototype.toJSON.call(this)},n.prototype.update=function(C){C.videoClipId===this.videoClipId&&(this._status=C.videoStatus||v.VideoStatus.NONE,this._videoLength=C.totalVideoLength,this._position=C.currentOffset)},Object.defineProperty(n.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"videoLength",{get:function(){return this._videoLength},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),r([X.readonly,s("design:type",String)],n.prototype,"videoClipId",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([X.field,s("design:type",Number)],n.prototype,"volume",void 0),r([X.field,s("design:type",Number)],n.prototype,"playbackRate",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([X.field,s("design:type",Number)],n.prototype,"seek",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([N("engine.VideoTexture",v.CLASS_ID.VIDEO_TEXTURE),s("design:paramtypes",[Un,Object])],n)}(X),Hn=function(C){function n(v){var T=C.call(this)||this;return T.area=v.area,T.cameraMode=v.cameraMode,T}return i(n,C),r([X.field,s("design:type",Object)],n.prototype,"area",void 0),r([X.field,s("design:type",Number)],n.prototype,"cameraMode",void 0),r([P("engine.cameraModeArea",v.CLASS_ID.CAMERA_MODE_AREA),s("design:paramtypes",[Object])],n)}(X),Gn=function(C){function n(v,T){var S=C.call(this)||this;if(S.userId=v,T)for(var E in T)S[E]=T[E];return S}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"userId",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([X.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([X.readonly,s("design:type",Boolean)],n.prototype,"hasAlpha",void 0),r([N("engine.texture",v.CLASS_ID.AVATAR_TEXTURE),s("design:paramtypes",[String,Object])],n)}(X),Wn=function(){function e(){var C=this;this.position=new _t.Vector3,this.rotation=new _t.Quaternion,this.feetPosition=new _t.Vector3,this.worldPosition=new _t.Vector3,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,this._cameraMode=v.CameraMode.ThirdPerson,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.subscribe("cameraModeChanged"),dcl.onEvent((function(v){switch(v.type){case"positionChanged":C.positionChanged(v.data);break;case"rotationChanged":C.rotationChanged(v.data);break;case"cameraModeChanged":C.cameraModeChanged(v.data)}}))),Object.defineProperty(this.position,"x",{get:function(){return C.lastEventPosition.x}}),Object.defineProperty(this.position,"y",{get:function(){return C.lastEventPosition.y}}),Object.defineProperty(this.position,"z",{get:function(){return C.lastEventPosition.z}}),Object.defineProperty(this.worldPosition,"x",{get:function(){return C.lastEventWorldPosition.x}}),Object.defineProperty(this.worldPosition,"y",{get:function(){return C.lastEventWorldPosition.y}}),Object.defineProperty(this.worldPosition,"z",{get:function(){return C.lastEventWorldPosition.z}}),Object.defineProperty(this.feetPosition,"x",{get:function(){return C.lastEventPosition.x}}),Object.defineProperty(this.feetPosition,"y",{get:function(){return C.lastEventPosition.y-C.playerHeight}}),Object.defineProperty(this.feetPosition,"z",{get:function(){return C.lastEventPosition.z}}),Object.defineProperty(this.rotation,"x",{get:function(){return C.lastEventRotation.x}}),Object.defineProperty(this.rotation,"y",{get:function(){return C.lastEventRotation.y}}),Object.defineProperty(this.rotation,"z",{get:function(){return C.lastEventRotation.z}}),Object.defineProperty(this.rotation,"w",{get:function(){return C.lastEventRotation.w}})}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerHeight",{get:function(){return this._playerHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cameraMode",{get:function(){return this._cameraMode},enumerable:!1,configurable:!0}),e.prototype.positionChanged=function(v){this.lastEventPosition=v.position,this.lastEventWorldPosition=v.cameraPosition,this._playerHeight=v.playerHeight},e.prototype.rotationChanged=function(v){this.lastEventRotation=v.quaternion},e.prototype.cameraModeChanged=function(v){this._cameraMode=v.cameraMode},e}();!function(v){v.HitFirst="rqhf",v.HitAll="rqha"}(qn||(qn={}));var Xn,Qn=function(){function t(){this.queries={}}return Object.defineProperty(t,"instance",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.getRayFromCamera=function(v){var C=Wn.instance.rotation,T=_t.Matrix.Identity();C.toRotationMatrix(T);var S=_t.Vector3.TransformCoordinates(_t.Vector3.Forward(),T);return{origin:Wn.instance.position,direction:S,distance:v}},t.prototype.getRayFromPositions=function(v,C){var T=C.subtract(v),S=T.length();return{origin:v,direction:T.normalize(),distance:S}},t.prototype.hitFirst=function(v,C,T){var S="number"==typeof T?qn.HitFirst+T:m();this.queries[S]=C,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:S,queryType:"HitFirst",ray:v})},t.prototype.hitAll=function(v,C,T){var S="number"==typeof T?qn.HitAll+T:m();this.queries[S]=C,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:S,queryType:"HitAll",ray:v})},t.prototype.hitFirstAvatar=function(v,C){c("not implemented yet")},t.prototype.hitAllAvatars=function(v,C){c("not implemented yet")},t.prototype.handleRaycastHitFirstResponse=function(v){this.queries[v.payload.queryId](v.payload.payload),delete this.queries[v.payload.queryId]},t.prototype.handleRaycastHitAllResponse=function(v){this.queries[v.payload.queryId](v.payload.payload),delete this.queries[v.payload.queryId]},t}(),Yn=function(){function t(){}return t.prototype.activate=function(v){v.eventManager.addListener(st,this,(function(v){"HitFirst"===v.payload.queryType?Qn.instance.handleRaycastHitFirstResponse(v):"HitAll"===v.payload.queryType&&Qn.instance.handleRaycastHitAllResponse(v)})),"undefined"!=typeof dcl&&dcl.subscribe("raycastResponse")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("raycastResponse")},t}(),Zn=function(){function t(){}return t.prototype.activate=function(v){v.eventManager.addListener(at,this,(function(v){dn.instance.handlePointerEvent(v.payload)})),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("actionButtonEvent"))},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("actionButtonEvent"))},t}(),Jn=function(){function t(){this.handlerMap={}}return t.prototype.activate=function(v){v.eventManager.addListener(rt,this,this.handleEvent),v.eventManager.addListener(O,this,this.componentAdded),v.eventManager.addListener(R,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")},t.prototype.onAddEntity=function(v){for(var C in v.components){var T=v.components[C];T instanceof Dn&&(this.handlerMap[T.uuid]=T)}},t.prototype.onRemoveEntity=function(v){for(var C in v.components){var T=v.components[C];T instanceof Dn&&delete this.handlerMap[T.uuid]}},t.prototype.componentAdded=function(v){if(v.entity.isAddedToEngine()){var C=v.entity.components[v.componentName];C instanceof Dn&&(this.handlerMap[C.uuid]=C)}},t.prototype.componentRemoved=function(v){v.entity.isAddedToEngine()&&v.component instanceof Dn&&delete this.handlerMap[v.component.uuid]},t.prototype.handleEvent=function(v){if(v.uuid in this.handlerMap){var C=this.handlerMap[v.uuid];C&&C.callback&&"call"in C.callback&&C.callback(v.payload)}},t}(),Kn=new Yn,$n=new Zn,ti=new Jn,ei=function(C){function n(v){var T=C.call(this)||this;return T.loop=!1,T.volume=1,T.url=v,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"url",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([X.field,s("design:type",String)],n.prototype,"loadingCompleteEventId",void 0),r([X.field,s("design:type",Number)],n.prototype,"volume",void 0),r([N("engine.AudioClip",v.CLASS_ID.AUDIO_CLIP),s("design:paramtypes",[String])],n)}(X),ni=function(C){function n(v){var T=C.call(this)||this;if(T.audioClip=v,T.loop=!1,T.volume=1,T.playing=!1,T.pitch=1,T.playedAtTimestamp=Date.now(),!(v instanceof ei))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");return T.audioClipId=D(v),T}return i(n,C),n.prototype.playOnce=function(){return this.playing=!0,this.dirty=!0,this.playedAtTimestamp=Date.now(),this.data.nonce=Math.random(),this},r([X.readonly,s("design:type",String)],n.prototype,"audioClipId",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([X.field,s("design:type",Number)],n.prototype,"volume",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([X.field,s("design:type",Number)],n.prototype,"pitch",void 0),r([X.field,s("design:type",Number)],n.prototype,"playedAtTimestamp",void 0),r([P("engine.AudioSource",v.CLASS_ID.AUDIO_SOURCE),s("design:paramtypes",[ei])],n)}(X),ii=function(C){function n(v){var T=C.call(this)||this;return T.playing=!1,T.volume=1,T.url=v,T.playing=!0,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"url",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([X.field,s("design:type",Number)],n.prototype,"volume",void 0),r([P("engine.AudioStream",v.CLASS_ID.AUDIO_STREAM),s("design:paramtypes",[String])],n)}(X);v.Gizmo=void 0,(Xn=v.Gizmo||(v.Gizmo={})).MOVE="MOVE",Xn.ROTATE="ROTATE",Xn.SCALE="SCALE",Xn.NONE="NONE";var oi,ri=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.type="gizmoEvent",v}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.gizmoEvent",v.CLASS_ID.UUID_CALLBACK)],n)}(Dn),si=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.position=!0,v.rotation=!0,v.scale=!0,v.cycle=!0,v.localReference=!1,v}return i(n,C),r([X.field,s("design:type",Boolean)],n.prototype,"position",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"rotation",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"scale",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"cycle",void 0),r([X.field,s("design:type",String)],n.prototype,"selectedGizmo",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"localReference",void 0),r([P("engine.gizmos",v.CLASS_ID.GIZMOS)],n)}(X),ai=function(C){function n(v){var T=C.call(this,v)||this;return T.type="onFocus",ti.handlerMap[T.uuid]=T,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onFocus",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),ci=function(C){function n(v){var T=C.call(this,v)||this;return T.type="onTextSubmit",ti.handlerMap[T.uuid]=T,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onTextSubmit",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),li=function(C){function n(v){var T=C.call(this,v)||this;return T.type="onBlur",ti.handlerMap[T.uuid]=T,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onBlur",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),di=function(C){function n(v){var T=C.call(this,v)||this;return T.type="onEnter",ti.handlerMap[T.uuid]=T,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onEnter",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),hi=function(C){function n(v){var T=C.call(this,v)||this;return T.type="onChange",ti.handlerMap[T.uuid]=T,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onChange",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Dn),ui=function(C){function n(v,T){var S=C.call(this,v)||this;return S.type="onClick",ti.handlerMap[S.uuid]=S,T&&(S.showFeedback=!(!1===T.showFeedback),T.button&&(S.button=T.button),T.hoverText&&(S.hoverText=T.hoverText),T.distance&&(S.distance=T.distance)),S}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onClick",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Ln),pi=function(C){function n(v,T){var S=C.call(this,v)||this;return S.type="pointerDown",ti.handlerMap[S.uuid]=S,T&&(S.showFeedback=!(!1===T.showFeedback),T.button&&(S.button=T.button),T.hoverText&&(S.hoverText=T.hoverText),T.distance&&(S.distance=T.distance)),S}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerDown",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Ln),mi=function(C){function n(v,T){var S=C.call(this,v)||this;return S.type="pointerUp",ti.handlerMap[S.uuid]=S,T&&(S.showFeedback=!(!1===T.showFeedback),T.button&&(S.button=T.button),T.hoverText&&(S.hoverText=T.hoverText),T.distance&&(S.distance=T.distance)),S}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerUp",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Ln),fi=function(C){function n(v,T){var S=C.call(this,v)||this;return S.type="pointerHoverEnter",ti.handlerMap[S.uuid]=S,T&&T.distance&&(S.distance=T.distance),S}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerHoverEnter",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Ln),yi=function(C){function n(v){var T=C.call(this,v)||this;return T.type="pointerHoverExit",ti.handlerMap[T.uuid]=T,T.distance=160,T}return i(n,C),r([X.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerHoverExit",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Ln),gi=function(v){function e(C){var T=v.call(this)||this;return T.name=null,T.visible=!0,T.opacity=1,T.hAlign="center",T.vAlign="center",T.width="100px",T.height="50px",T.positionX="0px",T.positionY="0px",T.isPointerBlocker=!0,C&&(T._parent=C,T.data.parentComponent=D(C)),T}return i(e,v),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentComponent",{get:function(){return this.data.parentComponent},enumerable:!1,configurable:!0}),r([X.field,s("design:type",Object)],e.prototype,"name",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"visible",void 0),r([X.field,s("design:type",Number)],e.prototype,"opacity",void 0),r([X.field,s("design:type",String)],e.prototype,"hAlign",void 0),r([X.field,s("design:type",String)],e.prototype,"vAlign",void 0),r([X.uiValue,s("design:type",Object)],e.prototype,"width",void 0),r([X.uiValue,s("design:type",Object)],e.prototype,"height",void 0),r([X.uiValue,s("design:type",Object)],e.prototype,"positionX",void 0),r([X.uiValue,s("design:type",Object)],e.prototype,"positionY",void 0),r([X.field,s("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),e}(X),vi=function(C){function n(){return C.call(this,null)||this}return i(n,C),r([N("engine.shape",v.CLASS_ID.UI_FULLSCREEN_SHAPE),s("design:paramtypes",[])],n)}(gi),wi=function(C){function n(){return C.call(this,null)||this}return i(n,C),r([N("engine.shape",v.CLASS_ID.UI_WORLD_SPACE_SHAPE),s("design:paramtypes",[])],n)}(gi),Ci=function(C){function n(){return C.call(this,null)||this}return i(n,C),r([N("engine.shape",v.CLASS_ID.UI_SCREEN_SPACE_SHAPE),s("design:paramtypes",[])],n)}(gi),bi=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.thickness=0,v.color=_t.Color4.Clear(),v.alignmentUsesSize=!0,v}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"thickness",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"alignmentUsesSize",void 0),r([N("engine.shape",v.CLASS_ID.UI_CONTAINER_RECT)],n)}(gi);v.UIStackOrientation=void 0,(oi=v.UIStackOrientation||(v.UIStackOrientation={}))[oi.VERTICAL=0]="VERTICAL",oi[oi.HORIZONTAL=1]="HORIZONTAL";var Ti=function(C){function n(){var T=null!==C&&C.apply(this,arguments)||this;return T.adaptWidth=!0,T.adaptHeight=!0,T.color=_t.Color4.Clear(),T.stackOrientation=v.UIStackOrientation.VERTICAL,T.spacing=0,T}return i(n,C),r([X.field,s("design:type",Boolean)],n.prototype,"adaptWidth",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"adaptHeight",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",Number)],n.prototype,"stackOrientation",void 0),r([X.field,s("design:type",Number)],n.prototype,"spacing",void 0),r([N("engine.shape",v.CLASS_ID.UI_CONTAINER_STACK)],n)}(gi),Si=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.fontSize=10,v.fontWeight="normal",v.thickness=0,v.cornerRadius=0,v.color=_t.Color4.White(),v.background=_t.Color4.White(),v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v.shadowBlur=0,v.shadowOffsetX=0,v.shadowOffsetY=0,v.shadowColor=_t.Color4.Black(),v.text="button",v}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([X.field,s("design:type",String)],n.prototype,"fontWeight",void 0),r([X.field,s("design:type",Number)],n.prototype,"thickness",void 0),r([X.field,s("design:type",Number)],n.prototype,"cornerRadius",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"background",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"shadowColor",void 0),r([X.field,s("design:type",String)],n.prototype,"text",void 0),r([N("engine.shape",v.CLASS_ID.UI_BUTTON_SHAPE)],n)}(gi),Ei=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.outlineWidth=0,v.outlineColor=_t.Color4.White(),v.color=_t.Color4.White(),v.fontSize=10,v.fontAutoSize=!1,v.value="",v.lineSpacing=0,v.lineCount=0,v.adaptWidth=!1,v.adaptHeight=!1,v.textWrapping=!1,v.shadowBlur=0,v.shadowOffsetX=0,v.shadowOffsetY=0,v.shadowColor=_t.Color4.Black(),v.hTextAlign="left",v.vTextAlign="bottom",v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"outlineColor",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"fontAutoSize",void 0),r([X.component,s("design:type",In)],n.prototype,"font",void 0),r([X.field,s("design:type",String)],n.prototype,"value",void 0),r([X.field,s("design:type",Number)],n.prototype,"lineSpacing",void 0),r([X.field,s("design:type",Number)],n.prototype,"lineCount",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"adaptWidth",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"adaptHeight",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"shadowColor",void 0),r([X.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([X.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([N("engine.shape",v.CLASS_ID.UI_TEXT_SHAPE)],n)}(gi),xi=function(C){function n(v){var T=C.call(this,v)||this;return T.outlineWidth=0,T.outlineColor=_t.Color4.Black(),T.color=_t.Color4.Clear(),T.fontSize=10,T.value="",T.placeholder="",T.margin=10,T.hTextAlign="left",T.vTextAlign="bottom",T.focusedBackground=_t.Color4.Black(),T.textWrapping=!1,T.shadowBlur=0,T.shadowOffsetX=0,T.shadowOffsetY=0,T.shadowColor=_t.Color4.White(),T.paddingTop=0,T.paddingRight=0,T.paddingBottom=0,T.paddingLeft=0,T.onTextSubmit=null,T.onChanged=null,T.onFocus=null,T.onBlur=null,T.onTextChanged=new hi((function(v){var C=v.value,S=C.value,E=C.isSubmit,A=T.dirty;if(T.value=S,T.dirty=A,E&&T.onTextSubmit){var R={text:S};T.onTextSubmit.callback(R)}else if(!E&&T.onChanged){var O={value:S,pointerId:v.pointerId};T.onChanged.callback(O)}})),T}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"outlineColor",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"color",void 0),r([X.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([X.component,s("design:type",In)],n.prototype,"font",void 0),r([X.field,s("design:type",String)],n.prototype,"value",void 0),r([X.field,s("design:type",String)],n.prototype,"placeholder",void 0),r([X.field,s("design:type",Number)],n.prototype,"margin",void 0),r([X.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([X.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"focusedBackground",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([X.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"shadowColor",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([Dn.uuidEvent,s("design:type",hi)],n.prototype,"onTextChanged",void 0),r([Dn.uuidEvent,s("design:type",Object)],n.prototype,"onFocus",void 0),r([Dn.uuidEvent,s("design:type",Object)],n.prototype,"onBlur",void 0),r([N("engine.shape",v.CLASS_ID.UI_INPUT_TEXT_SHAPE),s("design:paramtypes",[Object])],n)}(gi),Ai=function(C){function n(v,T){var S=C.call(this,v)||this;return S.sourceLeft=0,S.sourceTop=0,S.sourceWidth=1,S.sourceHeight=1,S.paddingTop=0,S.paddingRight=0,S.paddingBottom=0,S.paddingLeft=0,S.sizeInPixels=!0,S.onClick=null,S.source=T,S}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"sourceLeft",void 0),r([X.field,s("design:type",Number)],n.prototype,"sourceTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"sourceWidth",void 0),r([X.field,s("design:type",Number)],n.prototype,"sourceHeight",void 0),r([X.component,s("design:type",Object)],n.prototype,"source",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"sizeInPixels",void 0),r([Dn.uuidEvent,s("design:type",Object)],n.prototype,"onClick",void 0),r([N("engine.shape",v.CLASS_ID.UI_IMAGE_SHAPE),s("design:paramtypes",[gi,Object])],n)}(gi),_i=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.valueX=0,v.valueY=0,v.backgroundColor=_t.Color4.Clear(),v.isHorizontal=!1,v.isVertical=!1,v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v.onChanged=null,v}return i(n,C),r([X.field,s("design:type",Number)],n.prototype,"valueX",void 0),r([X.field,s("design:type",Number)],n.prototype,"valueY",void 0),r([X.field,s("design:type",_t.Color4)],n.prototype,"backgroundColor",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"isHorizontal",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"isVertical",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([X.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([Dn.uuidEvent,s("design:type",Object)],n.prototype,"onChanged",void 0),r([N("engine.shape",v.CLASS_ID.UI_SLIDER_SHAPE)],n)}(gi),Pi=function(C){function n(){var v=null!==C&&C.apply(this,arguments)||this;return v.useDummyModel=!1,v.talking=!1,v}var T;return i(n,C),T=n,n.Dummy=function(){var v=new T;return v.useDummyModel=!0,v},r([X.field,s("design:type",String)],n.prototype,"id",void 0),r([X.field,s("design:type",String)],n.prototype,"name",void 0),r([X.field,s("design:type",String)],n.prototype,"expressionTriggerId",void 0),r([X.field,s("design:type",Number)],n.prototype,"expressionTriggerTimestamp",void 0),r([X.field,s("design:type",String)],n.prototype,"bodyShape",void 0),r([X.field,s("design:type",Array)],n.prototype,"wearables",void 0),r([X.field,s("design:type",Object)],n.prototype,"skinColor",void 0),r([X.field,s("design:type",Object)],n.prototype,"hairColor",void 0),r([X.field,s("design:type",Object)],n.prototype,"eyeColor",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"useDummyModel",void 0),r([X.field,s("design:type",Boolean)],n.prototype,"talking",void 0),T=r([P("engine.avatarShape",v.CLASS_ID.AVATAR_SHAPE)],n)}(X),Ii=null,Oi=null,Mi=null;function Ri(){return Mi||(Mi=new ot),Mi}var zi=function(){function t(){var v=this;this.messageQueue=[],this.connected=!1,this.flushing=!1,function(){if(!Oi){(Oi=dcl.loadModule("@decentraland/CommunicationsController",{})).then((function(v){Ii=v}));var v=Ri();dcl.subscribe("comms"),dcl.onEvent((function(C){"comms"===C.type&&v.notifyObservers(C.data)}))}return Oi}().then((function(){v.connected=!0,v.flush()}))}return t.prototype.on=function(v,C){return Ri().add((function(T){try{var S=JSON.parse(T.message);S.message===v&&C(S.payload,T.sender)}catch(T){dcl.error("Error parsing comms message "+(T.message||""),T)}}))},t.prototype.sendRaw=function(v){this.messageQueue.push(v),this.connected&&this.flush()},t.prototype.emit=function(v,C){var T=JSON.stringify({message:v,payload:C});this.sendRaw(T),Ri().notifyObservers({message:T,sender:"self"})},t.prototype.flush=function(){var v=this;if(0!==this.messageQueue.length&&this.connected&&Ii&&!this.flushing){var C=this.messageQueue.shift();this.flushing=!0,dcl.callRpc(Ii.rpcHandle,"send",[C]).then((function(C){v.flushing=!1,v.flush()}),(function(C){v.flushing=!1,y("Error flushing MessageBus",C)}))}},t}(),Bi=new Z("scene");Bi.uuid="0";var Ni=new J(Bi);N.engine=Ni,"undefined"!=typeof dcl&&(Ni.addSystem(new xt(dcl),1/0),mt(dcl)),Ni.addSystem(ti),Ni.addSystem($n),Ni.addSystem(Kn),v.AVATAR_OBSERVABLE="AVATAR_OBSERVABLE",v.Angle=_t.Angle,v.AnimationState=rn,v.Animator=Rn,v.Arc2=_t.Arc2,v.AttachToAvatar=fn,v.Attachable=C,v.AudioClip=ei,v.AudioSource=ni,v.AudioStream=ii,v.AvatarModifierArea=un,v.AvatarShape=Pi,v.AvatarTexture=Gn,v.Axis=_t.Axis,v.BasicMaterial=Nn,v.BezierCurve=_t.BezierCurve,v.Billboard=yn,v.BoxShape=vn,v.Camera=Wn,v.CameraModeArea=Hn,v.CircleShape=Cn,v.Color3=_t.Color3,v.Color4=_t.Color4,v.Component=P,v.ComponentAdded=O,v.ComponentGroup=Q,v.ComponentRemoved=R,v.ConeShape=Tn,v.Curve3=_t.Curve3,v.CylinderShape=Sn,v.DEG2RAD=_t.DEG2RAD,v.DisposableComponent=N,v.DisposableComponentCreated=j,v.DisposableComponentRemoved=H,v.DisposableComponentUpdated=W,v.Engine=J,v.Entity=Z,v.Epsilon=_t.Epsilon,v.EventConstructor=x,v.EventManager=E,v.Font=In,v.Frustum=_t.Frustum,v.GLTFShape=En,v.Gizmos=si,v.GlobalPointerDown=cn,v.GlobalPointerUp=ln,v.Input=dn,v.Material=Bn,v.Matrix=_t.Matrix,v.MessageBus=zi,v.MultiObserver=it,v.NFTShape=An,v.OBJShape=Pn,v.Observable=ot,v.ObservableComponent=X,v.Observer=Y,v.ObserverEventState=nt,v.OnAnimationEnd=Fn,v.OnBlur=li,v.OnChanged=hi,v.OnClick=ui,v.OnEnter=di,v.OnFocus=ai,v.OnGizmoEvent=ri,v.OnPointerDown=pi,v.OnPointerHoverEnter=fi,v.OnPointerHoverExit=yi,v.OnPointerLock=kn,v.OnPointerUUIDEvent=Ln,v.OnPointerUp=mi,v.OnTextSubmit=ci,v.OnUUIDEvent=Dn,v.Orientation=_t.Orientation,v.ParentChanged=M,v.Path2=_t.Path2,v.Path3D=_t.Path3D,v.PhysicsCast=Qn,v.Plane=_t.Plane,v.PlaneShape=bn,v.PointerEvent=at,v.PointerEventComponent=Ke,v.PointerEventSystem=Zn,v.Quaternion=_t.Quaternion,v.RAD2DEG=_t.RAD2DEG,v.RaycastEventSystem=Yn,v.RaycastResponse=st,v.Scalar=_t.Scalar,v.Shape=gn,v.Size=_t.Size,v.SmartItem=Vn,v.Space=_t.Space,v.SphereShape=wn,v.Subscription=en,v.TextShape=Mn,v.Texture=_n,v.ToGammaSpace=_t.ToGammaSpace,v.ToLinearSpace=_t.ToLinearSpace,v.Transform=pn,v.UIButton=Si,v.UICanvas=Ci,v.UIContainerRect=bi,v.UIContainerStack=Ti,v.UIFullScreen=vi,v.UIImage=Ai,v.UIInputText=xi,v.UIScrollRect=_i,v.UIShape=gi,v.UIText=Ei,v.UIValue=z,v.UIWorldSpace=wi,v.UUIDEvent=rt,v.UUIDEventSystem=Jn,v.Vector2=_t.Vector2,v.Vector3=_t.Vector3,v.Vector4=_t.Vector4,v.VideoClip=Un,v.VideoTexture=jn,v._initEventObservables=mt,v.buildArray=function(v,C){for(var T=[],S=0;S<v;++S)T.push(C());return T},v.engine=Ni,v.error=y,v.executeTask=G,v.getComponentClassId=L,v.getComponentId=D,v.getComponentName=F,v.getMessageObserver=Ri,v.isDisposableComponent=U,v.log=c,v.newId=f,v.onCameraModeChangedObservable=ct,v.onEnterScene=ht,v.onEnterSceneObservable=dt,v.onIdleStateChangedObservable=lt,v.onLeaveScene=pt,v.onLeaveSceneObservable=ut,v.onPlayerClickedObservable=St,v.onPlayerConnectedObservable=Ct,v.onPlayerDisconnectedObservable=bt,v.onPlayerExpressionObservable=yt,v.onPointerLockedStateChange=gt,v.onProfileChanged=wt,v.onRealmChangedObservable=Tt,v.onSceneReadyObservable=ft,v.onVideoEvent=vt,v.openExternalURL=function(v){"undefined"!=typeof dcl?dcl.openExternalUrl(v):y("ERROR: openExternalURL dcl is undefined")},v.openNFTDialog=function(v,C){if(void 0===C&&(C=null),"undefined"!=typeof dcl){var T=v.match(/ethereum:\/\/(.+)\/(.+)/);if(!T||T.length<3)return;dcl.openNFTDialog(T[1],T[2],C)}else y("ERROR: openNFTDialog dcl is undefined")},v.pointerEventSystem=$n,v.raycastEventSystem=Kn,v.teleportTo=function(v){var C;C=[v],void 0===$&&"undefined"!=typeof dcl&&($=dcl.loadModule("@decentraland/UserActionModule",{})),void 0!==$&&"undefined"!=typeof dcl&&$.then((function(v){dcl.callRpc(v.rpcHandle,"requestTeleport",C)}))},v.uuid=m,v.uuidEventSystem=ti,Object.defineProperty(v,"__esModule",{value:!0})}(this.self=this.self||{}),define("@dcl/ecs-scene-utils",["exports","@decentraland/EnvironmentAPI"],(function(v,C){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var n=function(v,C){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,C){v.__proto__=C}||function(v,C){for(var T in C)Object.prototype.hasOwnProperty.call(C,T)&&(v[T]=C[T])})(v,C)};function i(v,C){function i(){this.constructor=v}n(v,C),v.prototype=null===C?Object.create(C):(i.prototype=C.prototype,new i)}function r(v,C,T,S){var E,A=arguments.length,R=A<3?C:null===S?S=Object.getOwnPropertyDescriptor(C,T):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)R=Reflect.decorate(v,C,T,S);else for(var O=v.length-1;O>=0;O--)(E=v[O])&&(R=(A<3?E(R):A>3?E(C,T,R):E(C,T))||R);return A>3&&R&&Object.defineProperty(C,T,R),R}function o(v,C,T,S){return new(T||(T=Promise))((function(E,A){function a(v){try{u(S.next(v))}catch(v){A(v)}}function s(v){try{u(S.throw(v))}catch(v){A(v)}}function u(v){var C;v.done?E(v.value):(C=v.value,C instanceof T?C:new T((function(v){v(C)}))).then(a,s)}u((S=S.apply(v,C||[])).next())}))}function a(v,C){var T,S,E,A,R={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return A={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function s(A){return function(O){return function(A){if(T)throw new TypeError("Generator is already executing.");for(;R;)try{if(T=1,S&&(E=2&A[0]?S.return:A[0]?S.throw||((E=S.return)&&E.call(S),0):S.next)&&!(E=E.call(S,A[1])).done)return E;switch(S=0,E&&(A=[2&A[0],E.value]),A[0]){case 0:case 1:E=A;break;case 4:return R.label++,{value:A[1],done:!1};case 5:R.label++,S=A[1],A=[0];continue;case 7:A=R.ops.pop(),R.trys.pop();continue;default:if(!((E=(E=R.trys).length>0&&E[E.length-1])||6!==A[0]&&2!==A[0])){R=0;continue}if(3===A[0]&&(!E||A[1]>E[0]&&A[1]<E[3])){R.label=A[1];break}if(6===A[0]&&R.label<E[1]){R.label=E[1],E=A;break}if(E&&R.label<E[2]){R.label=E[2],R.ops.push(A);break}E[2]&&R.ops.pop(),R.trys.pop();continue}A=C.call(v,R)}catch(v){A=[6,v],S=0}finally{T=E=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([A,O])}}}function s(v){var C="function"==typeof Symbol&&Symbol.iterator,T=C&&v[C],S=0;if(T)return T.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&S>=v.length&&(v=void 0),{value:v&&v[S++],done:!v}}};throw new TypeError(C?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,S=function(){function e(){this._components=[],this._componentGroups=[],e._instance=this}return e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.registerCustomComponent=function(v){this.createAndAddToEngine()._components.push(v)},e.prototype.addComponentType=function(v){var C,T;try{for(var S=s(this._components),E=S.next();!E.done;E=S.next())if(v==E.value)return}catch(v){C={error:v}}finally{try{E&&!E.done&&(T=S.return)&&T.call(S)}finally{if(C)throw C.error}}this._components.push(v),this._componentGroups.push(engine.getComponentGroup(v,Transform))},e.prototype.update=function(v){for(var C=0;C<this._components.length;C++)this.updateComponent(v,this._components[C],this._componentGroups[C])},e.prototype.updateComponent=function(v,C,T){T.entities.forEach((function(T){var S=T.getComponent(Transform),E=T.getComponent(C);E.update(v),E.assignValueToTransform(S),E.hasFinished()&&(T.removeComponent(E),null!=E.onFinishCallback&&E.onFinishCallback())}))},e._instance=null,e}();function h(C,T){switch(C){case v.InterpolationType.LINEAR:return T;case v.InterpolationType.EASEINQUAD:return function(v){return v*v}(T);case v.InterpolationType.EASEOUTQUAD:return function(v){return v*(2-v)}(T);case v.InterpolationType.EASEQUAD:return function(v){return v*v/(2*(v*v-v)+1)}(T);case v.InterpolationType.EASEINSINE:return function(v){return 1-Math.cos(v*Math.PI/2)}(T);case v.InterpolationType.EASEOUTSINE:return function(v){return Math.sin(v*Math.PI/2)}(T);case v.InterpolationType.EASESINE:return function(v){return-(Math.cos(Math.PI*v)-1)/2}(T);case v.InterpolationType.EASEINEXPO:return function(v){return 0===v?0:Math.pow(2,10*v-10)}(T);case v.InterpolationType.EASEOUTEXPO:return function(v){return 1===v?1:1-Math.pow(2,-10*v)}(T);case v.InterpolationType.EASEEXPO:return function(v){return 0===v?0:1===v?1:v<.5?Math.pow(2,20*v-10)/2:(2-Math.pow(2,-20*v+10))/2}(T);case v.InterpolationType.EASEINELASTIC:return function(v){var C=2*Math.PI/3;return 0===v?0:1===v?1:-Math.pow(2,10*v-10)*Math.sin((10*v-10.75)*C)}(T);case v.InterpolationType.EASEOUTELASTIC:return function(v){var C=2*Math.PI/3;return 0===v?0:1===v?1:Math.pow(2,-10*v)*Math.sin((10*v-.75)*C)+1}(T);case v.InterpolationType.EASEELASTIC:return function(v){var C=2*Math.PI/4.5;return 0===v?0:1===v?1:v<.5?-Math.pow(2,20*v-10)*Math.sin((20*v-11.125)*C)/2:Math.pow(2,-20*v+10)*Math.sin((20*v-11.125)*C)/2+1}(T);case v.InterpolationType.EASEINBOUNCE:return function(v){return 1-l(1-v)}(T);case v.InterpolationType.EASEOUTEBOUNCE:return function(v){return l(v)}(T);case v.InterpolationType.EASEBOUNCE:return function(v){return v<.5?(1-l(1-2*v))/2:(1+l(2*v-1))/2}(T);default:return T}}function l(v){var C=7.5625,T=2.75;return v<1/T?C*v*v:v<2/T?C*(v-=1.5/T)*v+.75:v<2.5/T?C*(v-=2.25/T)*v+.9375:C*(v-=2.625/T)*v+.984375}v.InterpolationType=void 0,(T=v.InterpolationType||(v.InterpolationType={}))[T.LINEAR=0]="LINEAR",T[T.EASEINQUAD=1]="EASEINQUAD",T[T.EASEOUTQUAD=2]="EASEOUTQUAD",T[T.EASEQUAD=3]="EASEQUAD",T.EASEINSINE="easeinsine",T.EASEOUTSINE="easeoutsine",T.EASESINE="easeinoutsine",T.EASEINEXPO="easeinexpo",T.EASEOUTEXPO="easeoutexpo",T.EASEEXPO="easeinoutexpo",T.EASEINELASTIC="easeinelastic",T.EASEOUTELASTIC="easeoutelastic",T.EASEELASTIC="easeinoutelastic",T.EASEINBOUNCE="easeinbounce",T.EASEOUTEBOUNCE="easeoutbounce",T.EASEBOUNCE="easeinoutbounce";var E,A=function(){function t(T,E,A,R,O){void 0===O&&(O=v.InterpolationType.LINEAR),this.start=T,this.end=E,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=R,this.interpolationType=O,0!=A?this.speed=1/A:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),S.createAndAddToEngine().addComponentType(C)}var C;return C=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.start,this.end,this.lerpTime)},C=r([Component("moveTransformComponent")],t)}(),R=function(){function t(T,E,A,R,O){void 0===O&&(O=v.InterpolationType.LINEAR),this.start=T,this.end=E,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=R,this.interpolationType=O,0!=A?this.speed=1/A:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),S.createAndAddToEngine().addComponentType(C)}var C;return C=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.rotation=Quaternion.Slerp(this.start,this.end,this.lerpTime)},C=r([Component("rotateTransformComponent")],t)}(),O=function(){function t(T,E,A,R,O){void 0===O&&(O=v.InterpolationType.LINEAR),this.start=T,this.end=E,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=R,this.interpolationType=O,0!=A?this.speed=1/A:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),S.createAndAddToEngine().addComponentType(C)}var C;return C=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.scale=Vector3.Lerp(this.start,this.end,this.lerpTime)},C=r([Component("scaleTransformComponent")],t)}(),M=function(){function e(C,T,E,A){if(this.speed=[],this.normalizedTime=0,this.currentIndex=0,this.points=C,this.onFinishCallback=E,this.onPointReachedCallback=A,C.length<2)throw new Error("At least 2 points are needed for FollowPathComponent.");if(T>0){for(var R=0,O=[],M=0;M<C.length-1;M++){var z=Vector3.Distance(C[M],C[M+1]);R+=z,O.push(z)}for(M=0;M<O.length;M++)this.speed.push(1/(O[M]/R*T))}else this.normalizedTime=1,this.currentIndex=C.length-2;S.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed[this.currentIndex],0,1),this.normalizedTime>=1&&this.currentIndex<this.points.length-2&&(this.currentIndex++,this.normalizedTime=0,this.onPointReachedCallback&&this.currentIndex<this.points.length-1&&this.onPointReachedCallback(this.points[this.currentIndex],this.points[this.currentIndex+1]))},e.prototype.hasFinished=function(){return this.currentIndex>=this.points.length-2&&this.normalizedTime>=1},e.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.points[this.currentIndex],this.points[this.currentIndex+1],this.normalizedTime)},v=r([Component("followPathComponent")],e)}(),z=function(){function e(C,T,E,A,R,O){if(this.speed=[],this.turnToFaceNext=!1,this.facingNext=!1,this.normalizedTime=0,this.currentIndex=0,this.points=Curve3.CreateCatmullRomSpline(C,E,!!R).getPoints(),this.onFinishCallback=O,this.turnToFaceNext=A||!1,this.points.length<2)throw new Error("At least 2 points are needed for FollowPathComponent.");if(T>0){for(var M=0,z=[],B=0;B<this.points.length-1;B++){var V=Vector3.Distance(this.points[B],this.points[B+1]);M+=V,z.push(V)}for(B=0;B<z.length;B++)this.speed.push(1/(z[B]/M*T))}else this.normalizedTime=1,this.currentIndex=C.length-2;S.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed[this.currentIndex],0,1),this.normalizedTime>=1&&this.currentIndex<this.points.length-2&&(this.currentIndex++,this.normalizedTime=0,1==this.turnToFaceNext&&(this.facingNext=!1))},e.prototype.hasFinished=function(){return this.currentIndex>=this.points.length-2&&this.normalizedTime>=1},e.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.points[this.currentIndex],this.points[this.currentIndex+1],this.normalizedTime),this.facingNext||(this.facingNext=!0,this.currentIndex<this.points.length-1?v.lookAt(this.points[this.currentIndex+1]):v.lookAt(this.points[0]))},v=r([Component("followCurvedPathComponent")],e)}(),B=function(){function e(C,T){this.rotationVelocity=C,this.onFinishCallback=T,this.rotation=Quaternion.Identity,this.finished=!1,S.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.rotation=Quaternion.Slerp(Quaternion.Identity,this.rotationVelocity,v)},e.prototype.hasFinished=function(){return this.finished},e.prototype.assignValueToTransform=function(v){v.rotation=v.rotation.multiply(this.rotation)},e.prototype.stop=function(){this.finished=!0},v=r([Component("keepRotatingComponent")],e)}();v.ToggleState=void 0,(E=v.ToggleState||(v.ToggleState={}))[E.Off=0]="Off",E[E.On=1]="On";var V=function(){function t(C,T){void 0===C&&(C=v.ToggleState.On),this.enabled=!0,this.state=v.ToggleState.Off,this.set(C),T&&this.setCallback(T)}return t.prototype.set=function(v){this.state=v,this.onValueChangedCallback&&this.onValueChangedCallback(v)},t.prototype.toggle=function(){this.enabled&&this.set(1-this.state)},t.prototype.isOn=function(){return this.state==v.ToggleState.On},t.prototype.setCallback=function(v){this.onValueChangedCallback=v},r([Component("toggle")],t)}(),q=function(){function e(){this._components=[],e._instance=this}return e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.registerCustomComponent=function(v){this.createAndAddToEngine()._components.push(v)},e.prototype.addComponentType=function(v){var C,T;try{for(var S=s(this._components),E=S.next();!E.done;E=S.next())if(v==E.value)return}catch(v){C={error:v}}finally{try{E&&!E.done&&(T=S.return)&&T.call(S)}finally{if(C)throw C.error}}this._components.push(v)},e.prototype.update=function(v){var C=this;this._components.forEach((function(T){C.updateComponent(v,T)}))},e.prototype.updateComponent=function(v,C){var T=engine.getEntitiesWithComponent(C);for(var S in T)if(T.hasOwnProperty(S)){var E=T[S],A=E.getComponent(C);A.elapsedTime+=v,A.elapsedTime>=A.targetTime&&A.onTargetTimeReached(E)}},e._instance=null,e}(),j=function(){function e(C,T){var S=this;q.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=C/1e3,this.onTimeReachedCallback=T,this.onTargetTimeReached=function(v){S.onTimeReachedCallback&&S.onTimeReachedCallback(),v.removeComponent(S)}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerDelay")],e)}(),H=function(){function e(C,T){var S=this;q.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=C/1e3,this.onTimeReachedCallback=T,this.onTargetTimeReached=function(v){S.onTimeReachedCallback&&S.onTimeReachedCallback(),v.removeComponent(S),engine.removeEntity(v)}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerExpireIn")],e)}(),W=function(){function e(C,T){var S=this;q.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=C/1e3,this.onTimeReachedCallback=T,this.onTargetTimeReached=function(){S.elapsedTime=0,S.onTimeReachedCallback&&S.onTimeReachedCallback()}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerInterval")],e)}();function I(v,C,T,S,E,A){var R=new Entity;R.addComponent(new Transform(A||{position:new Vector3(0,1.5,0)})),R.setParent(C);var O=new TextShape(v);return O.fontSize=E||3,O.color=S||Color3.Black(),R.addComponent(O),T&&R.addComponent(new Billboard),engine.addEntity(R),R}var X,Q,Z=function(){function e(){this._triggers={},e._instance=this,this._cameraTriggerWrapper=new K(new P(new Vector3(.5,1.8,.5),new Vector3(0,.91,0))),this._componentGroup=engine.getComponentGroup($)}return Object.defineProperty(e,"instance",{get:function(){return this.createAndAddToEngine()},enumerable:!1,configurable:!0}),e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.prototype.setCameraTriggerShape=function(v){this._cameraTriggerWrapper.setShape(v)},e.prototype.update=function(){var v=this,C=this._componentGroup.entities;for(var T in C.forEach((function(C){v.shouldWrapTriggerEntity(C)&&v.wrapTriggerEntity(C)})),this._triggers)if(this._triggers.hasOwnProperty(T)){var S=this._triggers[T];S.isDebugging()&&S.updateDebugEntity(),S.isInEngine()?null!=S.trigger&&S.trigger.enabled?(S.wasEnabled||S.isDebugging()&&S.addDebugEntity(),S.wasEnabled=!0,(S.trigger.onCameraEnter||S.trigger.onCameraExit)&&this.checkCollisionAgainstCamera(S),(S.trigger.onTriggerEnter||S.trigger.onTriggerExit)&&this.checkCollisionAgainstOtherTriggers(S)):S.wasEnabled&&(S.wasEnabled=!1,S.isDebugging()&&S.removeDebugEntity(),e.removeTriggerFromSystem(S)):(S.isDebugging()&&S.removeDebugEntity(),e.removeTriggerFromSystem(S),delete this._triggers[T])}},e.prototype.shouldWrapTriggerEntity=function(v){return null==this._triggers[v.uuid]||null==this._triggers[v.uuid]},e.prototype.wrapTriggerEntity=function(v){this._triggers[v.uuid]=new J(v)},e.removeTriggerFromSystem=function(v){for(var C,T=v.getActiveCollisions(),S=0;S<T.length;S++)!(T[S]===(null===(C=e._instance)||void 0===C?void 0:C._cameraTriggerWrapper)||null==T[S].trigger)&&T[S].trigger.onTriggerExit&&v.entity&&T[S].trigger.onTriggerExit(v.entity),T[S].disengageActiveCollision(v),v.disengageActiveCollision(T[S])},e.disengageCollision=function(v,C){v.disengageActiveCollision(C),C.disengageActiveCollision(v),v.trigger.onTriggerExit&&C.entity&&v.trigger.onTriggerExit(C.entity),C.trigger.onTriggerExit&&v.entity&&C.trigger.onTriggerExit(v.entity)},e.engageCollision=function(v,C){v.engageCollision(C),C.engageCollision(v),v.trigger.onTriggerEnter&&C.entity&&v.trigger.onTriggerEnter(C.entity),C.trigger.onTriggerEnter&&v.entity&&C.trigger.onTriggerEnter(v.entity)},e.prototype.checkCollisionAgainstCamera=function(v){var C=v.hasActiveCollision(this._cameraTriggerWrapper),T=e.areColliding(v,this._cameraTriggerWrapper);C&&!T?(v.disengageActiveCollision(this._cameraTriggerWrapper),v.trigger.onCameraExit&&v.trigger.onCameraExit()):!C&&T&&(v.engageCollision(this._cameraTriggerWrapper),v.trigger.onCameraEnter&&v.trigger.onCameraEnter())},e.prototype.checkCollisionAgainstOtherTriggers=function(v){for(var C in this._triggers)if(this._triggers.hasOwnProperty(C)&&C!=v.uuid&&this._triggers[C].trigger.enabled&&e.canTriggersCollide(v,this._triggers[C])){var T=v.hasActiveCollision(this._triggers[C]),S=e.areColliding(v,this._triggers[C]);T&&!S?e.disengageCollision(v,this._triggers[C]):!T&&S&&e.engageCollision(v,this._triggers[C])}},e.canTriggersCollide=function(v,C){return 0==v.trigger.triggeredByLayer||0!=(C.trigger.layer&v.trigger.triggeredByLayer)},e.areColliding=function(v,C){return v.getShape()instanceof P&&C.getShape()instanceof P?e.areCollidingAABB(v.getGlobalPosition(),v.getShape(),C.getGlobalPosition(),C.getShape()):v.getShape()instanceof k&&C.getShape()instanceof k?e.areCollidingSphere(v.getGlobalPosition(),v.getShape(),C.getGlobalPosition(),C.getShape()):v.getShape()instanceof P&&C.getShape()instanceof k?e.areCollidingAABBSphere(v.getGlobalPosition(),v.getShape(),C.getGlobalPosition(),C.getShape()):v.getShape()instanceof k&&C.getShape()instanceof P&&e.areCollidingAABBSphere(C.getGlobalPosition(),C.getShape(),v.getGlobalPosition(),v.getShape())},e.areCollidingAABB=function(v,C,T,S){var E=e.getBoxShapeValues(v,C),A=e.getBoxShapeValues(T,S);return E.min.x<=A.max.x&&E.max.x>=A.min.x&&E.min.y<=A.max.y&&E.max.y>=A.min.y&&E.min.z<=A.max.z&&E.max.z>=A.min.z},e.areCollidingSphere=function(v,C,T,S){return Vector3.DistanceSquared(v.add(C.position),T.add(S.position))<C.radius*C.radius+S.radius*S.radius},e.areCollidingAABBSphere=function(v,C,T,S){var E=e.getBoxShapeValues(v,C),A=T.add(S.position),R=S.radius,O=0;return A.x<E.min.x&&(O+=(E.min.x-A.x)*(E.min.x-A.x)),A.x>E.max.x&&(O+=(A.x-E.max.x)*(A.x-E.max.x)),A.y<E.min.y&&(O+=(E.min.y-A.y)*(E.min.y-A.y)),A.y>E.max.y&&(O+=(A.y-E.max.y)*(A.y-E.max.y)),A.z<E.min.z&&(O+=(E.min.z-A.z)*(E.min.z-A.z)),A.z>E.max.z&&(O+=(A.z-E.max.z)*(A.z-E.max.z)),O<R*R},e.getBoxShapeValues=function(v,C){var T=v.add(C.position);return{center:T,min:T.subtract(C.size.scale(.5)),max:T.add(C.size.scale(.5))}},e._instance=null,e}(),J=function(){function e(v){this.wasEnabled=!0,this._uuid="",this._collidingWith={},this._isDebug=!1,this._debugEntity=null,this._entity=v,v&&(this._trigger=v.getComponent($),this._uuid=v.uuid,this._isDebug=this._trigger.debugEnabled,this._isDebug&&this.addDebugEntity())}return Object.defineProperty(e.prototype,"entity",{get:function(){return this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trigger",{get:function(){return this._trigger},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uuid",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),e.prototype.getGlobalPosition=function(){return this._entity?e.getEntityWorldPosition(this._entity):Vector3.Zero()},e.prototype.getShape=function(){return this._trigger.shape},e.prototype.isInEngine=function(){return null!=this._entity&&this._entity.isAddedToEngine()},e.prototype.getActiveCollisions=function(){var v=[];for(var C in this._collidingWith)this._collidingWith.hasOwnProperty(C)&&v.push(this._collidingWith[C]);return v},e.prototype.hasActiveCollision=function(v){return null!=this._collidingWith[v.uuid]&&null!=this._collidingWith[v.uuid]},e.prototype.disengageActiveCollision=function(v){delete this._collidingWith[v.uuid]},e.prototype.engageCollision=function(v){this._collidingWith[v.uuid]=v},e.prototype.isDebugging=function(){return this._isDebug},e.prototype.addDebugEntity=function(){return o(this,void 0,void 0,(function(){var v,T,S;return a(this,(function(E){switch(E.label){case 0:return[4,!C.isPreviewMode()];case 1:return E.sent()||(e._debugMaterial||(e._debugMaterial=new Material,e._debugMaterial.alphaTest=.5),null==this._debugEntity&&(this._debugEntity=new Entity,v=new Transform,this._debugEntity.addComponent(v),this._debugEntity.addComponent(e._debugMaterial),this.getShape()instanceof P&&((T=new BoxShape).withCollisions=!1,this._debugEntity.addComponent(T),v.scale=this.getShape().size),this.getShape()instanceof k&&((T=new SphereShape).withCollisions=!1,this._debugEntity.addComponent(T),S=this.getShape().radius,v.scale=new Vector3(S,S,S))),engine.addEntity(this._debugEntity)),[2]}}))}))},e.prototype.removeDebugEntity=function(){null!=this._debugEntity&&engine.removeEntity(this._debugEntity)},e.prototype.updateDebugEntity=function(){this._debugEntity&&(this._debugEntity.getComponent(Transform).position=this.getGlobalPosition().add(this.getShape().position))},e.getEntityWorldPosition=function(v){var C=v.hasComponent(Transform)?v.getComponent(Transform).position.clone():Vector3.Zero(),T=v.getParent();if(null!=T){var S=T.hasComponent(Transform)?T.getComponent(Transform).rotation:Quaternion.Identity;return this.getEntityWorldPosition(T).add(C.rotate(S))}return C},e._debugMaterial=null,e}(),K=function(v){function t(C){var T=v.call(this)||this;return T._shape=C,T._uuid="cameraTrigger",T}return i(t,v),t.prototype.getGlobalPosition=function(){return Camera.instance.position},t.prototype.getShape=function(){return this._shape},t.prototype.setShape=function(v){this._shape=v},t.prototype.isInEngine=function(){return!1},t.prototype.hasActiveCollision=function(v){return!1},t.prototype.disengageActiveCollision=function(v){},t.prototype.engageCollision=function(v){},t.prototype.isDebugging=function(){return!1},t}(J),$=function(){function e(v,C){this.enabled=!0,this.layer=0,this.triggeredByLayer=0,this._debugEnabled=!1,Z.createAndAddToEngine(),this.shape=v,C&&(C.layer&&(this.layer=C.layer),C.triggeredByLayer&&(this.triggeredByLayer=C.triggeredByLayer),C.onTriggerEnter&&(this.onTriggerEnter=C.onTriggerEnter),C.onTriggerExit&&(this.onTriggerExit=C.onTriggerExit),C.onCameraEnter&&(this.onCameraEnter=C.onCameraEnter),C.onCameraExit&&(this.onCameraExit=C.onCameraExit),C.enableDebug&&(this._debugEnabled=C.enableDebug))}return Object.defineProperty(e.prototype,"debugEnabled",{get:function(){return this._debugEnabled},enumerable:!1,configurable:!0}),r([Component("triggerComponent")],e)}(),P=function(v,C){void 0===v&&(v=Vector3.One().scale(2)),void 0===C&&(C=Vector3.Zero()),this.size=v,this.position=C},k=function(v,C){void 0===v&&(v=2),void 0===C&&(C=Vector3.Zero()),this.radius=v,this.position=C};v.ActionsSequenceSystem=function(){function e(v){this.beginSequenceNode=null,this.currentSequenceNode=null,this.running=!1,this.started=!1,v&&this.startSequence(v)}return e.prototype.startSequence=function(v){this.beginSequenceNode=v.beginSequenceNode,this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1},e.prototype.setOnFinishCallback=function(v){this.onFinishCallback=v},e.prototype.isRunning=function(){return this.running},e.prototype.stop=function(){this.running=!1},e.prototype.resume=function(){null!=this.beginSequenceNode&&(this.running=!0)},e.prototype.reset=function(){this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1},e.prototype.getRunningAction=function(){var v=this.currentSequenceNode;if(this.currentSequenceNode instanceof nt)do{v=v.currentInnerSequence}while(v instanceof nt);return v.action},e.prototype.update=function(v){this.running&&(this.started?this.currentSequenceNode.hasFinish()?(this.currentSequenceNode.onFinish(),this.currentSequenceNode=this.currentSequenceNode.next,this.currentSequenceNode?this.currentSequenceNode.onStart():(this.running=!1,this.onFinishCallback&&this.onFinishCallback())):this.currentSequenceNode.update(v):(this.currentSequenceNode.onStart(),this.started=!0))},e}(),X=v.ActionsSequenceSystem||(v.ActionsSequenceSystem={}),Q=function(){function e(){this.currentSequenceNode=null,this.beginSequenceNode=null,this.whileNodeStack=[]}return e.prototype.then=function(v){if(null==this.currentSequenceNode)this.currentSequenceNode=new et,this.currentSequenceNode.action=v,this.beginSequenceNode=this.currentSequenceNode;else{var C=new et;C.action=v,this.currentSequenceNode=this.currentSequenceNode.then(C)}return this},e.prototype.if=function(v){var C=new it(v);return null==this.currentSequenceNode?(this.currentSequenceNode=C,this.beginSequenceNode=C):this.currentSequenceNode=this.currentSequenceNode.then(C),this},e.prototype.else=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof it))throw new Error("IF statement is needed to be called before ELSE statement.");v.closed=!0;var C=new ot(v);return this.currentSequenceNode=this.currentSequenceNode.then(C),this},e.prototype.endIf=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof it||v instanceof ot))throw new Error("IF statement is needed to be called before ENDIF statement.");return v.closed=!0,this},e.prototype.while=function(v){var C=new rt(v);return null==this.currentSequenceNode?(this.currentSequenceNode=C,this.beginSequenceNode=C):this.currentSequenceNode=this.currentSequenceNode.then(C),this.whileNodeStack.push(C),this},e.prototype.endWhile=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof rt))throw new Error("WHILE statement is needed to be called before ENDWHILE statement.");return v.closed=!0,this.whileNodeStack.length>0&&this.whileNodeStack.splice(this.whileNodeStack.length-1,1),this},e.prototype.breakWhile=function(){if(!(this.whileNodeStack.length>0))throw new Error("WHILE statement is needed to be called before BREAKWHILE statement.");return this.currentSequenceNode=this.currentSequenceNode.then(new st(this.whileNodeStack[this.whileNodeStack.length-1])),this},e}(),X.SequenceBuilder=Q;var et=function(){function e(){this.action=null,this.next=null}return e.prototype.then=function(v){return this.next=v,v},e.prototype.onStart=function(){this.action&&this.action.onStart()},e.prototype.update=function(v){this.action&&this.action.update(v)},e.prototype.onFinish=function(){this.action&&this.action.onFinish()},e.prototype.hasFinish=function(){return!this.action||this.action.hasFinished},e.prototype.getSequence=function(){return this},e}(),nt=function(v){function t(){var C=null!==v&&v.apply(this,arguments)||this;return C.currentInnerSequence=null,C.startingInnerSequence=null,C.closed=!1,C}return i(t,v),t.prototype.then=function(v){if(null==this.currentInnerSequence)this.currentInnerSequence=v,this.startingInnerSequence=v;else{if(this.closed)return this.next=v,v;this.currentInnerSequence=this.currentInnerSequence.then(v)}return this},t.prototype.onStart=function(){this.currentInnerSequence=this.startingInnerSequence,this.currentInnerSequence&&this.currentInnerSequence.onStart()},t.prototype.update=function(v){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(v))},t.prototype.onFinish=function(){this.currentInnerSequence&&this.currentInnerSequence.onFinish()},t.prototype.hasFinish=function(){return null==this.currentInnerSequence},t.prototype.getSequence=function(){if(this.currentInnerSequence){var v=this.currentInnerSequence.getSequence();if(v instanceof t&&!v.closed)return v}return this},t}(et),it=function(v){function t(C){var T=v.call(this)||this;return T.result=!1,T.condition=C,T}return i(t,v),t.prototype.onStart=function(){this.result=this.condition(),this.result?v.prototype.onStart.call(this):this.currentInnerSequence=null},t}(nt),ot=function(v){function t(C){var T=v.call(this)||this;return T.ifSequence=null,T.ifSequence=C,T}return i(t,v),t.prototype.onStart=function(){this.ifSequence&&!this.ifSequence.result?v.prototype.onStart.call(this):this.currentInnerSequence=null},t}(nt),rt=function(v){function t(C){var T=v.call(this)||this;return T.breakWhile=!1,T.condition=C,T}return i(t,v),t.prototype.onStart=function(){this.breakWhile=!1,this.condition()?v.prototype.onStart.call(this):this.currentInnerSequence=null},t.prototype.update=function(v){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,null==this.currentInnerSequence&&(this.currentInnerSequence=this.startingInnerSequence),this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(v))},t.prototype.hasFinish=function(){return this.breakWhile||!this.condition()},t}(nt),st=function(v){function t(C){var T=v.call(this)||this;return T.whileNode=C,T}return i(t,v),t.prototype.onStart=function(){this.whileNode.breakWhile=!0},t}(et);v.Delay=j,v.ExpireIn=H,v.FollowCurvedPathComponent=z,v.FollowPathComponent=M,v.Interpolate=h,v.Interval=W,v.KeepRotatingComponent=B,v.MoveTransformComponent=A,v.RotateTransformComponent=R,v.ScaleTransformComponent=O,v.SequenceNode=et,v.ToggleComponent=V,v.TransformSystem=S,v.TriggerBoxShape=P,v.TriggerComponent=$,v.TriggerSphereShape=k,v.TriggerSystem=Z,v.addLabel=I,v.addOneTimeTrigger=function(v,C,T){var S=!1,E=!1,A=new Entity;A.addComponent(new Transform({}));var R={};return C.layer&&(R.layer=C.layer),C.triggeredByLayer&&(R.triggeredByLayer=C.triggeredByLayer),C.onCameraEnter&&(R.onCameraEnter=function(){S||(S=!0,C.onCameraEnter()),!S&&C.onCameraEnter||!E&&C.onCameraExit||engine.removeEntity(A)}),C.onCameraExit&&(R.onCameraExit=function(){E||(E=!0,C.onCameraExit()),!S&&C.onCameraEnter||!E&&C.onCameraExit||engine.removeEntity(A)}),C.enableDebug&&(R.enableDebug=C.enableDebug),A.addComponent(new $(v,R)),T&&A.setParent(T),engine.addEntity(A),A},v.addTestCube=function(v,T,S,E,A,R,O){return o(this,void 0,void 0,(function(){var M,z,B;return a(this,(function(V){switch(V.label){case 0:return(M=!O)?[4,!C.isPreviewMode()]:[3,2];case 1:M=V.sent(),V.label=2;case 2:return M?[2]:((z=new Entity).addComponent(new Transform(v)),A?(z.addComponent(new SphereShape),z.getComponent(Transform).scale.setAll(.5)):z.addComponent(new BoxShape),engine.addEntity(z),z.addComponent(new OnPointerDown(T,{hoverText:S||"click",button:ActionButton.POINTER})),E&&((B=new Material).albedoColor=E,z.addComponent(B)),R&&(z.getComponent(BoxShape).withCollisions=!1),S&&I(S,z,!0),[2,z])}}))}))},v.clamp=function(v,C,T){var S=v;return v>T?S=T:v<C&&(S=C),S},v.getEntityWorldPosition=function e(v){var C=v.hasComponent(Transform)?v.getComponent(Transform).position.clone():Vector3.Zero(),T=v.getParent();if(null!=T&&"0"!=T.uuid){if("FirstPersonCameraEntityReference"==T.uuid){var S=Camera.instance.rotation.clone();return Camera.instance.position.clone().add(C.rotate(S))}if("AvatarEntityReference"==T.uuid){var E=Camera.instance.rotation;return S=Quaternion.Euler(0,E.eulerAngles.y,0),Camera.instance.position.clone().add(C.rotate(S)).add(new Vector3(0,-.875,0))}return S=T.hasComponent(Transform)?T.getComponent(Transform).rotation:Quaternion.Identity,e(T).add(C.rotate(S))}return C},v.getEntityWorldRotation=function e(v){var C=v.hasComponent(Transform)?v.getComponent(Transform).rotation.clone():Quaternion.Zero(),T=v.getParent();if(null!=T&&"0"!=T.uuid){if("FirstPersonCameraEntityReference"==T.uuid){var S=Camera.instance.rotation.clone();return C.multiply(S)}return"AvatarEntityReference"==T.uuid?(S=Quaternion.Euler(0,Camera.instance.rotation.eulerAngles.y,0),C.multiply(S)):(S=e(T),C.multiply(S))}return C},v.map=function(v,C,T,S,E){return(v-C)/(T-C)*(E-S)+S},v.sendRequest=function(v,C,T,S){return o(this,void 0,void 0,(function(){var E,A,R;return a(this,(function(O){switch(O.label){case 0:return O.trys.push([0,6,,7]),E={method:C||"GET"},T&&(E.headers=T),S&&(E.body=JSON.stringify(S)),[4,fetch(v,E)];case 1:A=O.sent(),O.label=2;case 2:return O.trys.push([2,4,,5]),[4,A.json()];case 3:return[2,O.sent()];case 4:return O.sent(),[2,A];case 5:return[3,7];case 6:return R=O.sent(),log("error fetching from ",v," : ",R),[3,7];case 7:return[2]}}))}))},v.setTimeout=function(v,C){var T=new Entity;return T.addComponent(new j(v,(function(){C(),engine.removeEntity(T)}))),engine.addEntity(T),T},Object.defineProperty(v,"__esModule",{value:!0})})),define("dcl-builder-hud",["exports","@decentraland/EnvironmentAPI"],(function(v,C){function e(v,C,T,S){return new(T||(T=Promise))((function(E,A){function a(v){try{r(S.next(v))}catch(v){A(v)}}function h(v){try{r(S.throw(v))}catch(v){A(v)}}function r(v){var C;v.done?E(v.value):(C=v.value,C instanceof T?C:new T((function(v){v(C)}))).then(a,h)}r((S=S.apply(v,C||[])).next())}))}function n(v,C){var T,S,E,A,R={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return A={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function h(A){return function(O){return function(A){if(T)throw new TypeError("Generator is already executing.");for(;R;)try{if(T=1,S&&(E=2&A[0]?S.return:A[0]?S.throw||((E=S.return)&&E.call(S),0):S.next)&&!(E=E.call(S,A[1])).done)return E;switch(S=0,E&&(A=[2&A[0],E.value]),A[0]){case 0:case 1:E=A;break;case 4:return R.label++,{value:A[1],done:!1};case 5:R.label++,S=A[1],A=[0];continue;case 7:A=R.ops.pop(),R.trys.pop();continue;default:if(!((E=(E=R.trys).length>0&&E[E.length-1])||6!==A[0]&&2!==A[0])){R=0;continue}if(3===A[0]&&(!E||A[1]>E[0]&&A[1]<E[3])){R.label=A[1];break}if(6===A[0]&&R.label<E[1]){R.label=E[1],E=A;break}if(E&&R.label<E[2]){R.label=E[2],R.ops.push(A);break}E[2]&&R.ops.pop(),R.trys.pop();continue}A=C.call(v,R)}catch(v){A=[6,v],S=0}finally{T=E=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([A,O])}}}var T=function(){function t(v,C,T){this.direction=v,this.mode=C,this.pos=T||0}return t=function(v,C,T,S){var E,A=arguments.length,R=A<3?C:null===S?S=Object.getOwnPropertyDescriptor(C,T):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)R=Reflect.decorate(v,C,T,S);else for(var O=v.length-1;O>=0;O--)(E=v[O])&&(R=(A<3?E(R):A>3?E(C,T,R):E(C,T))||R);return A>3&&R&&Object.defineProperty(C,T,R),R}([Component("moving")],t),t}(),S=engine.getComponentGroup(T),E=function(){function t(){this.positions=[]}return t.prototype.addCameraPosition=function(v){this.positions.push(v),log(this.positions)},t.prototype.update=function(){var v,C;try{for(var E=function(v){var C="function"==typeof Symbol&&Symbol.iterator,T=C&&v[C],S=0;if(T)return T.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&S>=v.length&&(v=void 0),{value:v&&v[S++],done:!v}}};throw new TypeError(C?"Object is not iterable.":"Symbol.iterator is not defined.")}(S.entities),A=E.next();!A.done;A=E.next()){var R=A.value,O=R.getComponent(Transform).position,M=R.getComponent(T).direction;switch(R.getComponent(T).mode){case"fixed":var z=R.getComponent(Transform).position.clone(),B=R.getComponent(T).pos;Vector3.Distance(z,this.positions[B])<.05?R.removeComponent(T):R.getComponent(Transform).position=Vector3.Lerp(z,this.positions[B],.04);break;case"free":"up"==M&&O.y<150&&(O.y+=.1),"down"==M&&(O.y>.2?O.y-=.1:R.removeComponent(T)),"forward"==M&&(O.z+=.1),"back"==M&&(O.z>1?O.z-=.1:R.removeComponent(T)),"right"==M&&(O.x+=.1),"left"==M&&(O.x>1?O.x-=.1:R.removeComponent(T))}}}catch(C){v={error:C}}finally{try{A&&!A.done&&(C=E.return)&&C.call(E)}finally{if(v)throw v.error}}},t}(),A=function(){function t(){var v=this;this.isSetup=!1,this.entities=[],this.numEntities=0,this.selectedEntityIndex=-1,this.selectionPointerScale=1,this.selectionPointerElevation=1,this.newEntityScale=.1,this.modePOSITION=0,this.modeROTATION=1,this.modeSCALE=2,this.mode=this.modePOSITION,this.snap=0,this.snapPosScale=1,this.snapRot=90,this.uiMaximized=!1,this.engineEntities=[],this.showingColliders=!1,this.transparent=new Texture("https://lsnft.mypinata.cloud/ipfs/QmaqcRuouE6Tip9acZmjxMyBftEA5aHASRDjn8Bmad87Ld"),this.scaffoldScale=new Vector3(1.2,1,1.2),this.transparentMat=new BasicMaterial,this.transparentMat.alphaTest=1,this.transparentMat.texture=this.transparent,this.scaffolding=new Entity,this.scaffolding.addComponent(new Transform({position:new Vector3(1,.3,1),scale:Vector3.Zero()})),engine.addEntity(this.scaffolding);var T=new Entity;T.addComponent(new Transform({position:new Vector3(-.5,1,-.5),scale:Vector3.One()})),T.setParent(this.scaffolding);var S=new Entity;S.addComponent(new BoxShape),S.addComponent(new Transform({position:new Vector3(2,0,.1),scale:new Vector3(4,.1,.1)})),S.setParent(T),S.getComponent(BoxShape).withCollisions=!1,S.addComponent(new Material),S.getComponent(Material).albedoColor=Color4.Red();var A=new Entity;A.addComponent(new TextShape("X")),A.addComponent(new Transform({position:new Vector3(3,.5,.4)})),A.addComponent(new Billboard(!1,!0,!1)),A.setParent(T);var R=new Entity;R.addComponent(new BoxShape),R.addComponent(new Transform({position:new Vector3(.1,2,.1),scale:new Vector3(.1,4,.1)})),R.setParent(T),R.getComponent(BoxShape).withCollisions=!1,R.addComponent(new Material),R.getComponent(Material).albedoColor=Color4.Green();var M=new Entity;M.addComponent(new TextShape("Y")),M.addComponent(new Transform({position:new Vector3(.5,3,.5)})),M.addComponent(new Billboard(!1,!0,!1)),M.setParent(T);var z=new Entity;z.addComponent(new BoxShape),z.addComponent(new Transform({position:new Vector3(.1,0,2),scale:new Vector3(.1,.1,4)})),z.setParent(T),z.addComponent(new Material),z.getComponent(BoxShape).withCollisions=!1,z.getComponent(Material).albedoColor=Color4.Blue();var B=new Entity;B.addComponent(new TextShape("Z")),B.addComponent(new Transform({position:new Vector3(.4,1,4)})),B.addComponent(new Billboard(!1,!0,!1)),B.setParent(T),this.scaffloor=new Entity,this.scaffloor.addComponent(new PlaneShape),this.scaffloor.addComponent(new Transform({position:new Vector3(0,0,0),rotation:Quaternion.Euler(90,0,0),scale:Vector3.One()})),this.scaffloor.addComponent(new Material),engine.addEntity(this.scaffloor),this.scaffloor.setParent(this.scaffolding),this.leftWall=new Entity,this.leftWall.addComponent(new PlaneShape),this.leftWall.addComponent(new Transform({position:new Vector3(0,-4.5,.6),rotation:Quaternion.Euler(0,180,0),scale:Vector3.Zero()})),this.leftWall.addComponent(this.transparentMat),this.leftWall.setParent(this.scaffolding),this.rightWall=new Entity,this.rightWall.addComponent(new PlaneShape),this.rightWall.addComponent(new Transform({position:new Vector3(0,-4.5,-.6),rotation:Quaternion.Euler(0,180,0),scale:Vector3.Zero()})),this.rightWall.addComponent(this.transparentMat),this.rightWall.setParent(this.scaffolding),this.frontWall=new Entity,this.frontWall.addComponent(new PlaneShape),this.frontWall.addComponent(new Transform({position:new Vector3(.6,-4.5,0),rotation:Quaternion.Euler(0,270,0),scale:Vector3.Zero()})),this.frontWall.addComponent(this.transparentMat),this.frontWall.setParent(this.scaffolding),this.backWall=new Entity,this.backWall.addComponent(new PlaneShape),this.backWall.addComponent(new Transform({position:new Vector3(-.6,-4.5,0),rotation:Quaternion.Euler(0,270,0),scale:Vector3.One()})),this.backWall.addComponent(this.transparentMat),this.backWall.setParent(this.scaffolding),this.selectionPointer=new Entity,this.selectionPointer.addComponent(new PlaneShape),this.selectionPointer.getComponent(PlaneShape).withCollisions=!1,this.selectionPointer.addComponent(new BasicMaterial),this.selectionPointer.getComponent(BasicMaterial).texture=new Texture("https://lsnft.mypinata.cloud/ipfs/QmWbKQtJjsLjgDFinoH6fvmbUoetLZd7LanChC1R4QkA2e"),this.selectionPointer.addComponent(new Transform({rotation:Quaternion.Euler(0,0,180),scale:Vector3.One()})),this.selectionPointer.addComponent(new Billboard(!1,!0,!1)),this.setupUI(),executeTask((function(){return e(v,void 0,void 0,(function(){return n(this,(function(v){switch(v.label){case 0:return[4,C.isPreviewMode()];case 1:return v.sent()?(log("in preview mode"),O.uiMinimizedContainer.visible=!0):(log("not in preview mode"),O.uiMinimizedContainer.visible=!1,O.uiMaximizedContainer.visible=!1,engine.removeEntity(this.selectionPointer)),[2]}}))}))})),this.unsavedContainer=new UIContainerRect(this.uiMaximizedContainer),this.unsavedContainer.hAlign="center",this.unsavedContainer.vAlign="center",this.unsavedContainer.width=160,this.unsavedContainer.height=20,this.unsavedContainer.positionY=225,this.unsavedContainer.positionX=0,this.unsavedContainer.color=Color4.Red(),this.unsavedContainer.visible=!1;var V=new UIText(this.unsavedContainer);V.hAlign="center",V.vAlign="center",V.positionY=0,V.positionX=0,V.height=10,V.fontSize=12,V.hTextAlign="center",V.value="** Unsaved Changes **",this.movingSystem=new E,engine.addSystem(this.movingSystem)}return t.prototype.setDefaultParent=function(v){this.defaultParent=v},t.prototype.setupUI=function(){return e(this,void 0,void 0,(function(){var v,C,T,S,E=this;return n(this,(function(A){return this.isSetup=!0,v=new Texture("https://lsnft.mypinata.cloud/ipfs/QmYyDWc67svskJWxQrZNJxjwNsvsXyG9dvVzXvJtYtmgAr"),this.canvas=new UICanvas,this.canvas.hAlign="center",this.canvas.vAlign="bottom",this.uiMinimizedContainer=new UIContainerRect(this.canvas),this.uiMinimizedContainer.hAlign="right",this.uiMinimizedContainer.vAlign="bottom",this.uiMinimizedContainer.width=70,this.uiMinimizedContainer.height=80,this.uiMinimizedContainer.positionY=100,this.uiMinimizedContainer.positionX=0,this.uiMinimizedContainer.color=new Color4(0,0,0,0),this.uiMinimizedContainer.visible=!1,this.maximizeButton=new UIImage(this.uiMinimizedContainer,v),this.maximizeButton.sourceLeft=826,this.maximizeButton.sourceTop=544,this.maximizeButton.sourceWidth=74,this.maximizeButton.sourceHeight=74,this.maximizeButton.hAlign="right",this.maximizeButton.vAlign="bottom",this.maximizeButton.positionX=-15,this.maximizeButton.positionY=30,this.maximizeButton.width=40,this.maximizeButton.height=40,this.maximizeButton.isPointerBlocker=!0,this.maximizeButton.onClick=new OnClick((function(){E.maximizeUI()})),this.uiMaximizedContainer=new UIContainerRect(this.canvas),this.uiMaximizedContainer.hAlign="right",this.uiMaximizedContainer.vAlign="bottom",this.uiMaximizedContainer.width=160,this.uiMaximizedContainer.height=430,this.uiMaximizedContainer.positionX=0,this.uiMaximizedContainer.positionY=100,this.uiMaximizedContainer.color=new Color4(0,0,0,.75),(C=new UIImage(this.uiMaximizedContainer,v)).sourceLeft=826,C.sourceTop=184,C.sourceWidth=74,C.sourceHeight=74,C.hAlign="right",C.vAlign="top",C.positionX=-60,C.positionY=-10,C.width=40,C.height=40,C.isPointerBlocker=!0,C.onClick=new OnClick((function(){E.toggleLift.sourceLeft=503,E.toggleColliders(!0),engine.addSystem(new M(C))})),this.toggleLift=new UIImage(this.uiMaximizedContainer,v),this.toggleLift.sourceLeft=584,this.toggleLift.sourceTop=544,this.toggleLift.sourceWidth=74,this.toggleLift.sourceHeight=74,this.toggleLift.hAlign="right",this.toggleLift.vAlign="top",this.toggleLift.positionX=-15,this.toggleLift.positionY=-10,this.toggleLift.width=40,this.toggleLift.height=40,this.toggleLift.isPointerBlocker=!0,this.toggleLift.onClick=new OnClick((function(){E.toggleColliders(!1),engine.addSystem(new M(E.toggleLift))})),this.toggleCamera=new UIImage(this.uiMaximizedContainer,v),this.toggleCamera.sourceLeft=16,this.toggleCamera.sourceTop=94,this.toggleCamera.sourceWidth=74,this.toggleCamera.sourceHeight=74,this.toggleCamera.hAlign="right",this.toggleCamera.vAlign="top",this.toggleCamera.positionX=-105,this.toggleCamera.positionY=-10,this.toggleCamera.width=40,this.toggleCamera.height=40,this.toggleCamera.isPointerBlocker=!0,this.toggleCamera.onClick=new OnClick((function(){E.toggleCameraOptions(),engine.addSystem(new M(E.toggleCamera))})),this.toggleCamera.visible=!1,this.scaffoldB=new UIImage(this.uiMaximizedContainer,v),this.scaffoldB.sourceLeft=340,this.scaffoldB.sourceTop=544,this.scaffoldB.sourceWidth=74,this.scaffoldB.sourceHeight=74,this.scaffoldB.hAlign="right",this.scaffoldB.vAlign="bottom",this.scaffoldB.positionX=-105,this.scaffoldB.positionY=335,this.scaffoldB.width=40,this.scaffoldB.height=40,this.scaffoldB.isPointerBlocker=!0,this.scaffoldB.onClick=new OnClick((function(){E.moveScaffold("q"),engine.addSystem(new M(E.scaffoldB))})),this.scaffoldU=new UIImage(this.uiMaximizedContainer,v),this.scaffoldU.sourceLeft=178,this.scaffoldU.sourceTop=544,this.scaffoldU.sourceWidth=74,this.scaffoldU.sourceHeight=74,this.scaffoldU.hAlign="right",this.scaffoldU.vAlign="bottom",this.scaffoldU.positionX=-60,this.scaffoldU.positionY=335,this.scaffoldU.width=40,this.scaffoldU.height=40,this.scaffoldU.isPointerBlocker=!0,this.scaffoldU.onClick=new OnClick((function(){E.moveScaffold("w"),engine.addSystem(new M(E.scaffoldU))})),this.scaffoldF=new UIImage(this.uiMaximizedContainer,v),this.scaffoldF.sourceLeft=422,this.scaffoldF.sourceTop=544,this.scaffoldF.sourceWidth=74,this.scaffoldF.sourceHeight=74,this.scaffoldF.hAlign="right",this.scaffoldF.vAlign="bottom",this.scaffoldF.positionX=-15,this.scaffoldF.positionY=335,this.scaffoldF.width=40,this.scaffoldF.height=40,this.scaffoldF.isPointerBlocker=!0,this.scaffoldF.onClick=new OnClick((function(){E.moveScaffold("e"),engine.addSystem(new M(E.scaffoldF))})),this.scaffoldL=new UIImage(this.uiMaximizedContainer,v),this.scaffoldL.sourceLeft=16,this.scaffoldL.sourceTop=544,this.scaffoldL.sourceWidth=74,this.scaffoldL.sourceHeight=74,this.scaffoldL.hAlign="right",this.scaffoldL.vAlign="bottom",this.scaffoldL.positionX=-105,this.scaffoldL.positionY=290,this.scaffoldL.width=40,this.scaffoldL.height=40,this.scaffoldL.isPointerBlocker=!0,this.scaffoldL.onClick=new OnClick((function(){E.moveScaffold("a"),engine.addSystem(new M(E.scaffoldL))})),this.scaffoldD=new UIImage(this.uiMaximizedContainer,v),this.scaffoldD.sourceLeft=259,this.scaffoldD.sourceTop=544,this.scaffoldD.sourceWidth=74,this.scaffoldD.sourceHeight=74,this.scaffoldD.hAlign="right",this.scaffoldD.vAlign="bottom",this.scaffoldD.positionX=-60,this.scaffoldD.positionY=290,this.scaffoldD.width=40,this.scaffoldD.height=40,this.scaffoldD.isPointerBlocker=!0,this.scaffoldD.onClick=new OnClick((function(){E.moveScaffold("s"),engine.addSystem(new M(E.scaffoldD))})),this.scaffoldR=new UIImage(this.uiMaximizedContainer,v),this.scaffoldR.sourceLeft=97,this.scaffoldR.sourceTop=544,this.scaffoldR.sourceWidth=74,this.scaffoldR.sourceHeight=74,this.scaffoldR.hAlign="right",this.scaffoldR.vAlign="bottom",this.scaffoldR.positionX=-15,this.scaffoldR.positionY=290,this.scaffoldR.width=40,this.scaffoldR.height=40,this.scaffoldR.isPointerBlocker=!0,this.scaffoldR.onClick=new OnClick((function(){E.moveScaffold("d"),engine.addSystem(new M(E.scaffoldR))})),this.displayName=new UIText(this.uiMaximizedContainer),this.displayName.hAlign="center",this.displayName.vAlign="top",this.displayName.positionY=-180,this.displayName.positionX=0,this.displayName.height=10,this.displayName.fontSize=12,this.displayName.hTextAlign="center",(T=new UIText(this.uiMaximizedContainer)).hAlign="center",T.vAlign="top",T.positionY=-160,T.positionX=0,T.height=10,T.fontSize=12,T.hTextAlign="center",T.value="Entity Label",this.displayPRS=new UIText(this.uiMaximizedContainer),this.displayPRS.hAlign="center",this.displayPRS.vAlign="top",this.displayPRS.positionY=-200,this.displayPRS.positionX=0,this.displayPRS.height=10,this.displayPRS.fontSize=12,this.displayPRS.hTextAlign="center",this.displayPRS.value="(0,0,0)",this.scaffoldTitle=new UIText(this.uiMaximizedContainer),this.scaffoldTitle.hAlign="center",this.scaffoldTitle.vAlign="top",this.scaffoldTitle.positionY=-25,this.scaffoldTitle.positionX=-45,this.scaffoldTitle.height=10,this.scaffoldTitle.fontSize=8,this.scaffoldTitle.hTextAlign="center",this.scaffoldTitle.value="Scaffold",this.selectPreviousButton=new UIImage(this.uiMaximizedContainer,v),this.selectPreviousButton.sourceLeft=16,this.selectPreviousButton.sourceTop=184,this.selectPreviousButton.sourceWidth=74,this.selectPreviousButton.sourceHeight=74,this.selectPreviousButton.hAlign="right",this.selectPreviousButton.vAlign="bottom",this.selectPreviousButton.positionX=-105,this.selectPreviousButton.positionY=30,this.selectPreviousButton.width=40,this.selectPreviousButton.height=40,this.selectPreviousButton.isPointerBlocker=!0,this.selectPreviousButton.onClick=new OnClick((function(){E.selectPrevious(),engine.addSystem(new M(E.selectPreviousButton))})),this.selectNextButton=new UIImage(this.uiMaximizedContainer,v),this.selectNextButton.sourceLeft=97,this.selectNextButton.sourceTop=184,this.selectNextButton.sourceWidth=74,this.selectNextButton.sourceHeight=74,this.selectNextButton.hAlign="right",this.selectNextButton.vAlign="bottom",this.selectNextButton.positionX=-60,this.selectNextButton.positionY=30,this.selectNextButton.width=40,this.selectNextButton.height=40,this.selectNextButton.isPointerBlocker=!0,this.selectNextButton.onClick=new OnClick((function(){E.selectNext(),engine.addSystem(new M(E.selectNextButton))})),this.saveButton=new UIImage(this.uiMaximizedContainer,v),this.saveButton.sourceLeft=745,this.saveButton.sourceTop=184,this.saveButton.sourceWidth=74,this.saveButton.sourceHeight=74,this.saveButton.hAlign="right",this.saveButton.vAlign="bottom",this.saveButton.positionX=-15,this.saveButton.positionY=75,this.saveButton.width=40,this.saveButton.height=40,this.saveButton.isPointerBlocker=!0,this.saveButton.onClick=new OnClick((function(){E.dump(),engine.addSystem(new M(E.saveButton))})),this.qButton=new UIImage(this.uiMaximizedContainer,v),this.qButton.sourceLeft=340,this.qButton.sourceTop=544,this.qButton.sourceWidth=74,this.qButton.sourceHeight=74,this.qButton.hAlign="right",this.qButton.vAlign="bottom",this.qButton.positionX=-105,this.qButton.positionY=165,this.qButton.width=40,this.qButton.height=40,this.qButton.isPointerBlocker=!0,this.qButton.onClick=new OnClick((function(v){E.adjustTransform("q"),engine.addSystem(new M(E.qButton))})),this.wButton=new UIImage(this.uiMaximizedContainer,v),this.wButton.sourceLeft=178,this.wButton.sourceTop=544,this.wButton.sourceWidth=74,this.wButton.sourceHeight=74,this.wButton.hAlign="right",this.wButton.vAlign="bottom",this.wButton.positionX=-60,this.wButton.positionY=165,this.wButton.width=40,this.wButton.height=40,this.wButton.isPointerBlocker=!0,this.wButton.onClick=new OnClick((function(){E.adjustTransform("w"),engine.addSystem(new M(E.wButton))})),this.eButton=new UIImage(this.uiMaximizedContainer,v),this.eButton.sourceLeft=422,this.eButton.sourceTop=544,this.eButton.sourceWidth=74,this.eButton.sourceHeight=74,this.eButton.hAlign="right",this.eButton.vAlign="bottom",this.eButton.positionX=-15,this.eButton.positionY=165,this.eButton.width=40,this.eButton.height=40,this.eButton.isPointerBlocker=!0,this.eButton.onClick=new OnClick((function(){E.adjustTransform("e"),engine.addSystem(new M(E.eButton))})),this.aButton=new UIImage(this.uiMaximizedContainer,v),this.aButton.sourceLeft=16,this.aButton.sourceTop=544,this.aButton.sourceWidth=74,this.aButton.sourceHeight=74,this.aButton.hAlign="right",this.aButton.vAlign="bottom",this.aButton.positionX=-105,this.aButton.positionY=120,this.aButton.width=40,this.aButton.height=40,this.aButton.isPointerBlocker=!0,this.aButton.onClick=new OnClick((function(){E.adjustTransform("a"),engine.addSystem(new M(E.aButton))})),this.sButton=new UIImage(this.uiMaximizedContainer,v),this.sButton.sourceLeft=259,this.sButton.sourceTop=544,this.sButton.sourceWidth=74,this.sButton.sourceHeight=74,this.sButton.hAlign="right",this.sButton.vAlign="bottom",this.sButton.positionX=-60,this.sButton.positionY=120,this.sButton.width=40,this.sButton.height=40,this.sButton.isPointerBlocker=!0,this.sButton.onClick=new OnClick((function(){E.adjustTransform("s"),engine.addSystem(new M(E.sButton))})),this.dButton=new UIImage(this.uiMaximizedContainer,v),this.dButton.sourceLeft=97,this.dButton.sourceTop=544,this.dButton.sourceWidth=74,this.dButton.sourceHeight=74,this.dButton.hAlign="right",this.dButton.vAlign="bottom",this.dButton.positionX=-15,this.dButton.positionY=120,this.dButton.width=40,this.dButton.height=40,this.dButton.isPointerBlocker=!0,this.dButton.onClick=new OnClick((function(){E.adjustTransform("d"),engine.addSystem(new M(E.dButton))})),this.modeButton=new UIImage(this.uiMaximizedContainer,v),this.modeButton.sourceLeft=259,this.modeButton.sourceTop=94,this.modeButton.sourceWidth=74,this.modeButton.sourceHeight=74,this.modeButton.hAlign="right",this.modeButton.vAlign="bottom",this.modeButton.positionX=-105,this.modeButton.positionY=75,this.modeButton.width=40,this.modeButton.height=40,this.modeButton.isPointerBlocker=!0,this.modeButton.onClick=new OnClick((function(){E.mode+=1,E.mode>E.modeSCALE&&(E.mode=E.modePOSITION),E.snap=0,E.setSnaps(),E.applyModeAndSnapLabels(),engine.addSystem(new M(E.modeButton))})),this.modeLabel=new UIText(this.modeButton),this.modeLabel.color=Color4.White(),this.modeLabel.hAlign="center",this.modeLabel.vAlign="bottom",this.modeLabel.paddingTop=0,this.modeLabel.paddingBottom=12,this.modeLabel.positionX=-30,this.modeLabel.paddingLeft=0,this.modeLabel.fontSize=12,this.modeLabel.fontWeight="bold",this.modeLabel.isPointerBlocker=!1,this.modeLabel.hTextAlign="center",this.snapButton=new UIImage(this.uiMaximizedContainer,v),this.snapButton.sourceLeft=259,this.snapButton.sourceTop=93,this.snapButton.sourceWidth=74,this.snapButton.sourceHeight=74,this.snapButton.hAlign="right",this.snapButton.vAlign="bottom",this.snapButton.positionX=-60,this.snapButton.positionY=75,this.snapButton.width=40,this.snapButton.height=40,this.snapButton.isPointerBlocker=!0,this.snapButton.onClick=new OnClick((function(){E.snap+=1,E.snap>3&&(E.snap=0),E.setSnaps(),E.applyModeAndSnapLabels(),engine.addSystem(new M(E.snapButton))})),this.snapLabel=new UIText(this.snapButton),this.snapLabel.color=Color4.White(),this.snapLabel.hAlign="right",this.snapLabel.vAlign="bottom",this.snapLabel.positionX=-30,this.snapLabel.paddingTop=0,this.snapLabel.paddingBottom=12,this.snapLabel.paddingLeft=0,this.snapLabel.fontSize=12,this.snapLabel.fontWeight="bold",this.snapLabel.hTextAlign="center",this.snapLabel.isPointerBlocker=!1,this.applyModeAndSnapLabels(!0),this.minimizeButton=new UIImage(this.uiMaximizedContainer,v),this.minimizeButton.sourceLeft=908,this.minimizeButton.sourceTop=544,this.minimizeButton.sourceWidth=74,this.minimizeButton.sourceHeight=74,this.minimizeButton.hAlign="right",this.minimizeButton.vAlign="bottom",this.minimizeButton.positionX=-15,this.minimizeButton.positionY=30,this.minimizeButton.width=40,this.minimizeButton.height=40,this.minimizeButton.isPointerBlocker=!0,this.minimizeButton.onClick=new OnClick((function(){E.minimizeUI(),engine.addSystem(new M(E.minimizeButton))})),(S=new UIText(this.uiMaximizedContainer)).value="Builder HUD",S.color=Color4.White(),S.hAlign="center",S.vAlign="bottom",S.paddingTop=0,S.paddingBottom=5,S.paddingLeft=15,S.fontSize=12,S.isPointerBlocker=!1,this.minimizeUI(),[2]}))}))},t.prototype.setSnaps=function(){switch(this.snap){case 0:this.snapPosScale=1,this.snapRot=90;break;case 1:this.snapPosScale=.1,this.snapRot=15;break;case 2:this.snapPosScale=.01,this.snapRot=5;break;case 3:this.snapPosScale=.001,this.snapRot=1}},t.prototype.applyModeAndSnapLabels=function(v){switch(this.mode){case this.modePOSITION:this.modeLabel.value="P";break;case this.modeROTATION:this.modeLabel.value="R";break;case this.modeSCALE:this.modeLabel.value="S";break;default:this.modeLabel.value="ERR"}switch(!v&&this.updateDisplayPRS(),this.snap){case 0:this.mode==this.modeROTATION?this.snapLabel.value="90":this.snapLabel.value="1";break;case 1:this.mode==this.modeROTATION?this.snapLabel.value="15":this.snapLabel.value="0.1";break;case 2:this.mode==this.modeROTATION?this.snapLabel.value="5":this.snapLabel.value="0.01";break;case 3:this.mode==this.modeROTATION?this.snapLabel.value="1":this.snapLabel.value="0.001";break;default:this.snapLabel.value="ERR"}},t.prototype.countDecimals=function(v){return Math.floor(v)===v?0:v.toString().split(".")[1].length||0},t.prototype.updateDisplayPRS=function(){switch(this.mode){case this.modePOSITION:this.displayPRS.value="POS: ("+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).position.x.toFixed(this.countDecimals(this.snapPosScale))+","+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).position.y.toFixed(this.countDecimals(this.snapPosScale))+","+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).position.z.toFixed(this.countDecimals(this.snapPosScale))+")";break;case this.modeROTATION:this.displayPRS.value="ROT: ("+Math.ceil(this.entities[this.selectedEntityIndex].entity.getComponent(Transform).rotation.eulerAngles.x)+","+Math.ceil(this.entities[this.selectedEntityIndex].entity.getComponent(Transform).rotation.eulerAngles.y)+","+Math.ceil(this.entities[this.selectedEntityIndex].entity.getComponent(Transform).rotation.eulerAngles.z)+")";break;case this.modeSCALE:this.displayPRS.value="SCL: ("+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).scale.x.toFixed(this.countDecimals(this.snapPosScale))+","+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).scale.y.toFixed(this.countDecimals(this.snapPosScale))+","+this.entities[this.selectedEntityIndex].entity.getComponent(Transform).scale.z.toFixed(this.countDecimals(this.snapPosScale))+")"}},t.prototype.maximizeUI=function(){this.uiMinimizedContainer.visible=!1,this.uiMaximizedContainer.visible=!0,this.uiMaximized=!0,this.selectedEntityIndex>=0&&this.numEntities>0&&engine.addEntity(this.selectionPointer),this.mode=this.modePOSITION,this.applyModeAndSnapLabels(),this.displayName.value=this.entities[this.selectedEntityIndex].entity.name,this.updateDisplayPRS(),this.scaffolding.getComponent(Transform).scale=this.scaffoldScale},t.prototype.minimizeUI=function(){this.uiMaximizedContainer.visible=!1,this.uiMinimizedContainer.visible=!0,this.uiMaximized=!1,this.selectedEntityIndex>=0&&this.numEntities>0&&engine.removeEntity(this.selectionPointer),this.scaffolding.getComponent(Transform).scale=Vector3.Zero()},t.prototype.showUI=function(){this.canvas.visible=!0,this.canvas.isPointerBlocker=!0},t.prototype.hideUI=function(){this.canvas.visible=!1,this.canvas.isPointerBlocker=!1},t.prototype.updateSelectionPointerPOS=function(v){var C=v.position.clone();this.selectionPointer.getComponent(Transform).position=new Vector3(C.x,C.y+this.selectionPointerElevation,C.z)},t.prototype.selectEntity=function(v){this.selectedEntityIndex=v,null!=this.entities[v].entity&&(this.displayName.value=this.entities[this.selectedEntityIndex].entity.name,this.updateSelectionPointerPOS(this.entities[v].entity.getComponent(Transform)))},t.prototype.selectPrevious=function(){this.selectedEntityIndex>0&&this.selectEntity(this.selectedEntityIndex-1),this.updateDisplayPRS()},t.prototype.selectNext=function(){this.selectedEntityIndex<this.numEntities-1&&this.selectEntity(this.selectedEntityIndex+1),this.updateDisplayPRS()},t.prototype.discardSelected=function(){log("Discard Selected Entity isn't implemented at this time.")},t.prototype.toggleCameraOptions=function(){this.movingSystem.addCameraPosition(new Vector3(8,8,8)),log(this.movingSystem.positions),this.scaffolding.addComponent(new T("","fixed",0))},t.prototype.toggleColliders=function(v){584==this.toggleLift.sourceLeft?(this.toggleLift.sourceLeft=503,this.scaffloor.getComponent(Material).albedoColor=new Color4(.97,.27,.34),this.backWall.getComponent(Transform).scale=this.scaffoldScale,this.backWall.getComponent(Transform).position=new Vector3(-.6,1.5,0),this.frontWall.getComponent(Transform).scale=this.scaffoldScale,this.frontWall.getComponent(Transform).position=new Vector3(.6,1.5,0),this.leftWall.getComponent(Transform).scale=this.scaffoldScale,this.leftWall.getComponent(Transform).position=new Vector3(0,1.5,.6),this.rightWall.getComponent(Transform).scale=this.scaffoldScale,this.rightWall.getComponent(Transform).position=new Vector3(0,1.5,-.6)):(this.toggleLift.sourceLeft=584,this.backWall.getComponent(Transform).scale=Vector3.Zero(),this.frontWall.getComponent(Transform).scale=Vector3.Zero(),this.leftWall.getComponent(Transform).scale=Vector3.Zero(),this.rightWall.getComponent(Transform).scale=Vector3.Zero(),this.rightWall.getComponent(Transform).position=new Vector3(0,-41.5,-.6),this.backWall.getComponent(Transform).position=new Vector3(0,-4.5,-.6),this.frontWall.getComponent(Transform).position=new Vector3(0,-4.5,-.6),this.leftWall.getComponent(Transform).position=new Vector3(0,-4.5,-.6),this.scaffloor.getComponent(Material).albedoColor=Color4.White()),v&&(this.scaffolding.getComponent(Transform).position=new Vector3(1,.3,1))},t.prototype.moveScaffold=function(v){var C=this.scaffolding.getComponent(Transform);if(this.mode===this.modePOSITION)switch(C.position,v){case"a":this.scaffolding.hasComponent(T)?this.scaffolding.removeComponent(T):this.scaffolding.addComponent(new T("left","free"));break;case"s":this.scaffolding.hasComponent(T)?this.scaffolding.removeComponent(T):this.scaffolding.addComponent(new T("down","free"));break;case"d":this.scaffolding.hasComponent(T)?this.scaffolding.removeComponent(T):this.scaffolding.addComponent(new T("right","free"));break;case"q":this.scaffolding.hasComponent(T)?this.scaffolding.removeComponent(T):this.scaffolding.addComponent(new T("back","free"));break;case"w":this.scaffolding.hasComponent(T)?this.scaffolding.removeComponent(T):this.scaffolding.addComponent(new T("up","free"));break;case"e":this.scaffolding.hasComponent(T)?this.scaffolding.removeComponent(T):this.scaffolding.addComponent(new T("forward","free"))}},t.prototype.adjustTransform=function(v){this.unsavedContainer.visible=!0;var C=this.entities[this.selectedEntityIndex].entity.getComponent(Transform);switch(this.mode){case this.modePOSITION:var T=C.position;switch(v){case"a":T.x-=this.snapPosScale;break;case"s":T.y-=this.snapPosScale;break;case"d":T.x+=this.snapPosScale;break;case"q":T.z-=this.snapPosScale;break;case"w":T.y+=this.snapPosScale;break;case"e":T.z+=this.snapPosScale}this.updateSelectionPointerPOS(C);break;case this.modeROTATION:switch(v){case"a":C.rotate(Vector3.Left(),-this.snapRot);break;case"s":C.rotate(Vector3.Up(),this.snapRot);break;case"d":C.rotate(Vector3.Left(),this.snapRot);break;case"q":C.rotate(Vector3.Forward(),-this.snapRot);break;case"w":C.rotate(Vector3.Up(),-this.snapRot);break;case"e":C.rotate(Vector3.Forward(),this.snapRot)}break;case this.modeSCALE:var S=C.scale;switch(v){case"a":S.x-=this.snapPosScale;break;case"s":S.y-=this.snapPosScale;break;case"d":S.x+=this.snapPosScale;break;case"q":S.z-=this.snapPosScale;break;case"w":S.y+=this.snapPosScale;break;case"e":S.z+=this.snapPosScale}}this.updateDisplayPRS()},t.prototype.attachToEntity=function(v,C){return void 0===C&&(C=!0),e(this,void 0,void 0,(function(){return n(this,(function(T){return null==v?log("BuilderHUD attachToEntity called with a null entity"):O.isSetup&&(this.entities[this.numEntities]={entity:v,transform:v.getComponent(Transform),preexisting:C},C?(this.selectedEntityIndex=-1)&&this.selectEntity(0):this.selectEntity(this.numEntities),this.numEntities++),[2]}))}))},t.prototype.newEntity=function(){var v=Camera.instance,C=v.rotation.eulerAngles.y;C>=180?C-=180:C+=180;var T=0,S=0,E=0,A=1,R=1,O=1;if(null!=this.defaultParent){var M=this.defaultParent.getComponent(Transform);T=M.position.x,S=M.position.y,E=M.position.z,M.rotation.eulerAngles.x,M.rotation.eulerAngles.y,M.rotation.eulerAngles.z,A=M.scale.x,R=M.scale.y,O=M.scale.z}var z=new Transform({position:new Vector3((v.position.x-T)/A,(0-S)/R,(v.position.z-E)/O),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(this.newEntityScale/A,this.newEntityScale/R,this.newEntityScale/O)});z.rotate(Vector3.Up(),-C);var B=new Entity;if(B.name="Entity"+this.numEntities,B.addComponent(z),null==this.newEntityShape)try{this.newEntityShape=new GLTFShape("models/xyz/xyzLeftHand.glb")}catch(B){this.newEntityShape=new BoxShape,(new Material).albedoColor=Color3.Green()}B.addComponent(this.newEntityShape),null!=this.defaultParent&&B.setParent(this.defaultParent),engine.addEntity(B),this.attachToEntity(B,!1)},t.prototype.round=function(v){return Math.floor(1e3*(v+49e-5))/1e3},t.prototype.dump=function(){for(var v in this.unsavedContainer.visible=!1,log("--------------- BuilderHUD entities -------------"),this.entities){var C=null==this.entities[v].entity.name?"Existing":""+this.entities[v].entity.name,T=this.entities[v].transform,S=T.position,E=T.rotation.eulerAngles,A=T.scale,R="position: new Vector3("+this.round(S.x)+","+this.round(S.y)+","+this.round(S.z)+"), rotation: Quaternion.Euler("+this.round(E.x)+","+this.round(E.y)+","+this.round(E.z)+"), scale: new Vector3("+this.round(A.x)+","+this.round(A.y)+","+this.round(A.z)+")";log(C+" {"+R+"}")}log("-------------------------------------------------")},t.prototype.destroy=function(){for(var v in this.dump(),this.entities)this.entities[v].preexisting||(this.entities[v].entity.setParent(null),engine.removeEntity(this.entities[v].entity));this.entities=[],this.numEntities=0,this.refreshDisplay()},t.prototype.refreshDisplay=function(){},t}(),R=function(){function t(v){this.timer=4,this.entities=[],this.hud=v}return t.prototype.pendingEntity=function(v){this.entities.push(v)},t.prototype.update=function(v){if(this.timer>0)this.timer-=v;else{this.timer=4;for(var C=0;C<this.entities.length;C++)log("here"),this.hud.attachToEntity(this.entities[C],!0);this.entities=[]}},t}(),O=new A;O.pendingEntityAdd=new R(O),engine.addSystem(O.pendingEntityAdd);var M=function(){function t(v){this.timer=.1,this.uiIMage=v}return t.prototype.update=function(v){this.timer>0?(this.uiIMage.opacity-=.3,this.timer-=v):(this.timer=.1,this.uiIMage.opacity=1,engine.removeSystem(this))},t}();v.hud=O,Object.defineProperty(v,"__esModule",{value:!0})}));var __awaiter=this&&this.__awaiter||function(v,C,T,S){return new(T||(T=Promise))((function(E,A){function fulfilled(v){try{step(S.next(v))}catch(v){A(v)}}function rejected(v){try{step(S.throw(v))}catch(v){A(v)}}function step(v){var C;v.done?E(v.value):(C=v.value,C instanceof T?C:new T((function(v){v(C)}))).then(fulfilled,rejected)}step((S=S.apply(v,C||[])).next())}))},__generator=this&&this.__generator||function(v,C){var T,S,E,A,R={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return A={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function verb(A){return function(O){return function(A){if(T)throw new TypeError("Generator is already executing.");for(;R;)try{if(T=1,S&&(E=2&A[0]?S.return:A[0]?S.throw||((E=S.return)&&E.call(S),0):S.next)&&!(E=E.call(S,A[1])).done)return E;switch(S=0,E&&(A=[2&A[0],E.value]),A[0]){case 0:case 1:E=A;break;case 4:return R.label++,{value:A[1],done:!1};case 5:R.label++,S=A[1],A=[0];continue;case 7:A=R.ops.pop(),R.trys.pop();continue;default:if(!((E=(E=R.trys).length>0&&E[E.length-1])||6!==A[0]&&2!==A[0])){R=0;continue}if(3===A[0]&&(!E||A[1]>E[0]&&A[1]<E[3])){R.label=A[1];break}if(6===A[0]&&R.label<E[1]){R.label=E[1],E=A;break}if(E&&R.label<E[2]){R.label=E[2],R.ops.push(A);break}E[2]&&R.ops.pop(),R.trys.pop();continue}A=C.call(v,R)}catch(v){A=[6,v],S=0}finally{T=E=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([A,O])}}},__extends=this&&this.__extends||function(){var extendStatics=function(v,C){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,C){v.__proto__=C}||function(v,C){for(var T in C)Object.prototype.hasOwnProperty.call(C,T)&&(v[T]=C[T])},extendStatics(v,C)};return function(v,C){if("function"!=typeof C&&null!==C)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function __(){this.constructor=v}extendStatics(v,C),v.prototype=null===C?Object.create(C):(__.prototype=C.prototype,new __)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(v){for(var C,T=1,S=arguments.length;T<S;T++)for(var E in C=arguments[T])Object.prototype.hasOwnProperty.call(C,E)&&(v[E]=C[E]);return v},__assign.apply(this,arguments)},__values=this&&this.__values||function(v){var C="function"==typeof Symbol&&Symbol.iterator,T=C&&v[C],S=0;if(T)return T.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&S>=v.length&&(v=void 0),{value:v&&v[S++],done:!v}}};throw new TypeError(C?"Object is not iterable.":"Symbol.iterator is not defined.")},__decorate=this&&this.__decorate||function(v,C,T,S){var E,A=arguments.length,R=A<3?C:null===S?S=Object.getOwnPropertyDescriptor(C,T):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)R=Reflect.decorate(v,C,T,S);else for(var O=v.length-1;O>=0;O--)(E=v[O])&&(R=(A<3?E(R):A>3?E(C,T,R):E(C,T))||R);return A>3&&R&&Object.defineProperty(C,T,R),R};define("src/danceArea",["require","exports","@dcl/ecs-scene-utils","@decentraland/EnvironmentAPI","@decentraland/RestrictedActions"],(function(v,C,T,S,E){Object.defineProperty(C,"__esModule",{value:!0}),C.DanceSystem=C.danceAreas=void 0,C.danceAreas=[{transform:{position:new Vector3(8,0,-8),scale:new Vector3(15,3,15)},type:"all"}];var A=function(){function DanceSystem(v){var C=this;this.length=11,this.timer=2,this.danceFunction=function(){C.dance()},this.routines=["robot","tik","hammer","tektonik","disco","dab"],this.routine=v}return DanceSystem.prototype.update=function(v){this.timer>0?this.timer-=v:this.dance()},DanceSystem.prototype.dance=function(){if(this.timer=this.length,"all"===this.routine){var v=Math.floor(Math.random()*(this.routine.length-0)+0);(0,E.triggerEmote)({predefined:this.routines[v]})}else(0,E.triggerEmote)({predefined:this.routine})},DanceSystem.prototype.addEvents=function(){Input.instance.subscribe("BUTTON_UP",ActionButton.FORWARD,!1,this.danceFunction),Input.instance.subscribe("BUTTON_UP",ActionButton.BACKWARD,!1,this.danceFunction),Input.instance.subscribe("BUTTON_UP",ActionButton.RIGHT,!1,this.danceFunction),Input.instance.subscribe("BUTTON_UP",ActionButton.LEFT,!1,this.danceFunction)},DanceSystem.prototype.removeEvents=function(){Input.instance.unsubscribe("BUTTON_UP",ActionButton.FORWARD,this.danceFunction),Input.instance.unsubscribe("BUTTON_UP",ActionButton.BACKWARD,this.danceFunction),Input.instance.unsubscribe("BUTTON_UP",ActionButton.RIGHT,this.danceFunction),Input.instance.unsubscribe("BUTTON_UP",ActionButton.LEFT,this.danceFunction)},DanceSystem}();C.DanceSystem=A;var _loop_1=function(v){var E=new Entity("dance-"+v);E.addComponent(new Transform(C.danceAreas[v].transform)),executeTask((function(){return __awaiter(void 0,void 0,void 0,(function(){var v;return __generator(this,(function(C){switch(C.label){case 0:return(v=!1)?[4,(0,S.isPreviewMode)()]:[3,2];case 1:v=C.sent(),C.label=2;case 2:return v&&(E.addComponent(new BoxShape),E.getComponent(BoxShape).withCollisions=!1),[2]}}))}))})),engine.addEntity(E);var R=new A(C.danceAreas[v].type);E.addComponent(new T.TriggerComponent(new T.TriggerBoxShape(new Vector3(E.getComponent(Transform).scale.x,E.getComponent(Transform).scale.y,E.getComponent(Transform).scale.z),new Vector3(0,2.5,0)),{enableDebug:!1,onCameraEnter:function(){engine.addSystem(R),R.addEvents()},onCameraExit:function(){R.removeEvents(),engine.removeSystem(R)}}))};for(var R in C.danceAreas)_loop_1(R)})),define("src/sound",["require","exports"],(function(v,C){Object.defineProperty(C,"__esModule",{value:!0}),C.Sound=void 0;var T=function(v){function Sound(C,T){var S=v.call(this)||this;return engine.addEntity(S),S.addComponent(new AudioSource(C)),S.getComponent(AudioSource).loop=T,S.addComponent(new Transform),S.setParent(Attachable.AVATAR),S}return __extends(Sound,v),Sound.prototype.playOnce=function(){this.getComponent(AudioSource).volume=1,this.getComponent(AudioSource).playOnce()},Sound.prototype.playAudio=function(){this.getComponent(AudioSource).playOnce()},Sound}(Entity);C.Sound=T})),define("src/data",["require","exports","src/sound"],(function(v,C,T){Object.defineProperty(C,"__esModule",{value:!0}),C.blastBird=C.explosionSound=C.YouAreDiamond=C.StormComing=C.RobotQuest=C.PaperHands=C.GodVoice=C.AnnouncerShort=C.Octopus=C.HeavenMade=C.DoYouDare=C.Detective=C.DeadIntro=C.ChoasCocaine=C.ApeShit=void 0,C.ApeShit=new T.Sound(new AudioClip("sounds/ApeShit.mp3"),!1),C.ChoasCocaine=new T.Sound(new AudioClip("sounds/ChaosCocaine.mp3"),!1),C.DeadIntro=new T.Sound(new AudioClip("sounds/DeadIntro.mp3"),!1),C.Detective=new T.Sound(new AudioClip("sounds/Detective.mp3"),!1),C.DoYouDare=new T.Sound(new AudioClip("sounds/DoYouDare.mp3"),!1),C.HeavenMade=new T.Sound(new AudioClip("sounds/HeavenMade.mp3"),!1),C.Octopus=new T.Sound(new AudioClip("sounds/Octopus.mp3"),!1),C.AnnouncerShort=new T.Sound(new AudioClip("sounds/AnnouncerShort.mp3"),!1),C.GodVoice=new T.Sound(new AudioClip("sounds/GodVoice.mp3"),!1),C.PaperHands=new T.Sound(new AudioClip("sounds/PaperHands.mp3"),!1),C.RobotQuest=new T.Sound(new AudioClip("sounds/RobotQuest.mp3"),!1),C.StormComing=new T.Sound(new AudioClip("sounds/StormComing.mp3"),!1),C.YouAreDiamond=new T.Sound(new AudioClip("sounds/YouAreDiamond.mp3"),!1),C.explosionSound=new T.Sound(new AudioClip("sounds/blasterExplosion.mp3"),!1),C.blastBird=new T.Sound(new AudioClip("sounds/blastBlobBird.mp3"),!1)})),define("node_modules/decentraland-builder-scripts/channel",["require","exports"],(function(v,C){Object.defineProperty(C,"__esModule",{value:!0}),C.createChannel=void 0;var T="__request_value__",S="__reply_value__";C.createChannel=function(v,C,E){var A={},R={},O={};return E.on(C.name,(function(v){var C=A[v.actionId];C&&C(v),R={}})),E.on(T,(function(T){if(T.sender!==v&&T.entityName===C.name){var A=T.key,M=O[A];if(M){var z=M(),B={entityName:C.name,key:A,sender:v,value:z};E.emit(S,B)}delete R[A]}})),E.on(S,(function(T){if(T.sender!==v&&T.entityName===C.name){var S=T.key,E=T.value,A=R[S];A&&A(E),delete R[S]}})),{id:v,bus:E,createAction:function(v,T){return{entityName:C.name,actionId:v,values:T}},sendActions:function(C){var T,S;void 0===C&&(C=[]);try{for(var A=__values(C),R=A.next();!R.done;R=A.next()){var O=R.value,M=__assign(__assign({},O),{sender:v});E.emit(M.entityName,M)}}catch(v){T={error:v}}finally{try{R&&!R.done&&(S=A.return)&&S.call(A)}finally{if(T)throw T.error}}},handleAction:function(v,C){A[v]=C},request:function(S,A){R[S]=A;var O={entityName:C.name,key:S,sender:v},M=setInterval((function(){S in R?E.emit(T,O):clearInterval(M)}),5e3)},reply:function(v,C){O[v]=C}}}})),define("node_modules/decentraland-builder-scripts/inventory",["require","exports"],(function(v,C){Object.defineProperty(C,"__esModule",{value:!0}),C.createInventory=void 0,C.createInventory=function(v,C,T){var S=null,E=null,A={};return{add:function(R,O){var M=A[R]||new T((S||(S=new v),E||((E=new C(S)).isPointerBlocker=!1,E.vAlign="bottom",E.hAlign="right",E.stackOrientation=0,E.spacing=0,E.positionY=75,E.positionX=-25),E),O);M.width=128,M.height=128,M.sourceTop=0,M.sourceLeft=0,M.sourceHeight=256,M.sourceWidth=256,M.isPointerBlocker=!1,M.visible=!0,A[R]=M},remove:function(v){var C=A[v];C&&(C.visible=!1,C.height=0,C.width=0)},has:function(v){return v in A&&A[v].visible}}}})),define("src/modules/smoke",["require","exports"],(function(v,C){Object.defineProperty(C,"__esModule",{value:!0}),C.SmokeSystem=C.smokePuffs=C.SmokeVelocity=void 0;var T=function(){function SmokeVelocity(v,C,T){this.x=v,this.y=C,this.z=T}return SmokeVelocity.prototype.set=function(v,C,T){this.x=v,this.y=C,this.z=T},__decorate([Component("smokevelocity")],SmokeVelocity)}();C.SmokeVelocity=T,C.smokePuffs=engine.getComponentGroup(T);var S=function(){function SmokeSystem(){}return SmokeSystem.prototype.update=function(v){var S,E;try{for(var A=__values(C.smokePuffs.entities),R=A.next();!R.done;R=A.next()){var O=R.value,M=O.getComponent(Transform),z=O.getComponent(T);M.position.x+=z.x*v,M.position.y+=z.y*v,M.position.z+=z.z*v;var B=1.0025*M.scale.x;M.scale.setAll(B),z.x*=1,z.z*=1,isOutOfBounds(M)&&engine.removeEntity(O)}}catch(v){S={error:v}}finally{try{R&&!R.done&&(E=A.return)&&E.call(A)}finally{if(S)throw S.error}}},SmokeSystem}();function isOutOfBounds(v){return v.position.y>2.5||v.position.x>1.5||v.position.z>1.5||v.position.x<-1.5||v.position.z<-1.5}C.SmokeSystem=S})),define("src/modules/smokeSource",["require","exports","src/modules/smoke"],(function(v,C,T){Object.defineProperty(C,"__esModule",{value:!0}),C.smokeSpawner=C.ThrowSmoke=C.SmokeSource=void 0;var S=function(){function SmokeSource(v){void 0===v&&(v=10),this.smokeInterval=3,this.nextSmoke=this.smokeInterval,this.smokeInterval=v}return __decorate([Component("smokeSource")],SmokeSource)}();C.SmokeSource=S;var E=engine.getComponentGroup(S),A=function(){function ThrowSmoke(){}return ThrowSmoke.prototype.update=function(v){var T,A;try{for(var R=__values(E.entities),O=R.next();!O.done;O=R.next()){var M=O.value,z=M.getComponent(S);z.nextSmoke-=v,z.nextSmoke<0&&(z.nextSmoke=z.smokeInterval,C.smokeSpawner.SpawnSmokePuff(M))}}catch(v){T={error:v}}finally{try{O&&!O.done&&(A=R.return)&&A.call(R)}finally{if(T)throw T.error}}},ThrowSmoke}();C.ThrowSmoke=A;var R=new Texture("images/smoke-puff2.png",{hasAlpha:!0}),O=new Material;O.albedoTexture=R,O.alphaTexture=R,O.metallic=0,O.roughness=1,O.transparencyMode=0;var M=new PlaneShape;M.withCollisions=!1;var z=new Billboard(!1,!0,!1);C.smokeSpawner={MAX_POOL_SIZE:20,pool:[],getEntityFromPool:function(){for(var v=0;v<C.smokeSpawner.pool.length;v++)if(!C.smokeSpawner.pool[v].alive)return C.smokeSpawner.pool[v];if(C.smokeSpawner.pool.length<C.smokeSpawner.MAX_POOL_SIZE){var T=new Entity;return C.smokeSpawner.pool.push(T),T}return null},SpawnSmokePuff:function(v){var S=C.smokeSpawner.getEntityFromPool();if(S){var E={x:(Math.random()-Math.random())/6,y:Math.random()/2+.1,z:(Math.random()-Math.random())/6},A=Math.random()/2+.2;if(S.addComponentOrReplace(M),S.addComponentOrReplace(O),S.setParent(v),S.getComponentOrNull(Transform))(R=S.getComponent(Transform)).scale.set(A,A,A),R.position.set(0,0,0);else{var R=new Transform;S.addComponentOrReplace(R),R.scale.set(A,A,A),R.position.set(0,0,0)}S.getComponentOrNull(T.SmokeVelocity)?S.getComponent(T.SmokeVelocity).set(E.x,E.y,E.z):S.addComponentOrReplace(new T.SmokeVelocity(E.x,E.y,E.z)),S.hasComponent(Billboard)||S.addComponent(z),engine.addEntity(S)}}}})),define("ff9257ec-9d62-404f-97c7-cf19c4035761/src/item",["require","exports","src/modules/smokeSource","src/modules/smoke"],(function(v,C,T,S){Object.defineProperty(C,"__esModule",{value:!0});var E=function(){function Button(){this.openClip=new AudioClip("ff9257ec-9d62-404f-97c7-cf19c4035761/sounds/open.mp3"),this.closeClip=new AudioClip("ff9257ec-9d62-404f-97c7-cf19c4035761/sounds/close.mp3"),this.active={}}return Button.prototype.init=function(){},Button.prototype.toggle=function(v,C,T){if(void 0===T&&(T=!0),this.active[v.name]!==C){if(T){var S=new AudioSource(C?this.openClip:this.closeClip);v.addComponentOrReplace(S),S.playing=!0}var E=v.getComponent(Animator),A=E.getClip("open"),R=E.getClip("close");A.stop(),R.stop(),(C?A:R).play(),this.active[v.name]=C}},Button.prototype.spawn=function(v,C,E){var A=this,R=new Entity(v.name+"-button");R.setParent(v);var O=new Animator,M=new AnimationState("close",{looping:!1}),z=new AnimationState("open",{looping:!1});O.addClip(M),O.addClip(z),R.addComponent(O),z.stop(),R.addComponent(new GLTFShape("ff9257ec-9d62-404f-97c7-cf19c4035761/models/Chest_Fantasy.glb")),R.addComponent(new T.SmokeSource(.4)),engine.addEntity(R),R.addComponent(new OnPointerDown((function(){E.sendActions(C.onClick),engine.addSystem(new T.ThrowSmoke),engine.addSystem(new S.SmokeSystem)}),{button:ActionButton.POINTER,hoverText:"You've Been Warned",distance:6})),this.active[R.name]=!1,E.handleAction("open",(function(v){var T=v.sender;A.active[R.name]||A.toggle(R,!0),T===E.id&&E.sendActions(C.onOpen)})),E.handleAction("close",(function(v){var T=v.sender;A.active[R.name]&&A.toggle(R,!1),T===E.id&&E.sendActions(C.onClose)})),E.handleAction("toggle",(function(v){var T=v.sender,S=!A.active[R.name];A.toggle(R,S),T===E.id&&E.sendActions(S?C.onOpen:C.onClose)})),E.request("isOpen",(function(v){return A.toggle(R,v,!1)})),E.reply("isOpen",(function(){return A.active[R.name]}))},Button}();C.default=E})),define("src/modules/models",["require","exports","dcl-builder-hud"],(function(v,C,T){Object.defineProperty(C,"__esModule",{value:!0}),C.glowingBird=C.sandShape=C.birdFlyShape=C.birdIdleShape=void 0,C.birdIdleShape=new GLTFShape("models/bird.glb"),C.birdFlyShape=new GLTFShape("models/bird_fly.glb"),C.sandShape=new GLTFShape("models/sand.glb"),C.glowingBird=new GLTFShape("models/birdSplat.glb");var S=new Entity;S.addComponent(new Transform({position:new Vector3(8,-10,0),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(1,1,1)})),S.addComponent(C.birdIdleShape),engine.addEntity(S),T.hud.attachToEntity(S);var E=new Entity;E.addComponent(new Transform({position:new Vector3(8,-10,0),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(1,1,1)})),E.addComponent(C.birdFlyShape),engine.addEntity(E),T.hud.attachToEntity(E);var A=new Entity;A.addComponent(new Transform({position:new Vector3(8,-10,0),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(1,1,1)})),A.addComponent(C.glowingBird),engine.addEntity(A),T.hud.attachToEntity(A)})),define("src/modules/utilities",["require","exports"],(function(v,C){Object.defineProperty(C,"__esModule",{value:!0}),C.realDistance=void 0,C.realDistance=function(v,C){var T=v.x-C.x,S=v.y-C.y,E=v.z-C.z;return Math.sqrt(T*T+S*S+E*E)}})),define("src/poop",["require","exports"],(function(v,C){Object.defineProperty(C,"__esModule",{value:!0}),C.Poop=void 0;var T=function(v){function Poop(C,T){var S=v.call(this)||this;return engine.addEntity(S),S.addComponent(C),S.addComponent(T),S.addComponent(new Animator),S.getComponent(Animator).addClip(new AnimationState("Running",{looping:!0})),S.getComponent(Animator).addClip(new AnimationState("Idle",{looping:!0})),S}return __extends(Poop,v),Poop}(Entity);C.Poop=T})),define("src/game",["require","exports","node_modules/decentraland-builder-scripts/channel","node_modules/decentraland-builder-scripts/inventory","ff9257ec-9d62-404f-97c7-cf19c4035761/src/item","@dcl/ecs-scene-utils","dcl-builder-hud","src/data","src/modules/models","src/modules/utilities","@decentraland/RestrictedActions","src/poop"],(function(v,C,T,S,E,A,R,O,M,z,B,V){Object.defineProperty(C,"__esModule",{value:!0}),C.DistanceBird=C.getEntityByName=C._scene=void 0;var q=new Billboard(!1,!0,!1),j=new GLTFShape("2e1c4446-c99a-4698-9e13-819d232ca849/models/Black_Fantasy_Button.glb"),H=new MessageBus,W=new Entity("_scene");C._scene=W,engine.addEntity(W);var X=new Transform({position:new Vector3(0,0,0),rotation:new Quaternion(0,0,0,1),scale:new Vector3(1,1,1)});W.addComponentOrReplace(X);var Q=new Entity("murpheusnickeditd1");engine.addEntity(Q),Q.setParent(W),Q.hasComponent(Billboard)||Q.addComponent(q);var Z=new Transform({position:new Vector3(8,6.3,4),rotation:new Quaternion(104254907e-22,-1,1.19209261e-7,2220273e-12),scale:new Vector3(1.5,2,1.5)});Q.addComponentOrReplace(Z);var J=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");J.withCollisions=!0,J.isPointerBlocker=!0,J.visible=!0,Q.addComponentOrReplace(J),R.hud.attachToEntity(Q);var K=new Entity("blackbutton3");engine.addEntity(K),K.setParent(W);var $=new Transform({position:new Vector3(2.279,0,10.474),rotation:new Quaternion(0,0,0,1),scale:new Vector3(2,3,2)});K.addComponentOrReplace($),K.addComponent(j),R.hud.attachToEntity(K),K.addComponent(new Animator),K.getComponent(Animator).addClip(new AnimationState("trigger",{looping:!1})),K.addComponent(new OnPointerDown((function(){H.emit("click",{entity:"blackbutton3"}),O.Detective.playOnce()}),{button:ActionButton.POINTER,hoverText:"Detective",distance:6}));var et=new Entity("blackbutton4");engine.addEntity(et),et.setParent(W);var nt=new Transform({position:new Vector3(4.679,0,12.974),rotation:new Quaternion(0,0,0,1),scale:new Vector3(2,3,2)});et.addComponentOrReplace(nt),et.addComponent(j),R.hud.attachToEntity(et),et.addComponent(new Animator),et.getComponent(Animator).addClip(new AnimationState("trigger",{looping:!1})),et.addComponent(new OnPointerDown((function(){H.emit("click",{entity:"blackbutton4"}),O.DeadIntro.playOnce()}),{button:ActionButton.POINTER,hoverText:"Dead Intro",distance:6}));var it=new Entity("blackbutton5");engine.addEntity(it),it.setParent(W);var ot=new Transform({position:new Vector3(11.079,0,13.074),rotation:new Quaternion(0,0,0,1),scale:new Vector3(2,3,2)});it.addComponentOrReplace(ot),it.addComponent(j),R.hud.attachToEntity(it),it.addComponent(new Animator),it.getComponent(Animator).addClip(new AnimationState("trigger",{looping:!1})),it.addComponent(new OnPointerDown((function(){H.emit("click",{entity:"blackbutton5"}),O.YouAreDiamond.playOnce()}),{button:ActionButton.POINTER,hoverText:"Diamond Hands",distance:6}));var rt=new Entity("murpheusnickeditd3");engine.addEntity(rt),rt.setParent(W),rt.hasComponent(Billboard)||rt.addComponent(q);var st=new Transform({position:new Vector3(8,4.6,.5),rotation:new Quaternion(104254907e-22,-1,1.19209261e-7,2220273e-12),scale:new Vector3(.49999994,1,.49999994)});rt.addComponentOrReplace(st);var at=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");at.withCollisions=!0,at.isPointerBlocker=!0,at.visible=!0,rt.addComponentOrReplace(at),R.hud.attachToEntity(rt);var ct=new Entity("murpheustext");engine.addEntity(ct),ct.setParent(W);var lt=new Transform({position:new Vector3(7.8,16.4,15.3),rotation:new Quaternion(0,0,0,1),scale:new Vector3(24.9,23.5,1)});ct.addComponentOrReplace(lt);var dt=new GLTFShape("c935e005-716e-47fe-9df0-b7fe8eaffb7f/Murpheus text.glb");dt.withCollisions=!0,dt.isPointerBlocker=!0,dt.visible=!0,ct.addComponentOrReplace(dt),R.hud.attachToEntity(ct);var ht=new Entity("murpheusnickeditd4");engine.addEntity(ht),ht.setParent(W);var ut=new Transform({position:new Vector3(.3,8.07,8.8),rotation:new Quaternion(174724919e-23,-.707106,8.429359e-8,.7071076),scale:new Vector3(11.690567,12.3055487,1.00000024)});ht.addComponentOrReplace(ut);var pt=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");pt.withCollisions=!0,pt.isPointerBlocker=!0,pt.visible=!0,ht.addComponentOrReplace(pt),R.hud.attachToEntity(ht);var ft=new Entity("blackbutton6");engine.addEntity(ft),ft.setParent(W);var yt=new Transform({position:new Vector3(7.99,0,13.837),rotation:new Quaternion(0,0,0,1),scale:new Vector3(2,3,2)});ft.addComponentOrReplace(yt),ft.addComponent(j),R.hud.attachToEntity(ft),ft.addComponent(new Animator),ft.getComponent(Animator).addClip(new AnimationState("trigger",{looping:!1})),ft.addComponent(new OnPointerDown((function(){H.emit("click",{entity:"blackbutton6"}),O.ChoasCocaine.playOnce()}),{button:ActionButton.POINTER,hoverText:"Chaos",distance:6}));var gt=new Entity("blackbutton7");engine.addEntity(gt),gt.setParent(W);var vt=new Transform({position:new Vector3(3.255,0,3.401),rotation:new Quaternion(0,0,0,1),scale:new Vector3(2,3,2)});gt.addComponentOrReplace(vt),gt.addComponent(j),R.hud.attachToEntity(gt),gt.addComponent(new Animator),gt.getComponent(Animator).addClip(new AnimationState("trigger",{looping:!1})),gt.addComponent(new OnPointerDown((function(){H.emit("click",{entity:"blackbutton7"}),O.PaperHands.playOnce()}),{button:ActionButton.POINTER,hoverText:"Paper Hands",distance:6}));var wt=new Entity("blackbutton8");engine.addEntity(wt),wt.setParent(W);var Ct=new Transform({position:new Vector3(1.861,.089,6.928),rotation:new Quaternion(0,0,0,1),scale:new Vector3(2,3,2)});wt.addComponentOrReplace(Ct),wt.addComponent(j),R.hud.attachToEntity(wt),wt.addComponent(new Animator),wt.getComponent(Animator).addClip(new AnimationState("trigger",{looping:!1})),wt.addComponent(new OnPointerDown((function(){H.emit("click",{entity:"blackbutton8"}),O.StormComing.playOnce()}),{button:ActionButton.POINTER,hoverText:"Category 5",distance:6}));var bt=new Entity("blackbutton9");engine.addEntity(bt),bt.setParent(W);var Tt=new Transform({position:new Vector3(12.051,0,3.141),rotation:new Quaternion(0,0,0,1),scale:new Vector3(2,3,2)});bt.addComponentOrReplace(Tt),bt.addComponent(j),R.hud.attachToEntity(bt),bt.addComponent(new Animator),bt.getComponent(Animator).addClip(new AnimationState("trigger",{looping:!1})),bt.addComponent(new OnPointerDown((function(){H.emit("click",{entity:"blackbutton9"}),O.RobotQuest.playOnce()}),{button:ActionButton.POINTER,hoverText:"Docile Robot",distance:6}));var St=new Entity("blackbutton10");engine.addEntity(St),St.setParent(W);var xt=new Transform({position:new Vector3(13.573,0,10.433),rotation:new Quaternion(0,0,0,1),scale:new Vector3(2,3,2)});St.addComponentOrReplace(xt),St.addComponent(j),R.hud.attachToEntity(St),St.addComponent(new Animator),St.getComponent(Animator).addClip(new AnimationState("trigger",{looping:!1})),St.addComponent(new OnPointerDown((function(){H.emit("click",{entity:"blackbutton10"}),O.HeavenMade.playOnce()}),{button:ActionButton.POINTER,hoverText:"Heaven Made",distance:6}));var At=new Entity("blackbutton11");engine.addEntity(At),At.setParent(W);var _t=new Transform({position:new Vector3(13.865,0,6.252),rotation:new Quaternion(0,0,0,1),scale:new Vector3(2,3,2)});At.addComponentOrReplace(_t),At.addComponent(j),R.hud.attachToEntity(At),At.addComponent(new Animator),At.getComponent(Animator).addClip(new AnimationState("trigger",{looping:!1})),At.addComponent(new OnPointerDown((function(){H.emit("click",{entity:"blackbutton11"}),O.Octopus.playOnce()}),{button:ActionButton.POINTER,hoverText:"Octopus",distance:6}));var Rt=new Entity("irishglowjpegspikes");engine.addEntity(Rt),Rt.setParent(W);var Pt=new Transform({position:new Vector3(8,0,8),rotation:new Quaternion(166893e-11,.707106,.707107663,171363354e-14),scale:new Vector3(14.3,13.4,4)});Rt.addComponentOrReplace(Pt);var It=new GLTFShape("models/Irish glow3D.glb");It.withCollisions=!0,It.isPointerBlocker=!0,It.visible=!0,Rt.addComponentOrReplace(It),R.hud.attachToEntity(Rt);var Ot=new Entity("murpheusnickeditd5");engine.addEntity(Ot),Ot.setParent(W);var zt=new Transform({position:new Vector3(15.59,8.07,8.77),rotation:new Quaternion(355271368e-23,.707106,-8.429359e-8,.707107544),scale:new Vector3(11.6905394,12.31,1)});Ot.addComponentOrReplace(zt);var Bt=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");Bt.withCollisions=!0,Bt.isPointerBlocker=!0,Bt.visible=!0,Ot.addComponentOrReplace(Bt),R.hud.attachToEntity(Ot);var Nt=new Entity("murpheusnickeditd6");engine.addEntity(Nt),Nt.setParent(W),Nt.hasComponent(Billboard)||Nt.addComponent(q);var Lt=new Transform({position:new Vector3(8,5.1,1.5),rotation:new Quaternion(104254907e-22,-1,1.19209261e-7,2220273e-12),scale:new Vector3(.99999994,1.5,.5)});Nt.addComponentOrReplace(Lt);var kt=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");kt.withCollisions=!0,kt.isPointerBlocker=!0,kt.visible=!0,Nt.addComponentOrReplace(kt),R.hud.attachToEntity(Nt);var Ft=new Entity("murpheusnickeditd");engine.addEntity(Ft),Ft.setParent(W),Ft.hasComponent(Billboard)||Ft.addComponent(q);var Vt=new Transform({position:new Vector3(8,7.8,6.5),rotation:new Quaternion(104254907e-22,-1,1.19209261e-7,2220273e-12),scale:new Vector3(2.5,3,1.00000024)});Ft.addComponentOrReplace(Vt);var Ut=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");Ut.withCollisions=!0,Ut.isPointerBlocker=!0,Ut.visible=!0,Ft.addComponentOrReplace(Ut),R.hud.attachToEntity(Ft);var qt=new Entity("murpheusnickeditd2");engine.addEntity(qt),qt.setParent(W);var Ht=new Transform({position:new Vector3(7.93,8,15.8),rotation:new Quaternion(0,0,0,1),scale:new Vector3(12.96,12.3,1)});qt.addComponentOrReplace(Ht);var Gt=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");Gt.withCollisions=!0,Gt.isPointerBlocker=!0,Gt.visible=!0,qt.addComponentOrReplace(Gt),R.hud.attachToEntity(qt);var Wt=new Entity("murpheustext2");engine.addEntity(Wt),Wt.setParent(W);var Qt=new Transform({position:new Vector3(8.3,16.5,15.7),rotation:new Quaternion(-178957835e-22,-1,1.19209261e-7,235438347e-14),scale:new Vector3(24.1,21.5,1)});Wt.addComponentOrReplace(Qt);var Yt=new GLTFShape("c935e005-716e-47fe-9df0-b7fe8eaffb7f/Murpheus text.glb");Yt.withCollisions=!0,Yt.isPointerBlocker=!0,Yt.visible=!0,Wt.addComponentOrReplace(Yt),R.hud.attachToEntity(Wt);var Zt=new Entity("murpheusnickeditd7");engine.addEntity(Zt),Zt.setParent(W);var Jt=new Transform({position:new Vector3(.42,8,9),rotation:new Quaternion(-249791846e-22,.7071124,-8.429433e-8,.7071013),scale:new Vector3(9.999991,11.5,.5000007)});Zt.addComponentOrReplace(Jt);var Kt=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");Kt.withCollisions=!0,Kt.isPointerBlocker=!0,Kt.visible=!0,Zt.addComponentOrReplace(Kt),R.hud.attachToEntity(Zt);var $t=new Entity("murpheusnickeditd8");engine.addEntity($t),$t.setParent(W);var ee=new Transform({position:new Vector3(8,10.9,15.4),rotation:new Quaternion(104254907e-22,-1,1.19209261e-7,2220273e-12),scale:new Vector3(7.2,8.7,1)});$t.addComponentOrReplace(ee);var ne=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");ne.withCollisions=!0,ne.isPointerBlocker=!0,ne.visible=!0,$t.addComponentOrReplace(ne),R.hud.attachToEntity($t);var ie=new Entity("murpheusnickeditd9");engine.addEntity(ie),ie.setParent(W),ie.hasComponent(Billboard)||ie.addComponent(q);var oe=new Transform({position:new Vector3(8,9.5,10),rotation:new Quaternion(104254907e-22,-1,1.19209261e-7,2220273e-12),scale:new Vector3(4.5,4.5,1.00000024)});ie.addComponentOrReplace(oe);var se=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");se.withCollisions=!0,se.isPointerBlocker=!0,se.visible=!0,ie.addComponentOrReplace(se),R.hud.attachToEntity(ie);var ae=new Entity("murpheusnickeditd10");engine.addEntity(ae),ae.setParent(W);var ce=new Transform({position:new Vector3(15.5,8,8),rotation:new Quaternion(710542736e-23,.7071029,-8.429319e-8,-.707110643),scale:new Vector3(9.999971,11.5,.499999285)});ae.addComponentOrReplace(ce);var le=new GLTFShape("2d8fafc8-3b0c-4f5e-8e25-ab17d0ac26dc/Murpheus nickedit3D.glb");le.withCollisions=!0,le.isPointerBlocker=!0,le.visible=!0,ae.addComponentOrReplace(le),R.hud.attachToEntity(ae);var de=new Entity("voice trigger");de.addComponent(new Transform({position:new Vector3(8,0,5),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(1,1,1)})),de.addComponent(new A.TriggerComponent(new A.TriggerBoxShape(new Vector3(15,5,20),new Vector3(0,0,0)),{enableDebug:!1,onCameraEnter:function(){O.GodVoice.playOnce(),engine.removeEntity(de)}})),de.setParent(W),R.hud.attachToEntity(de);var he=new Entity("emails");he.addComponent(new GLTFShape("models/voice_email.glb")),he.addComponent(new Transform({position:new Vector3(8,-.2,15.5),rotation:new Quaternion(NaN,180,0,1),scale:new Vector3(21,21,2)})),he.setParent(W),R.hud.attachToEntity(he),H.on("click",(function(v){log("message bus message from",v.entity);var T=(0,C.getEntityByName)(v.entity).getComponent(Animator).getClip("trigger");T.stop(),T.play()})),C.getEntityByName=function(v){return Object.keys(engine.entities).map((function(v){return engine.entities[v]})).filter((function(C){return C.name===v}))[0]};var ue=new Entity("entity");engine.addEntity(ue),ue.setParent(W);var me=new GLTFShape("6b33f46e-9667-45e5-bd90-85f372ee2490/CityTile.glb");me.withCollisions=!0,me.isPointerBlocker=!0,me.visible=!0,ue.addComponentOrReplace(me);var fe=new Transform({position:new Vector3(8,0,-8),rotation:new Quaternion(0,0,0,1),scale:new Vector3(1,1,1)});ue.addComponentOrReplace(fe);var ye=new Entity("lastSlicePizzaBox");engine.addEntity(ye),ye.setParent(W);var ve=new Transform({position:new Vector3(8.4,.03,-9.9),rotation:new Quaternion(.2,.20526227355003357,.6766590476036072,.6766590476036072),scale:new Vector3(.415,.25,.27)});ye.addComponentOrReplace(ve),R.hud.attachToEntity(ye);var we=new GLTFShape("4d5ab1ac-99b6-4a4f-8317-4f3f8e8df33a/last_slice_pizza_box.glb");we.withCollisions=!0,we.isPointerBlocker=!0,we.visible=!0,ye.addComponentOrReplace(we);var Ce=new Entity("neatDRotating");engine.addEntity(Ce),Ce.setParent(W);var be=new Transform({position:new Vector3(14.4,2.65,-14.2),rotation:new Quaternion(0,0,0,1),scale:new Vector3(1,1.25,1)});Ce.addComponentOrReplace(be),R.hud.attachToEntity(Ce);var Te=new GLTFShape("43b77ce0-07eb-493f-8c21-c091815984c7/NEAT_3D_rotating.glb");Te.withCollisions=!0,Te.isPointerBlocker=!0,Te.visible=!0,Ce.addComponentOrReplace(Te);var Se=new Entity("neatDRotating2");engine.addEntity(Se),Se.setParent(W);var Ee=new Transform({position:new Vector3(1.6,2.65,-14.2),rotation:new Quaternion(0,0,0,1),scale:new Vector3(1,1.25,1)});Se.addComponentOrReplace(Ee),R.hud.attachToEntity(Se);var _e=new GLTFShape("43b77ce0-07eb-493f-8c21-c091815984c7/NEAT_3D_rotating.glb");_e.withCollisions=!0,_e.isPointerBlocker=!0,_e.visible=!0,Se.addComponentOrReplace(_e);var Re=new Entity("GreenHouse");engine.addEntity(Re),Re.setParent(W);var Pe=new Transform({position:new Vector3(8,0,7.6),rotation:new Quaternion(0,180,0),scale:new Vector3(.19,.28,.5)});Re.addComponentOrReplace(Pe);var Ie=new GLTFShape("GreenHouse/GreenHouse.glb");Ie.withCollisions=!0,Ie.isPointerBlocker=!0,Ie.visible=!0,Re.addComponentOrReplace(Ie),R.hud.attachToEntity(Re);var Oe=new Entity("houseTrigger");Oe.addComponent(new Transform({position:new Vector3(10.2,0,5),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(1,1,1)})),Oe.setParent(W),Oe.addComponent(new A.TriggerComponent(new A.TriggerBoxShape(new Vector3(14.5,12,17),new Vector3(-2.3,1.5,0)),{enableDebug:!1,onCameraEnter:function(){Re.addComponent(new A.ScaleTransformComponent(new Vector3(.19,.28,.5),new Vector3(.4,.8,1.3),.5))},onCameraExit:function(){Re.addComponent(new A.ScaleTransformComponent(new Vector3(.4,.8,1.3),new Vector3(.19,.28,.5),.5))}})),R.hud.attachToEntity(Oe);var Be=new Entity("upTrigger");Be.addComponent(new Transform({position:new Vector3(10.3,0,4),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(1,1,1)})),Be.setParent(W),Be.addComponent(new A.TriggerComponent(new A.TriggerBoxShape(new Vector3(2,3,1),new Vector3(-2.3,1.5,0)),{enableDebug:!1,onCameraEnter:function(){W.getComponent(Transform).scale.setAll(0),engine.addEntity(Ue),He.getComponent(Transform).scale.setAll(1),engine.removeEntity(qe),(0,B.movePlayerTo)({x:8,y:7.8,z:-12.5})}})),R.hud.attachToEntity(Be);var Ne=new Entity("fantasyChest");engine.addEntity(Ne),Ne.setParent(W);var Le=new Transform({position:new Vector3(8,.1,-7),rotation:new Quaternion(0,180,NaN),scale:new Vector3(1.000000238418579,1,1.000000238418579)});Ne.addComponentOrReplace(Le),R.hud.attachToEntity(Ne);var ke=Math.random().toString(16).slice(2),Fe=new MessageBus,Ve=((0,S.createInventory)(UICanvas,UIContainerStack,UIImage),new E.default);Ve.init(),Ve.spawn(Ne,{onClickText:"Open/Close",onClick:[{entityName:"fantasyChest",actionId:"toggle",values:{}}]},(0,T.createChannel)(ke,Ne,Fe));var Ue=new Entity("hideGround");Ue.addComponent(new Transform({position:new Vector3(8,0,0),scale:new Vector3(1,1,1)})),Ue.addComponent(new AvatarModifierArea({area:{box:new Vector3(16,6,32)},modifiers:[AvatarModifiers.HIDE_AVATARS]})),R.hud.attachToEntity(Ue);var qe=new Entity("hideInside");qe.addComponent(new Transform({position:new Vector3(8,7,0),scale:new Vector3(1,1,1)})),qe.addComponent(new AvatarModifierArea({area:{box:new Vector3(16,6,32)},modifiers:[AvatarModifiers.HIDE_AVATARS]})),engine.addEntity(qe),R.hud.attachToEntity(qe);var He=new Entity("red area parent");He.addComponent(new Transform({position:new Vector3(8,7.5,0),scale:new Vector3(0,0,0)})),engine.addEntity(He),R.hud.attachToEntity(He);var Ge=new Entity("inside floor");Ge.addComponent(new PlaneShape),Ge.setParent(He),engine.addEntity(Ge),Ge.addComponent(new Material).albedoColor=Color4.Red(),Ge.addComponent(new Transform({rotation:Quaternion.Euler(90,0,0),scale:new Vector3(15,30,1)})),R.hud.attachToEntity(Ge);var We=new Entity("groundTrigger");We.addComponent(new Transform({position:new Vector3(2.3,0,8.5),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(1,1,1)})),We.setParent(He),We.addComponent(new A.TriggerComponent(new A.TriggerBoxShape(new Vector3(2,3,3),new Vector3(-2.3,1.5,0)),{enableDebug:!1,onCameraEnter:function(){Un.getComponent(Transform).scale.setAll(0),In.addComponent(new A.ScaleTransformComponent(new Vector3(.4,1.5,.9),new Vector3(.01,.01,.01),.5)),We.addComponent(new A.Delay(500,(function(){W.getComponent(Transform).scale.setAll(1),engine.removeEntity(Ue),He.getComponent(Transform).scale.setAll(0),engine.addEntity(qe),(0,B.movePlayerTo)({x:8,y:1,z:-2})})))}})),R.hud.attachToEntity(We);var Xe=new Entity("collider wall");Xe.addComponent(new PlaneShape),Xe.addComponent(new Transform({position:new Vector3(-7.4,1.3,0),rotation:Quaternion.Euler(0,90,0),scale:new Vector3(30,2.3,1)})),Xe.setParent(He),Xe.getComponent(PlaneShape).visible=!1,R.hud.attachToEntity(Xe);var Qe=new Entity("collider wall2");Qe.addComponent(new PlaneShape),Qe.addComponent(new Transform({position:new Vector3(7.4,1.3,0),rotation:Quaternion.Euler(0,90,0),scale:new Vector3(30,2.3,1)})),Qe.setParent(He),Qe.getComponent(PlaneShape).visible=!1,R.hud.attachToEntity(Qe);var Ye=new Entity("collider wall3");Ye.addComponent(new PlaneShape),Ye.addComponent(new Transform({position:new Vector3(0,1.3,-15),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(15,2.3,1)})),Ye.setParent(He),Ye.getComponent(PlaneShape).visible=!1,R.hud.attachToEntity(Ye);var Ze=new Entity("collider wall4");Ze.addComponent(new PlaneShape),Ze.addComponent(new Transform({position:new Vector3(0,1.3,15),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(15,2.3,1)})),Ze.setParent(He),Ze.getComponent(PlaneShape).visible=!1,R.hud.attachToEntity(Ze);var Je=new Entity("wolf");engine.addEntity(Je),Je.setParent(He);var $e=new Transform({position:new Vector3(3.4,.1,8.3),rotation:new Quaternion(0,180,0),scale:new Vector3(.5,.5,.5)});Je.addComponentOrReplace($e),R.hud.attachToEntity(Je);var tn=new GLTFShape("models/Wolfglb.glb");tn.withCollisions=!0,tn.isPointerBlocker=!0,tn.visible=!0,Je.addComponentOrReplace(tn);var nn=new Entity("wolf2");engine.addEntity(nn),nn.setParent(He);var on=new Transform({position:new Vector3(-3.8,.1,8.1),rotation:new Quaternion(0,180,0),scale:new Vector3(.5,.5,.5)});nn.addComponentOrReplace(on),R.hud.attachToEntity(nn);var rn=new GLTFShape("models/Wolfglb.glb");rn.withCollisions=!0,rn.isPointerBlocker=!0,rn.visible=!0,nn.addComponentOrReplace(rn);var sn=new Entity("glossyaethereatiles");engine.addEntity(sn),sn.setParent(He);var an=new Transform({position:new Vector3(-7.4,3.2,.39),rotation:Quaternion.Euler(0,0,90),scale:new Vector3(.4,.6,1.92)});sn.addComponentOrReplace(an);var cn=new GLTFShape("6b33f46e-9667-45e5-bd90-85f372ee2490/CityTile.glb");cn.withCollisions=!0,cn.isPointerBlocker=!0,cn.visible=!0,sn.addComponentOrReplace(cn),R.hud.attachToEntity(sn);var ln=new Entity("glossyaethereatiles2");engine.addEntity(ln),ln.setParent(He);var dn=new Transform({position:new Vector3(7.4,3.2,.47),rotation:Quaternion.Euler(0,0,-90),scale:new Vector3(.4,.6,1.931)});ln.addComponentOrReplace(dn);var hn=new GLTFShape("6b33f46e-9667-45e5-bd90-85f372ee2490/CityTile.glb");hn.withCollisions=!0,hn.isPointerBlocker=!0,hn.visible=!0,ln.addComponentOrReplace(hn),R.hud.attachToEntity(ln);var un=new Entity("glossyaethereatiles3");engine.addEntity(un),un.setParent(He);var pn=new Transform({position:new Vector3(0,.06,7),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(.93,1,1)});un.addComponentOrReplace(pn);var mn=new GLTFShape("6b33f46e-9667-45e5-bd90-85f372ee2490/CityTile.glb");mn.withCollisions=!0,mn.isPointerBlocker=!0,mn.visible=!0,un.addComponentOrReplace(mn),R.hud.attachToEntity(un);var fn=new Entity("glossyaethereatiles4");engine.addEntity(fn),fn.setParent(He);var yn=new Transform({position:new Vector3(0,.06,-8),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(.93,1,.88)});fn.addComponentOrReplace(yn);var gn=new GLTFShape("6b33f46e-9667-45e5-bd90-85f372ee2490/CityTile.glb");gn.withCollisions=!0,gn.isPointerBlocker=!0,gn.visible=!0,fn.addComponentOrReplace(gn),R.hud.attachToEntity(fn);var vn=new Entity("glossyaethereatiles5");engine.addEntity(vn),vn.setParent(He);var wn=new Transform({position:new Vector3(0,3.16,-15),rotation:Quaternion.Euler(-90,0,0),scale:new Vector3(.93,.4,.4)});vn.addComponentOrReplace(wn);var Cn=new GLTFShape("6b33f46e-9667-45e5-bd90-85f372ee2490/CityTile.glb");Cn.withCollisions=!0,Cn.isPointerBlocker=!0,Cn.visible=!0,vn.addComponentOrReplace(Cn),R.hud.attachToEntity(vn);var bn=new Entity("glossyaethereatiles6");engine.addEntity(bn),bn.setParent(He);var Tn=new Transform({position:new Vector3(0,3.16,15),rotation:Quaternion.Euler(90,0,0),scale:new Vector3(.93,.4,.4)});bn.addComponentOrReplace(Tn);var Sn=new GLTFShape("6b33f46e-9667-45e5-bd90-85f372ee2490/CityTile.glb");Sn.withCollisions=!0,Sn.isPointerBlocker=!0,Sn.visible=!0,bn.addComponentOrReplace(Sn),R.hud.attachToEntity(bn);var En=new Entity("GreenHouse2");engine.addEntity(En),En.setParent(He);var xn=new Transform({position:new Vector3(0,.1,-11.7),rotation:new Quaternion(0,0,0),scale:new Vector3(.43,.62,.72)});En.addComponentOrReplace(xn);var An=new GLTFShape("GreenHouse/GreenHouse.glb");An.withCollisions=!0,An.isPointerBlocker=!0,An.visible=!0,En.addComponentOrReplace(An),R.hud.attachToEntity(En);var _n=new Entity("GreenHouse3");engine.addEntity(_n),_n.setParent(He);var Rn=new Transform({position:new Vector3(0,-.3,5),rotation:new Quaternion(0,180,0),scale:new Vector3(1.7,2,2.2)});_n.addComponentOrReplace(Rn);var Pn=new GLTFShape("GreenHouse/GreenHouse.glb");Pn.withCollisions=!0,Pn.isPointerBlocker=!0,Pn.visible=!0,_n.addComponentOrReplace(Pn),R.hud.attachToEntity(_n);var In=new Entity("GreenHouse4");engine.addEntity(In),In.setParent(He);var On=new Transform({position:new Vector3(0,-.3,10),rotation:new Quaternion(0,180,0),scale:new Vector3(.4,.7,.9)});In.addComponentOrReplace(On);var Mn=new GLTFShape("GreenHouse/GreenHouse.glb");Mn.withCollisions=!0,Mn.isPointerBlocker=!0,Mn.visible=!0,In.addComponentOrReplace(Mn),R.hud.attachToEntity(In);var zn=new Entity("wolfTrigger");zn.addComponent(new Transform({position:new Vector3(2,0,3.3),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(1,1,1)})),zn.setParent(He),zn.addComponent(new A.TriggerComponent(new A.TriggerBoxShape(new Vector3(14.5,3,14),new Vector3(-2.3,1.5,0)),{enableDebug:!1,onCameraEnter:function(){Je.addComponent(new A.ScaleTransformComponent(new Vector3(.65,.65,.65),new Vector3(2,2,2),.5)),nn.addComponent(new A.ScaleTransformComponent(new Vector3(.65,.65,.65),new Vector3(2,2,2),.5))},onCameraExit:function(){Je.addComponent(new A.ScaleTransformComponent(new Vector3(2,2,2),new Vector3(.65,.65,.65),.5)),nn.addComponent(new A.ScaleTransformComponent(new Vector3(2,2,2),new Vector3(.65,.65,.65),.5))}})),R.hud.attachToEntity(zn);var Bn=new Entity("GreenTrigger");Bn.addComponent(new Transform({position:new Vector3(2,0,3.3),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(1,1,1)})),Bn.setParent(He),Bn.addComponent(new A.TriggerComponent(new A.TriggerBoxShape(new Vector3(14.5,3,14),new Vector3(-2.3,1.5,0)),{enableDebug:!1,onCameraEnter:function(){In.addComponent(new A.ScaleTransformComponent(new Vector3(.4,.7,.9),new Vector3(.4,1.5,.9),.5))},onCameraExit:function(){In.addComponent(new A.ScaleTransformComponent(new Vector3(.4,1.5,.9),new Vector3(.4,.7,.9),.5))}})),R.hud.attachToEntity(Bn);var Nn=new Entity;Nn.addComponent(new Transform({position:new Vector3(5.62,-.06,-9.83),rotation:Quaternion.Euler(0,0,0),scale:new Vector3(.1,.2,.1)})),Nn.addComponent(M.sandShape),Nn.setParent(W),engine.addEntity(Nn),R.hud.attachToEntity(Nn);var Dn=new Entity;engine.addEntity(Dn),Dn.addComponent(new GLTFShape("models/birdSplat2.glb")),Dn.addComponent(new Transform),Dn.getComponent(Transform).scale.setAll(0),PhysicsCast.instance;var Ln=Camera.instance,kn=function(){function DistanceBird(v){this.flying=!1,this.elapsed=Math.random(),this.originalPos=new Vector3(v.x,v.y,v.z)}return __decorate([Component("DistanceBird")],DistanceBird)}();C.DistanceBird=kn;var Fn=function(){function ProximitySystem(){this.radius=4,this.amplitude=1,this.group=engine.getComponentGroup(Transform,kn)}return ProximitySystem.prototype.update=function(v){var C,T;try{for(var S=__values(this.group.entities),E=S.next();!E.done;E=S.next()){var A=E.value,R=A.getComponent(Transform),O=A.getComponent(kn),B=(0,z.realDistance)(O.originalPos,Ln.position);if(B<this.radius){var V=(1-B/this.radius)*this.amplitude,q=O.originalPos.subtract(Ln.position);O.flying||(O.flying=!0,A.addComponentOrReplace(M.birdFlyShape)),R.position=O.originalPos.add(q.multiplyByFloats(V,0,V)),R.position.y=O.originalPos.y+6*V,O.elapsed+=v,R.position.x+=Math.sin(10*O.elapsed)*V,R.position.y+=Math.sin(8*O.elapsed)*V,R.position.z+=Math.sin(11*O.elapsed)*V,R.lookAt(Ln.position)}else O.flying&&(O.flying=!1,A.addComponentOrReplace(M.birdIdleShape)),R.position.copyFrom(O.originalPos)}}catch(v){C={error:v}}finally{try{E&&!E.done&&(T=S.return)&&T.call(S)}finally{if(C)throw C.error}}},ProximitySystem}();engine.addSystem(new Fn);var Vn=new(function(){function BirdController(){this.sideLength=8,this.rows=4,this.cols=4,this.spacing=this.sideLength/this.rows,this.base=new Vector3(8,0,-7),this.center=new Vector3(8,0,7),this.base=new Vector3(this.center.x-this.sideLength/2,this.center.y,this.center.z-this.sideLength/2)}return BirdController.prototype.spawnBirds=function(){var v=new Entity;v.addComponent(new Transform({position:new Vector3(6.5,.1,-8.5),scale:new Vector3(.5,.5,.5),rotation:Quaternion.Euler(0,360*Math.random(),0)})),v.addComponent(new kn(new Vector3(6.5,.1,-8.5))),v.addComponent(M.birdIdleShape),v.setParent(W),engine.addEntity(v),R.hud.attachToEntity(v),v.addComponent(new OnPointerDown((function(){v.removeComponent(A.MoveTransformComponent),Dn.getComponent(Transform).scale.setAll(1),Dn.getComponent(Transform).position=v.getComponent(Transform).position,engine.removeEntity(v),Dn.addComponent(new A.Delay(250,(function(){Dn.getComponent(Transform).scale.setAll(0)}))),O.blastBird.getComponent(AudioSource).playOnce()}),{button:ActionButton.POINTER,showFeedback:!1,distance:50}));var C=new Entity;C.addComponent(new Transform({position:new Vector3(9.3,.57,-8),scale:new Vector3(.5,.5,.5),rotation:Quaternion.Euler(0,360*Math.random(),0)})),C.addComponent(new kn(new Vector3(9.3,.57,-8))),C.addComponent(M.birdIdleShape),C.setParent(W),engine.addEntity(C),R.hud.attachToEntity(C),C.addComponent(new OnPointerDown((function(){C.removeComponent(A.MoveTransformComponent),Dn.getComponent(Transform).scale.setAll(1),Dn.getComponent(Transform).position=C.getComponent(Transform).position,Dn.addComponent(new A.Delay(250,(function(){Dn.getComponent(Transform).scale.setAll(0),engine.removeEntity(C)}))),O.blastBird.getComponent(AudioSource).playOnce()}),{button:ActionButton.POINTER,showFeedback:!1,distance:50}));var T=new Entity;T.addComponent(new Transform({position:new Vector3(7,.5,-7),scale:new Vector3(.5,.5,.5),rotation:Quaternion.Euler(0,360*Math.random(),0)})),T.addComponent(new kn(new Vector3(7,.5,-7))),T.addComponent(M.birdIdleShape),T.setParent(W),engine.addEntity(T),R.hud.attachToEntity(T),T.addComponent(new OnPointerDown((function(){T.removeComponent(A.MoveTransformComponent),Dn.getComponent(Transform).scale.setAll(1),Dn.getComponent(Transform).position=T.getComponent(Transform).position,Dn.addComponent(new A.Delay(250,(function(){Dn.getComponent(Transform).scale.setAll(0),engine.removeEntity(T)}))),O.blastBird.getComponent(AudioSource).playOnce()}),{button:ActionButton.POINTER,showFeedback:!1,distance:50}));var S=new Entity;S.addComponent(new Transform({position:new Vector3(9,.2,-9.5),scale:new Vector3(.5,.5,.5),rotation:Quaternion.Euler(0,360*Math.random(),0)})),S.addComponent(new kn(new Vector3(9,.2,-9.5))),S.addComponent(M.birdIdleShape),S.setParent(W),engine.addEntity(S),R.hud.attachToEntity(S),S.addComponent(new OnPointerDown((function(){S.removeComponent(A.MoveTransformComponent),Dn.getComponent(Transform).scale.setAll(1),Dn.getComponent(Transform).position=S.getComponent(Transform).position,Dn.addComponent(new A.Delay(250,(function(){Dn.getComponent(Transform).scale.setAll(0),engine.removeEntity(S)}))),O.blastBird.getComponent(AudioSource).playOnce()}),{button:ActionButton.POINTER,showFeedback:!1,distance:50}))},BirdController}());onSceneReadyObservable.add((function(){Vn.spawnBirds()}));var Un=new V.Poop(new GLTFShape("models/poopy.glb"),new Transform({position:new Vector3(0,.2,-.1),scale:new Vector3(0,0,0),rotation:new Quaternion(0,90,90)}));Un.setParent(Attachable.AVATAR);var qn=new Entity("poop hide");qn.addComponent(new AvatarModifierArea({area:{box:new Vector3(15,3,24)},modifiers:[AvatarModifiers.HIDE_AVATARS]})),qn.addComponent(new Transform({position:new Vector3(0,3.4,4)})),R.hud.attachToEntity(qn),engine.addEntity(qn),qn.setParent(He),qn.addComponent(new A.TriggerComponent(new A.TriggerBoxShape(new Vector3(15,4,24),Vector3.Zero()),{enableDebug:!1,onCameraEnter:function(){Un.getComponent(Transform).scale.setAll(.5)},onCameraExit:function(){Un.getComponent(Transform).scale.setAll(0)}}))})),define("src/enemy",["require","exports","@dcl/ecs-scene-utils","src/sound","src/game"],(function(v,C,T,S,E){Object.defineProperty(C,"__esModule",{value:!0}),C.Enemy=void 0;var A=new S.Sound(new AudioClip("sounds/blasterExplosion.mp3"),!1),R=new Entity;engine.addEntity(R),R.addComponent(new GLTFShape("models/glowingSpaceship.glb")),R.addComponent(new Transform({position:new Vector3(8,-10,0)})),R.getComponent(Transform).scale.setAll(0),R.setParent(E._scene);var O=function(v){function Enemy(C,S){var O=v.call(this)||this;engine.addEntity(O),O.addComponent(C),O.addComponent(S),O.setParent(E._scene);var M=S.position,z=new Vector3(8,.1,-7);return O.addComponent(new T.MoveTransformComponent(M,z,4+3*Math.random(),(function(){engine.removeEntity(O)}))),O.addComponent(new OnPointerDown((function(){O.removeComponent(T.MoveTransformComponent),R.getComponent(Transform).scale.setAll(1),R.getComponent(Transform).position=O.getComponent(Transform).position,R.addComponent(new T.Delay(250,(function(){R.getComponent(Transform).scale.setAll(0),engine.removeEntity(O)}))),A.getComponent(AudioSource).playOnce()}),{button:ActionButton.POINTER,showFeedback:!1,distance:50})),O}return __extends(Enemy,v),Enemy}(Entity);C.Enemy=O})),define("src/spawners",["require","exports","@dcl/ecs-scene-utils","dcl-builder-hud","src/enemy","src/game"],(function(v,C,T,S,E,A){Object.defineProperty(C,"__esModule",{value:!0});var R={redSpaceship:new GLTFShape("models/redSpaceship.glb"),greenSpaceship:new GLTFShape("models/greenSpaceship.glb"),blueSpaceship:new GLTFShape("models/blueSpaceship.glb")};function spawnEnemy(v,C,T,S){new E.Enemy(R[v],new Transform({position:new Vector3(C,T,S),rotation:new Quaternion(0,0,0),scale:new Vector3(.5,.5,.5)})).setParent(A._scene)}function getRandomSpawnTime(){return 1500+1500*Math.random()}var O=new Entity;O.addComponent(new T.Interval(getRandomSpawnTime(),(function(){Math.sqrt(Math.random());var v=2*Math.random()*Math.PI;Math.cos(v),Math.sin(v),new Transform({rotation:new Quaternion(0,90,0)}),spawnEnemy("greenSpaceship",6,13.5,15)}))),engine.addEntity(O),S.hud.attachToEntity(O),O.setParent(A._scene);var M=new Entity;M.addComponent(new T.Interval(getRandomSpawnTime(),(function(){Math.sqrt(Math.random());var v=2*Math.random()*Math.PI;Math.cos(v),Math.sin(v),spawnEnemy("greenSpaceship",10,13.5,15)}))),engine.addEntity(M),S.hud.attachToEntity(M),M.setParent(A._scene)}));